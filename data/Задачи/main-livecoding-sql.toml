category = "SQL"

[[tasks]]
  id = 1
  question = "–ù–∞–π–¥–∏ id —é–Ω–∏—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø—Ä–æ–¥–∞–Ω—ã –Ω–∞ —Å—É–º–º—É –±–æ–ª–µ–µ 1000 —Ä—É–±–ª–µ–π –ø–æ—Å–ª–µ 10:00 —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –¥–Ω—è. > \"2024-06-03 10:00\""
  answer = "```sql\n-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã Unit\nCREATE TABLE Unit (\n    Id INT PRIMARY KEY,\n    Price DECIMAL(10, 2)\n);\n\n-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã Sales\nCREATE TABLE Sales (\n    Id INT PRIMARY KEY,\n    Unit_id INT,\n    Sale_time TIMESTAMP,\n    FOREIGN KEY (Unit_id) REFERENCES Unit(Id)\n);\n```\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\n- –ù—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å `Unit.Id`, —É –∫–æ—Ç–æ—Ä—ã—Ö —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂ –ø—Ä–µ–≤—ã—à–∞–µ—Ç `1000` —Ä—É–±–ª–µ–π.\n- –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SUM(Price) > 1000` –∏ `Sale_time > '2024-06-03 10:00'`.\n- –û–±—ä–µ–¥–∏–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—ã —á–µ—Ä–µ–∑ `JOIN` –ø–æ `Unit.Id = Sales.Unit_id`.\n- –ò—Å–ø–æ–ª—å–∑—É–µ–º `GROUP BY Unit_id`, —á—Ç–æ–±—ã –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å —Å—É–º–º—ã.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT u.Id \nFROM Unit u\nJOIN Sales s ON u.Id = s.Unit_id\nWHERE s.Sale_time > '2024-06-03 10:00'\nGROUP BY u.Id\nHAVING SUM(u.Price) > 1000;\n```\n\n–≠—Ç–æ—Ç SQL-–∑–∞–ø—Ä–æ—Å –≤—ã–±–∏—Ä–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —é–Ω–∏—Ç–æ–≤ (`Id`), —É –∫–æ—Ç–æ—Ä—ã—Ö —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ—Å–ª–µ 10:00 –ø—Ä–µ–≤—ã—à–∞–µ—Ç 1000 —Ä—É–±–ª–µ–π. ‚úÖ\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-units-sold-after-time"

[[tasks]]
  id = 2
  question = "–ù–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, —á—Ç–æ–±—ã –≤—ã–≤–µ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è?"
  answer = "```sql\nCREATE TABLE USER (\n    id INT,\n    name VARCHAR(50)\n);\n\nINSERT INTO USER (id, name) VALUES\n(1, 'Ivan'),\n(2, 'Oleg'),\n(3, 'Anna'),\n(4, 'Ivan'),\n(5, 'Ted');\n\nCREATE TABLE CAR (\n    id INT,\n    model VARCHAR(50)\n);\n\nINSERT INTO CAR (id, model) VALUES\n(4422, 'Opel 1'),\n(4523, 'BMV 5'),\n(4612, 'VW'),\n(4853, 'BMV 6');\n\n```\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\n- –ù–∞–º –Ω—É–∂–Ω–æ **–ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω** —É –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.\n- –ò—Å–ø–æ–ª—å–∑—É–µ–º `GROUP BY user_id` –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.\n- –ü—Ä–∏–º–µ–Ω—è–µ–º `HAVING COUNT(*) > 1`, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ—Ö, —É –∫–æ–≥–æ **–±–æ–ª—å—à–µ –æ–¥–Ω–æ–π –º–∞—à–∏–Ω—ã**.\n- –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ `CAR` —Å–≤—è–∑–∞–Ω–∞ —Å `USER`, –¥–æ–±–∞–≤–∏–≤ `user_id` –≤ `CAR`.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n–î–æ–±–∞–≤–ª—è–µ–º –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç:\n\n```sql\nALTER TABLE CAR ADD COLUMN user_id INT;\nALTER TABLE CAR ADD FOREIGN KEY (user_id) REFERENCES USER(id);\n```\n\n–ó–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –±–æ–ª–µ–µ —á–µ–º –æ–¥–Ω–æ–π –º–∞—à–∏–Ω–æ–π:\n\n```sql\nSELECT u.id, u.name, COUNT(c.id) AS car_count\nFROM USER u\nJOIN CAR c ON u.id = c.user_id\nGROUP BY u.id, u.name\nHAVING COUNT(c.id) > 1;\n```\n\nüîπ **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**\n\n- `JOIN` –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ç–∞–±–ª–∏—Ü—ã `USER` –∏ `CAR` –ø–æ `user_id`.\n- `GROUP BY u.id, u.name` –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.\n- `COUNT(c.id)` —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω —É –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.\n- `HAVING COUNT(c.id) > 1` –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å **–¥–≤—É–º—è –∏ –±–æ–ª–µ–µ –º–∞—à–∏–Ω–∞–º–∏**.\n\n**–í—ã—Ö–æ–¥:**\n\n```\nid | name  | car_count\n----------------------\n1  | Ivan  | 2\n```\n\n–ó–Ω–∞—á–∏—Ç, **—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è \"Ivan\" –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π –º–∞—à–∏–Ω—ã**. üöóüöó\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-multiple-cars-users"

[[tasks]]
  id = 3
  question = "–ù–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—ã–≤–æ–¥–∞ –∏–º–µ–Ω —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤, –≥–¥–µ –∏–º–µ–Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –Ω–∞ –±—É–∫–≤—É C?"
  answer = "{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\n- –î–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SQL **`LIKE`** —Å —à–∞–±–ª–æ–Ω–æ–º, —á—Ç–æ–±—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏–º–µ–Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è –Ω–∞ –±—É–∫–≤—É \"C\".\n- –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏–º–µ–Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **`JOIN`** –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü: –æ–¥–Ω–æ–π –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ –¥—Ä—É–≥–æ–π –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤.\n- –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –±—É–¥–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü, –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã **students** (—Å—Ç—É–¥–µ–Ω—Ç—ã) –∏ **universities** (—É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—ã).\n- –ù–∞–º –Ω—É–∂–Ω–æ —Å–æ–µ–¥–∏–Ω–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å —Ç–∞–±–ª–∏—Ü–µ–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤ –ø–æ –∫–∞–∫–æ–º—É-—Ç–æ –æ–±—â–µ–º—É –∫–ª—é—á—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ **university_id**.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã:\n\n```sql\nCREATE TABLE universities (\n    id INT PRIMARY KEY,\n    name VARCHAR(100)\n);\n\nCREATE TABLE students (\n    id INT PRIMARY KEY,\n    name VARCHAR(100),\n    university_id INT,\n    FOREIGN KEY (university_id) REFERENCES universities(id)\n);\n```\n\n–ó–∞–ø—Ä–æ—Å –¥–ª—è –≤—ã–≤–æ–¥–∞ –∏–º–µ–Ω —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤, –≥–¥–µ –∏–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞ \"C\":\n\n```sql\nSELECT s.name AS student_name, u.name AS university_name\nFROM students s\nJOIN universities u ON s.university_id = u.id\nWHERE s.name LIKE 'C%';\n```\n\n **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**\n\n1. **`SELECT s.name AS student_name, u.name AS university_name`** ‚Äî –≤—ã–±–∏—Ä–∞–µ–º –∏–º–µ–Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤.\n2. **`FROM students s`** ‚Äî –Ω–∞—á–∏–Ω–∞–µ–º —Å —Ç–∞–±–ª–∏—Ü—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.\n3. **`JOIN universities u ON s.university_id = u.id`** ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Ç–∞–±–ª–∏—Ü–µ–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤ –ø–æ –ø–æ–ª—é **university_id**.\n4. **`WHERE s.name LIKE 'C%'`** ‚Äî —Ñ–∏–ª—å—Ç—Ä—É–µ–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, —á—å–∏ –∏–º–µ–Ω–∞ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –Ω–∞ –±—É–∫–≤—É \"C\". –°–∏–º–≤–æ–ª **`%`** –æ–∑–Ω–∞—á–∞–µ—Ç –ª—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ—Å–ª–µ \"C\".\n\n **–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**\n\n- –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º **`JOIN`** –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü.\n- **`LIKE 'C%'`** –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏–º–µ–Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è –Ω–∞ \"C\".\n- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü –∏ –∫–ª—é—á–∏ –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —Ç–∞–∫–æ–π –∂–µ.\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-students-names-c"

[[tasks]]
  id = 4
  question = "–í—ã–±–µ—Ä–∏ –ø—Ä–æ—Ñ–∏–ª–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ 10 –ø–æ—Å—Ç–æ–≤"
  answer = "```sql\n-- –¢–∞–±–ª–∏—Ü–∞ profile\nCREATE TABLE profile (\n    id BIGSERIAL PRIMARY KEY,\n    nickname VARCHAR,\n    registered_at TIMESTAMP\n);\n\n-- –¢–∞–±–ª–∏—Ü–∞ post\nCREATE TABLE post (\n    id BIGSERIAL PRIMARY KEY,\n    owner_id BIGINT REFERENCES profile (id),\n    body TEXT,\n    inserted_at TIMESTAMP,\n    likes_count INT\n);\n\n-- –¢–∞–±–ª–∏—Ü–∞ subscription_count\nCREATE TABLE subscription_count (\n    profile_id BIGINT REFERENCES profile (id) UNIQUE,\n    followers_count INT,\n    following_count INT\n);\n\n```\n\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüìù –ù—É–∂–Ω–æ **–ø–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤** —É –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—ã–±—Ä–∞—Ç—å —Ç–µ—Ö, —É –∫–æ–≥–æ –∏—Ö –±–æ–ª—å—à–µ 10.  \nüîó –î–ª—è —ç—Ç–æ–≥–æ **—Å–æ–µ–¥–∏–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É `profile` —Å `post` –ø–æ `id`**.  \nüìä –ò—Å–ø–æ–ª—å–∑—É–µ–º **`GROUP BY` –∏ `HAVING`** –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT p.id, p.nickname\nFROM profile p\nJOIN post po ON p.id = po.owner_id\nGROUP BY p.id, p.nickname\nHAVING COUNT(po.id) > 10;\n```\n\nüìå **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**\n\n- **–°–æ–µ–¥–∏–Ω—è–µ–º `profile` –∏ `post`** –ø–æ `id` (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `owner_id` –≤ `post`).\n- **–ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ `p.id, p.nickname`**, —á—Ç–æ–±—ã —Å—á–∏—Ç–∞—Ç—å –ø–æ—Å—Ç—ã –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è.\n- **–§–∏–ª—å—Ç—Ä—É–µ–º `HAVING COUNT(po.id) > 10`**, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ —Ç–µ—Ö, —É –∫–æ–≥–æ –±–æ–ª—å—à–µ 10 –ø–æ—Å—Ç–æ–≤.\n\nüî• **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**  \n‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π **–ø–æ–¥—Å—á–µ—Ç —á–µ—Ä–µ–∑ `COUNT`**  \n‚úÖ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –∑–∞–ø—Ä–æ—Å–∞**, –∞ –Ω–µ –≤ –∫–æ–¥–µ  \n‚úÖ **–ü—Ä–æ—Å—Ç–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è** (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ —É—Å–ª–æ–≤–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –¥–∞—Ç–µ) üöÄ\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-profiles-more-than-10-posts"

[[tasks]]
  id = 5
  question = "–î–∞–Ω—ã –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã Persosn –∏ Payments. –û–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º. –°–ø—Ä–∞–≤–∞ –æ–ø–∏—Å–∞–Ω–∏–µ. –ù–∞–ø–∏—à–∏—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–æ–¥–∏—Ç name –∏ value"
  answer = "```\n–î–∞–Ω—ã –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã :\nPersons co —Å–ø–∏—Å–∫–æ–º —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤\n\nid name\n1 Petya\n2 Vasya\n3 Kolya\n\nPayments —Å –∑–∞—Ä–ø–ª–∞—Ç–Ω—ã–º–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è–º–∏ –µ–∂–µ–º–µ—Å—è—á–Ω–æ\n\nid persons_id value\n1 1 10\n2 1 20\n3 3 15\n\n```\n\n\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüìù –ù—É–∂–Ω–æ **–æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã** (`Persons` –∏ `Payments`) –ø–æ `persons_id`.  \nüîó –ò—Å–ø–æ–ª—å–∑—É–µ–º **`JOIN`** –¥–ª—è —Å–≤—è–∑–∏.  \nüìä –í—ã–≤–æ–¥–∏–º **–∏–º—è (`name`) –∏ —Å—É–º–º—É `value` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞**.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT p.name, pay.value\nFROM Persons p\nJOIN Payments pay ON p.id = pay.persons_id;\n```\n\nüìå **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**\n\n- **`JOIN Persons p ON p.id = pay.persons_id`** —Å–≤—è–∑—ã–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –ø–æ `id`.\n- **–í—ã–±–∏—Ä–∞–µ–º `p.name` –∏ `pay.value`** ‚Äì –∏–º—è —Ä–∞–±–æ—Ç–Ω–∏–∫–∞ –∏ –µ–≥–æ –∑–∞—Ä–ø–ª–∞—Ç—É.\n\nüî• **–í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**:\n\n|name|value|\n|---|---|\n|Petya|10|\n|Petya|20|\n|Kolya|15|\n\n‚úÖ **–ü—Ä–æ—Å—Ç–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –∑–∞–ø—Ä–æ—Å** üöÄ\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-persons-payments"

[[tasks]]
  id = 6
  question = "–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–ø–∏—Å–∞—Ç—å sql –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É –ø–æ –≤—Å–µ–º –æ—Ç–¥–µ–ª–∞–º —Å—Ä–µ–¥–∏ –Ω–µ —É–≤–æ–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤"
  answer = "```\n–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã: \"\"units\"\" - –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–∏ –∏ \"\"employees\"\" - —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∫–æ–º–ø–∞–Ω–∏–∏\nunits:\nid int // Primary Key\nname text // (–Ω–∞–∑–≤–∞–Ω–∏–µ unit)\nemployees:\nid int // Primary Key\nunit_id int // Foreign Key -> units::id\nsalary numeric // (–∑–∞—Ä–ø–ª–∞—Ç–∞)\nfired boolean // (—Ñ–ª–∞–≥ —É–≤–æ–ª–µ–Ω)\n\n```\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüîó –ù—É–∂–Ω–æ **–æ–±—ä–µ–¥–∏–Ω–∏—Ç—å** —Ç–∞–±–ª–∏—Ü—ã `units` –∏ `employees` –ø–æ `unit_id`.  \n‚ö° –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å **–Ω–µ —É–≤–æ–ª–µ–Ω–Ω—ã—Ö** —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (`fired = FALSE`).  \nüìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **`GROUP BY`**, —á—Ç–æ–±—ã –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—ã –ø–æ –æ—Ç–¥–µ–ª–∞–º.  \nüìà **`MIN()` –∏ `MAX()`** –ø–æ–º–æ–≥—É—Ç –Ω–∞–π—Ç–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT \n    u.id AS unit_id,\n    u.name AS unit_name,\n    MIN(e.salary) AS min_salary,\n    MAX(e.salary) AS max_salary\nFROM units u\nJOIN employees e ON u.id = e.unit_id\nWHERE e.fired = FALSE\nGROUP BY u.id, u.name;\n```\n\nüìå **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**\n\n- **`JOIN employees e ON u.id = e.unit_id`** ‚Äì —Å–≤—è–∑—ã–≤–∞–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –∏—Ö –æ—Ç–¥–µ–ª–∞–º–∏.\n- **`WHERE e.fired = FALSE`** ‚Äì –∏—Å–∫–ª—é—á–∞–µ–º —É–≤–æ–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.\n- **`MIN(e.salary)` –∏ `MAX(e.salary)`** ‚Äì –≤—ã—á–∏—Å–ª—è–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—ã.\n- **`GROUP BY u.id, u.name`** ‚Äì –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –æ—Ç–¥–µ–ª–∞–º.\n\nüî• **–í—ã–≤–æ–¥ –ø—Ä–∏–º–µ—Ä–∞:**\n\n|unit_id|unit_name|min_salary|max_salary|\n|---|---|---|---|\n|1|IT|50000|150000|\n|2|HR|40000|90000|\n\n‚úÖ **–ì–æ—Ç–æ–≤–æ!** üöÄ\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-min-max-salary"

[[tasks]]
  id = 7
  question = ""
  answer = ""
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/"

[[tasks]]
  id = 8
  question = "–í—ã–≤–µ—Å—Ç–∏ id –∫–ª–∞—Å—Å–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ (–±–µ–∑ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤)?"
  answer = "```\n\"–ï—Å—Ç—å 2 —Ç–∞–±–ª–∏—Ü—ã student –∏ class\nstudent:\nid - –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–π –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á,\nclass_id - id –∫–ª–∞—Å—Å–∞ –≤ –∫–æ—Ç–æ—Ä–æ–º —á–∏—Å–ª–∏—Ç—Å—è —Å—Ç—É–¥–µ–Ω—Ç\nclass:\nid - –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–π –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á\n–ù—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—ã–≤–æ–¥–∞ id –∫–ª–∞—Å—Å–æ–≤,\n—É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –µ—â–µ.\n–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –ó–∞–ø—Ä–æ—Å –Ω–∞–¥–æ –Ω–∞–ø–∏—Å–∞—Ç—å –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤.\"\n\n```\n\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüéØ –ù—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –∫–ª–∞—Å—Å—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö **–Ω–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–æ–≤**.  \nüîó –¢–∞–±–ª–∏—Ü—ã **`class`** –∏ **`student`** —Å–≤—è–∑–∞–Ω—ã —á–µ—Ä–µ–∑ `class_id`.  \nüõë –í–∞–∂–Ω–æ **–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å** —Ç–µ –∫–ª–∞—Å—Å—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö `student.id IS NULL`.  \nüìä –ò—Å–ø–æ–ª—å–∑—É–µ–º **`LEFT JOIN`**, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∫–ª–∞—Å—Å—ã **–±–µ–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π** –≤ `student`.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT c.id \nFROM class c\nLEFT JOIN student s ON c.id = s.class_id\nWHERE s.id IS NULL;\n```\n\nüìå **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**\n\n- **`LEFT JOIN`** ‚Äì —Å–æ–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –∫–ª–∞—Å—Å—ã –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç `NULL` –≤ `s.id`, –µ—Å–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –Ω–µ—Ç.\n- **`WHERE s.id IS NULL`** ‚Äì –≤—ã–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ –∫–ª–∞—Å—Å—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ **–Ω–µ—Ç**.\n\n‚úÖ **–ì–æ—Ç–æ–≤–æ!** üöÄ\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-empty-classes"

[[tasks]]
  id = 9
  question = "–ü–æ–ª—É—á–∏—Ç—å id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ—Ç—Ä–∞—Ç–∏–≤—à–∏—Ö –±–æ–ª–µ–µ 1 000 000 —Ä—É–±–ª–µ–π (–±–µ–∑ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤)?"
  answer = "```\n–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å —Å–≤–æ–π –º–∞–≥–∞–∑–∏–Ω. –ö –Ω–∞–º –ø—Ä–∏—Ö–æ–¥—è—Ç –ª—é–¥–∏ –∏ –ø–æ–∫—É–ø–∞—é—Ç —É –Ω–∞—Å —á—Ç–æ-—Ç–æ. –ú—ã —Ö—Ä–∞–Ω–∏–º –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –ø–æ–∫—É–ø–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –¢–∞–±–ª–∏—Ü–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:\norders:\nid - –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–π –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á,\nuser_id - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\namount - —Å—É–º–º–∞ –ø–æ–∫—É–ø–∫–∏ –∫–æ—Ç–æ—Ä—É—é —Å–æ–≤–µ—Ä—à–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å\n\n–ú—ã –æ–ø–µ—Ä–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —ç—Ç–æ–π –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π –∏ —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –¥—Ä—É–≥–∏—Ö —Ç–∞–±–ª–∏—Ü –Ω–µ—Ç. –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–ø–∏—Å–∞—Ç—å SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏ –ø–æ–∫—É–ø–∫–∏ –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è –Ω–∞ —Å—É–º–º—É –±–æ–ª—å—à–µ —á–µ–º –Ω–∞ 1 000 000 —Ä—É–±–ª–µ–π.\n–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –ó–∞–ø—Ä–æ—Å –Ω–∞–¥–æ –Ω–∞–ø–∏—Å–∞—Ç—å –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤.\n\n```\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüìä –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**, —á—å—è –æ–±—â–∞—è —Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫ **–±–æ–ª—å—à–µ 1 000 000**.  \nüîó –¢–∞–±–ª–∏—Ü–∞ `orders` —Å–æ–¥–µ—Ä–∂–∏—Ç **user_id** –∏ **amount** (—Å—É–º–º–∞ –ø–æ–∫—É–ø–∫–∏).  \nüßÆ –ù–∞–º –Ω—É–∂–Ω–æ **—Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å** `amount` –ø–æ –∫–∞–∂–¥–æ–º—É `user_id`.  \nüöÄ –ò—Å–ø–æ–ª—å–∑—É–µ–º **`GROUP BY`** –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∏ **`HAVING`** –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT user_id \nFROM orders\nGROUP BY user_id\nHAVING SUM(amount) > 1000000;\n```\n\nüìå **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**\n\n- **`GROUP BY user_id`** ‚Äì –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –∑–∞–∫–∞–∑—ã –ø–æ `user_id`.\n- **`SUM(amount)`** ‚Äì —Å—á–∏—Ç–∞–µ–º –æ–±—â—É—é —Å—É–º–º—É –ø–æ–∫—É–ø–æ–∫ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.\n- **`HAVING SUM(amount) > 1000000`** ‚Äì –æ—Ç–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ—Ö, –∫—Ç–æ **–ø–æ—Ç—Ä–∞—Ç–∏–ª –±–æ–ª—å—à–µ –º–∏–ª–ª–∏–æ–Ω–∞**.\n\n‚úÖ **–ì–æ—Ç–æ–≤–æ!** üõçüî•\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-big-spenders"

[[tasks]]
  id = 10
  question = "–ë–î —Ç–∞–±–ª–∏—Ü–∞ users, –¥–≤–∞ —Å—Ç–æ–ª–±—Ü–∞: id number autoincrement unique, name varchar not unique. –ù–∞–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å, —á—Ç–æ–±—ã –≤—ã–≤–µ–ª–∏—Å—å –∏–º–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è 2 –∏ –±–æ–ª–µ–µ —Ä–∞–∑"
  answer = "{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüîé –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –∏–º–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è **2 –∏ –±–æ–ª–µ–µ —Ä–∞–∑** –≤ —Ç–∞–±–ª–∏—Ü–µ `users`.  \nüìä –ú—ã –±—É–¥–µ–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø–æ–ª—é `name` –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ç–∞–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π.  \nüöÄ –î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **`COUNT(name)`**.  \nüìå –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º **`HAVING`**.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT name\nFROM users\nGROUP BY name\nHAVING COUNT(name) >= 2;\n```\n\nüìå **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**\n\n- **`GROUP BY name`** ‚Äì –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∏–º–µ–Ω–∏, —á—Ç–æ–±—ã –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.\n- **`COUNT(name)`** ‚Äì —Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π –∫–∞–∂–¥–æ–≥–æ –∏–º–µ–Ω–∏.\n- **`HAVING COUNT(name) >= 2`** ‚Äì –≤—ã–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ –∏–º–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è **2 –∏ –±–æ–ª–µ–µ —Ä–∞–∑**.\n\n‚úÖ **–ì–æ—Ç–æ–≤–æ!** üéâ\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-duplicate-names"

[[tasks]]
  id = 11
  question = "–í—ã–±—Ä–∞—Ç—å –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ —Ç—Ä–µ—Ö –∑–∞–∫–∞–∑–æ–≤ —Å —Ü–µ–Ω–æ–π > 10"
  answer = "```\nCustomer\n- Id\n- name\n\nOrder\n- Id\n- customer_id\n- Price\n\n```\n\n\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüîç –ú—ã –¥–æ–ª–∂–Ω—ã –≤—ã–±—Ä–∞—Ç—å –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–¥–µ–ª–∞–ª–∏ **–±–æ–ª–µ–µ —Ç—Ä–µ—Ö –∑–∞–∫–∞–∑–æ–≤**, –≥–¥–µ **—Ü–µ–Ω–∞** –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞ –±–æ–ª—å—à–µ **10**.  \nüìä –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑—ã –ø–æ **`customer_id`** –∏ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ —Å —Ü–µ–Ω–æ–π –≤—ã—à–µ 10.  \nüìå –ò—Å–ø–æ–ª—å–∑—É–µ–º **`HAVING`** –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–∫–∞–∑–æ–≤.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT o.customer_id, c.name\nFROM Order o\nJOIN Customer c ON o.customer_id = c.Id\nWHERE o.Price > 10\nGROUP BY o.customer_id, c.name\nHAVING COUNT(o.Id) > 3;\n```\n\nüìå **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**\n\n- **`JOIN`** —Å–æ–µ–¥–∏–Ω—è–µ—Ç —Ç–∞–±–ª–∏—Ü—ã **`Order`** –∏ **`Customer`** –ø–æ –ø–æ–ª—é **`customer_id`**.\n- **`WHERE o.Price > 10`** —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ –∑–∞–∫–∞–∑—ã, –≥–¥–µ —Ü–µ–Ω–∞ –±–æ–ª—å—à–µ 10.\n- **`GROUP BY o.customer_id, c.name`** –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ **`customer_id`** –∏ –∏–º–µ–Ω–∏ –∫–ª–∏–µ–Ω—Ç–∞.\n- **`HAVING COUNT(o.Id) > 3`** –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ 3 –∑–∞–∫–∞–∑–æ–≤ —Å —Ü–µ–Ω–æ–π –±–æ–ª—å—à–µ 10.\n\n‚úÖ **–ó–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞!** üéØ\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-customers-multiple-orders"

[[tasks]]
  id = 12
  question = "–ù–∞–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å.–í—Å–µ–≥–æ 10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –í –≤—ã–≤–æ–¥–µ 5 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å—Ç–∞—Ç—É—Å–µ –ù–æ–≤—ã–π, 3 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å—Ç–∞—Ç—É—Å–µ –†–∞–±–æ—Ç–∞–µ—Ç. –ö—É–¥–∞ –¥–µ–ª–æ—Å—å –µ—â–µ 2 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?"
  answer = "```\n–°–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∫–∞–∫–æ–º —Å—Ç–∞—Ç—É—Å–µ?\n–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –≤–∏–¥–µ: –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞, –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —ç—Ç–æ–º —Å—Ç–∞—Ç—É—Å–µ\n\nUser\nid\nname\nstatus_id\n\nStatus\nid\nname\n\n```\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüìä –ó–∞–¥–∞—á–∞ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Å—á–µ—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞.  \nüîç –ú—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **`JOIN`** –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü **`User`** –∏ **`Status`**, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å–∞—Ö.  \nüîë –ò—Å–ø–æ–ª—å–∑—É–µ–º **`GROUP BY`** –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ —Å—Ç–∞—Ç—É—Å—É –∏ –ø–æ–¥—Å—á–µ—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∫–∞–∂–¥–æ–º —Å—Ç–∞—Ç—É—Å–µ.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT s.name AS status_name, COUNT(u.id) AS user_count\nFROM User u\nJOIN Status s ON u.status_id = s.id\nGROUP BY s.name;\n```\n\nüìå **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**\n\n- **`JOIN`** —Å–æ–µ–¥–∏–Ω—è–µ—Ç —Ç–∞–±–ª–∏—Ü—ã **`User`** –∏ **`Status`** –ø–æ –ø–æ–ª—é **`status_id`**.\n- **`GROUP BY s.name`** –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Å—Ç–∞—Ç—É—Å–∞.\n- **`COUNT(u.id)`** –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∫–∞–∂–¥–æ–º —Å—Ç–∞—Ç—É—Å–µ.\n\nüìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:**\n\n- –í –≤—ã–≤–æ–¥–µ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã —Å—Ç–∞—Ç—É—Å—ã —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —ç—Ç–∏—Ö —Å—Ç–∞—Ç—É—Å–∞—Ö. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –ø–æ–ø–∞–ª–∏ –≤ –≤—ã–≤–æ–¥, —ç—Ç–æ –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å, —á—Ç–æ –æ–Ω–∏ –∏–º–µ—é—Ç —Å—Ç–∞—Ç—É—Å, –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –≤ –∑–∞–ø—Ä–æ—Å–µ. –í–æ–∑–º–æ–∂–Ω–æ, –æ–Ω–∏ –∏–º–µ—é—Ç —Å—Ç–∞—Ç—É—Å, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –±—ã–ª —É—á—Ç–µ–Ω –≤ –ø–æ–¥—Å—á–µ—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±—ã–ª —É–¥–∞–ª–µ–Ω –∏–ª–∏ –∏–º–µ–µ—Ç –¥—Ä—É–≥–æ–π —Å—Ç–∞—Ç—É—Å, –Ω–µ —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ –≤—ã–≤–æ–¥–µ).\n\nüéØ **–ó–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞!**\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-missing-users"

[[tasks]]
  id = 13
  question = "–ü–æ–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏, –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –æ—Ç–¥–µ–ª–µ"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüîç **–ù–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∂–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏, –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ —ç—Ç–æ–º –æ—Ç–¥–µ–ª–µ.**\n\n```sql\nCREATE table if not exists company (\n    id uuid primary key,\n    name_ varchar NOT NULL\n);\n\nCREATE table if not exists department (\n    id uuid primary key,\n    name_ varchar NOT NULL,\n    company_id uuid NOT NULL,\n    CONSTRAINT department_fk FOREIGN KEY (company_id) REFERENCES company(id)\n);\n\nCREATE table if not exists employee (\n    id uuid primary key,\n    name_ varchar NOT NULL,\n    department_id uuid NOT NULL,\n    CONSTRAINT employee_fk FOREIGN KEY (department_id) REFERENCES department(id)\n);\n\ninsert into company (id, name_) values(1, 'Company 1') ON CONFLICT DO NOTHING;\ninsert into company (id, name_) values(2, 'Company 2') ON CONFLICT DO NOTHING;\ninsert into company (id, name_) values(3, 'Company 3') ON CONFLICT DO NOTHING;\n\ninsert into department (id, name_, company_id) values(1, 'Department 1', 1) ON CONFLICT DO NOTHING;\ninsert into department (id, name_, company_id) values(2, 'Department 2', 1) ON CONFLICT DO NOTHING;\ninsert into department (id, name_, company_id) values(3, 'Department 3', 2) ON CONFLICT DO NOTHING;\n\ninsert into employee (id, name_, department_id) values(1, 'Employee 1', 1) ON CONFLICT DO NOTHING;\ninsert into employee (id, name_, department_id) values(2, 'Employee 2', 2) ON CONFLICT DO NOTHING;\ninsert into employee (id, name_, department_id) values(3, 'Employee 3', 3) ON CONFLICT DO NOTHING;\n\n```\n\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüí° –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `JOIN` –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü `company`, `department` –∏ `employee`.  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `COUNT(*)` –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –æ—Ç–¥–µ–ª–µ.  \nüí° –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ `GROUP BY` –ø–æ–º–æ–∂–µ—Ç —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –æ—Ç–¥–µ–ª—É.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT \n    c.name_ AS company_name,\n    d.name_ AS department_name,\n    COUNT(e.id) AS employee_count\nFROM company c\nJOIN department d ON c.id = d.company_id\nLEFT JOIN employee e ON d.id = e.department_id\nGROUP BY c.name_, d.name_\nORDER BY c.name_, d.name_;\n```\n\n‚úÖ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:**\n\n- –°–æ–µ–¥–∏–Ω—è–µ–º `company` –∏ `department` –ø–æ `company_id`.\n- –ò—Å–ø–æ–ª—å–∑—É–µ–º `LEFT JOIN`, —á—Ç–æ–±—ã —É—á–µ—Å—Ç—å –æ—Ç–¥–µ–ª—ã –±–µ–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.\n- `COUNT(e.id)` —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –æ—Ç–¥–µ–ª–µ.\n- `GROUP BY` –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –æ—Ç–¥–µ–ª–∞.\n- `ORDER BY` —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –æ—Ç–¥–µ–ª—É.\n\nüöÄ **–¢–µ–ø–µ—Ä—å –∑–∞–ø—Ä–æ—Å –≤—ã–¥–∞—Å—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–ø–∞–Ω–∏–π, –∏—Ö –æ—Ç–¥–µ–ª–æ–≤ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –æ—Ç–¥–µ–ª–µ!** üî•\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-company-department-employee-count"

[[tasks]]
  id = 14
  question = "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ –µ–≥–æ –º–∞—à–∏–Ω—ã: —Å–≤—è–∑—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüîç **–°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –≥–¥–µ –æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–ª–∞–¥–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–∞—à–∏–Ω–∞–º–∏, –∞ –∫–∞–∂–¥–∞—è –º–∞—à–∏–Ω–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.**\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüí° –í `CAR` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–Ω–µ—à–Ω—è—è —Å–≤—è–∑—å (`FOREIGN KEY`) —Å `USER`, —É–∫–∞–∑—ã–≤–∞—é—â–∞—è –Ω–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞.  \nüí° –ö–∞–∂–¥—ã–π `USER` –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –≤ `CAR`, –Ω–æ –∫–∞–∂–¥–∞—è `CAR` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –æ–¥–Ω–æ–º—É `USER`.  \nüí° –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `JOIN`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –∏ –∏—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª—è—Ö.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π\nCREATE TABLE USER (\n    id INT PRIMARY KEY,\n    name VARCHAR(50) NOT NULL\n);\n\n-- –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π\nINSERT INTO USER (id, name) VALUES\n(1, 'Ivan'),\n(2, 'Oleg'),\n(3, 'Anna'),\n(4, 'Ivan'),\n(5, 'Ted');\n\n-- –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π\nCREATE TABLE CAR (\n    id INT PRIMARY KEY,\n    model VARCHAR(50) NOT NULL,\n    user_id INT NOT NULL,\n    FOREIGN KEY (user_id) REFERENCES USER(id) ON DELETE CASCADE\n);\n\n-- –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π\nINSERT INTO CAR (id, model, user_id) VALUES\n(4422, 'Opel 1', 1),\n(4523, 'BMW 5', 2),\n(4612, 'VW', 3),\n(4853, 'BMW 6', 4);\n\n-- –ó–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö –º–∞—à–∏–Ω\nSELECT \n    u.id AS user_id, \n    u.name AS user_name, \n    c.id AS car_id, \n    c.model AS car_model\nFROM USER u\nLEFT JOIN CAR c ON u.id = c.user_id\nORDER BY u.id;\n```\n\n‚úÖ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:**\n\n- –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É `USER`, –≥–¥–µ `id` ‚Äî –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á.\n- –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É `CAR`, –≥–¥–µ `user_id` ‚Äî –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á, —Å–≤—è–∑—ã–≤–∞—é—â–∏–π –º–∞—à–∏–Ω—É —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.\n- –î–æ–±–∞–≤–ª—è–µ–º `ON DELETE CASCADE`, —á—Ç–æ–±—ã –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–¥–∞–ª—è–ª–∏—Å—å –∏ –µ–≥–æ –º–∞—à–∏–Ω—ã.\n- `LEFT JOIN` –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –¥–∞–∂–µ –µ—Å–ª–∏ —É –Ω–∏—Ö –Ω–µ—Ç –º–∞—à–∏–Ω—ã.\n- `ORDER BY u.id` —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.\n\nüöÄ **–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –ø–æ–ª—É—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –∏ –∏—Ö –º–∞—à–∏–Ω–∞—Ö!** üî•\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-user-car-relationship"

[[tasks]]
  id = 15
  question = "–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π –º–∞—à–∏–Ω—ã"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüöó **–í—ã–≤–µ—Å—Ç–∏ –∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è.**\n\n```sql\n-- –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É USER\nCREATE TABLE USER (\n    id INT PRIMARY KEY,\n    name VARCHAR(50) NOT NULL\n);\n\n-- –í—Å—Ç–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É USER\nINSERT INTO USER (id, name) VALUES\n(1, 'Ivan'),\n(2, 'Oleg'),\n(3, 'Anna'),\n(4, 'Ivan'),\n(5, 'Ted');\n\n-- –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É CAR\nCREATE TABLE CAR (\n    id INT PRIMARY KEY,\n    model VARCHAR(50) NOT NULL,\n    user_id INT NOT NULL,\n    FOREIGN KEY (user_id) REFERENCES USER(id)\n);\n\n-- –í—Å—Ç–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É CAR\nINSERT INTO CAR (id, model, user_id) VALUES\n(4422, 'Opel 1', 1),\n(4523, 'BMV 5', 2),\n(4612, 'VW', 3),\n(4853, 'BMV 6', 4);\n```\n\n\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüí° –ù–∞–º –Ω—É–∂–Ω–æ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ `user_id`.  \nüí° –ò—Å–ø–æ–ª—å–∑—É–µ–º `HAVING` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π (`COUNT(user_id)`) –±–æ–ª—å—à–µ 1.  \nüí° –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É `USER`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏–º–µ–Ω–∞.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT u.name \nFROM USER u\nJOIN CAR c ON u.id = c.user_id\nGROUP BY u.id, u.name\nHAVING COUNT(c.id) > 1;\n```\n\n‚úÖ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:**\n\n- –ò—Å–ø–æ–ª—å–∑—É–µ–º `JOIN`, —á—Ç–æ–±—ã —Å–æ–µ–¥–∏–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–∏.\n- –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ `user_id`, —Ç–∞–∫ –∫–∞–∫ –Ω–∞–º –Ω—É–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω —É –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.\n- `HAVING COUNT(c.id) > 1` —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ—Ö, —É –∫–æ–≥–æ –º–∞—à–∏–Ω –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π.\n\nüî• –¢–µ–ø–µ—Ä—å –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è! üöÄ\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-users-multiple-cars"

[[tasks]]
  id = 16
  question = "–¢–æ–≤–∞—Ä—ã —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìä **–°–æ—Å—Ç–∞–≤–∏—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–æ–¥–∏—Ç –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.**\n\nüìå **–¢–∞–±–ª–∏—Ü–∞ `Prices` (–¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–∞—Ö):**\n\n- `Name` ‚Äì –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞\n- `Category` ‚Äì –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞\n- `Price` ‚Äì —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞\n\nüöÄ **–¢—Ä–µ–±—É–µ—Ç—Å—è –≤–µ—Ä–Ω—É—Ç—å:**\n\n- `Category`\n- `Name` (—Ç–æ–≤–∞—Ä —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)\n- `Price` (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)\n\n\n```text\n–î–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ Prices –≤ –ë–î.\nName        Category             Price\n--------------------------------------\n–ê–ø–µ–ª—å—Å–∏–Ω    –§—Ä—É–∫—Ç—ã               50\n–ú–∞–Ω–¥–∞—Ä–∏–Ω    –§—Ä—É–∫—Ç—ã               45\n–Ø–±–ª–æ–∫–æ      –§—Ä—É–∫—Ç—ã               30\n–û–≥—É—Ä–µ—Ü      –û–≤–æ—â–∏                35\n–¢–æ–º–∞—Ç       –û–≤–æ—â–∏                40\n–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å   –û–≤–æ—â–∏                25\n–ú–æ–ª–æ–∫–æ      –ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã    30\n–¢–≤–æ—Ä–æ–≥      –ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã    40\n\n\n```\n\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüí° –î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞—Ö–æ–¥–∏–º **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É** —Å –ø–æ–º–æ—â—å—é `MAX(Price)`.  \nüí° –ó–∞—Ç–µ–º –≤—ã–±–∏—Ä–∞–µ–º —Ç–æ–≤–∞—Ä—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö `Price` —Ä–∞–≤–Ω–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–º—É –º–∞–∫—Å–∏–º—É–º—É.  \nüí° –ò—Å–ø–æ–ª—å–∑—É–µ–º `JOIN` –∏–ª–∏ `WHERE` —Å –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–º.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT p1.Category, p1.Name, p1.Price\nFROM Prices p1\nWHERE p1.Price = (\n    SELECT MAX(p2.Price) \n    FROM Prices p2 \n    WHERE p1.Category = p2.Category\n);\n```\n\n‚úÖ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:**\n\n- –ü–æ–¥–∑–∞–ø—Ä–æ—Å `SELECT MAX(p2.Price) FROM Prices p2 WHERE p1.Category = p2.Category` –Ω–∞—Ö–æ–¥–∏—Ç **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏**.\n- –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—Ä–æ—Å –≤—ã–±–∏—Ä–∞–µ—Ç **—Ç–æ–≤–∞—Ä—ã —Å —ç—Ç–æ–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π**.\n- –ï—Å–ª–∏ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π, –æ–Ω–∏ **–≤—Å–µ –ø–æ–ø–∞–¥—É—Ç –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç**.\n\nüî• –¢–µ–ø–µ—Ä—å –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω–µ—Ç —Ç–æ–≤–∞—Ä—ã —Å —Å–∞–º–æ–π –≤—ã—Å–æ–∫–æ–π —Ü–µ–Ω–æ–π –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏! üöÄ\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-max-price-by-category"

[[tasks]]
  id = 17
  question = "–ü–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ INN –∏ KPP"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå **–ù–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ `inn` –∏ `kpp` –≤ —Ç–∞–±–ª–∏—Ü–µ `KF_ADAPTER_R_CLIENT`.**\n\n- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–ø—Ä–æ—Å—Ç–∞—è –≤—ã–±–æ—Ä–∫–∞** –ø–æ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ.\n- –í —Ç–∞–±–ª–∏—Ü–µ `KF_ADAPTER_R_CLIENT` –µ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö, –≤–∫–ª—é—á–∞—è `inn` (–ò–ù–ù) –∏ `kpp` (–ö–ü–ü).\n\n\n```sql\nCREATE TABLE KF_ADAPTER_R_CLIENT (\n    id SERIAL PRIMARY KEY,\n    abs_id VARCHAR(255),\n    branch_id VARCHAR(255),\n    abs_branch_id VARCHAR(255),\n    short_name VARCHAR(255),\n    inn VARCHAR(12),\n    kpp VARCHAR(9),\n    sign_count INT,\n    deleted BOOLEAN\n);\n\nCREATE TABLE KF_ADAPTER_R_DELEGATE (\n    id SERIAL PRIMARY KEY,\n    client_id INT,\n    abs_id VARCHAR(255),\n    user_id VARCHAR(255),\n    full_name VARCHAR(255),\n    phone VARCHAR(15),\n    sign_role VARCHAR(50),\n    deleted BOOLEAN,\n    FOREIGN KEY (client_id) REFERENCES KF_ADAPTER_R_CLIENT(id)\n);\n\n```\n\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüí° –î–ª—è –ø–æ–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º `WHERE`.  \nüí° `inn` –∏ `kpp` –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ–≤–µ—Ä—è–µ–º –∏—Ö **—Å–æ–≤–º–µ—Å—Ç–Ω–æ**.  \nüí° –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ **—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏**, –∏—Å–ø–æ–ª—å–∑—É–µ–º `=`.  \nüí° –ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å **–ø–æ—Ö–æ–∂–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏**, –∏—Å–ø–æ–ª—å–∑—É–µ–º `LIKE`.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT * \nFROM KF_ADAPTER_R_CLIENT \nWHERE inn = '7701234567' \nAND kpp = '770101001';\n```\n\n‚úÖ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:**\n\n- –ó–∞–ø—Ä–æ—Å –≤—ã–±–∏—Ä–∞–µ—Ç **–≤—Å–µ –∫–æ–ª–æ–Ω–∫–∏** (`*`) –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `KF_ADAPTER_R_CLIENT`.\n- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ —Ç–æ—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é **–ò–ù–ù** –∏ **–ö–ü–ü** (`WHERE inn = ... AND kpp = ...`).\n- –ï—Å–ª–∏ **–Ω—É–∂–µ–Ω –ø–æ–∏—Å–∫ –ø–æ —á–∞—Å—Ç–∏—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é**, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `LIKE`:\n\n```sql\nSELECT * \nFROM KF_ADAPTER_R_CLIENT \nWHERE inn LIKE '770%' \nAND kpp LIKE '7701%';\n```\n\nüî• –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ `inn` –∏ `kpp` –±—ã—Å—Ç—Ä–æ –∏ –ø—Ä–æ—Å—Ç–æ! üöÄ\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-find-clients-by-inn-kpp"

[[tasks]]
  id = 18
  question = "–î–µ–ª–µ–≥–∞—Ç—ã –∫–ª–∏–µ–Ω—Ç–æ–≤: –Ω–∞–π—Ç–∏ –ø–æ INN/KPP, –≤—ã–≤–µ—Å—Ç–∏ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå **–ù–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –¥–µ–ª–µ–≥–∞—Ç–æ–≤ (`KF_ADAPTER_R_DELEGATE`) –ø–æ `inn` –∏ `kpp` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `KF_ADAPTER_R_CLIENT`.**\n\n- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–≤–µ—Å—Ç–∏ —Ç–æ–ª—å–∫–æ `full_name` (–ø–æ–ª–Ω–æ–µ –∏–º—è) –∏ `phone` (—Ç–µ–ª–µ—Ñ–æ–Ω).\n- –¢–∞–±–ª–∏—Ü—ã —Å–≤—è–∑–∞–Ω—ã –ø–æ `client_id`.\n\n\n```sql\nCREATE TABLE KF_ADAPTER_R_CLIENT (\n    id SERIAL PRIMARY KEY,\n    abs_id VARCHAR(255),\n    branch_id VARCHAR(255),\n    abs_branch_id VARCHAR(255),\n    short_name VARCHAR(255),\n    inn VARCHAR(12),\n    kpp VARCHAR(9),\n    sign_count INT,\n    deleted BOOLEAN\n);\n\nCREATE TABLE KF_ADAPTER_R_DELEGATE (\n    id SERIAL PRIMARY KEY,\n    client_id INT,\n    abs_id VARCHAR(255),\n    user_id VARCHAR(255),\n    full_name VARCHAR(255),\n    phone VARCHAR(15),\n    sign_role VARCHAR(50),\n    deleted BOOLEAN,\n    FOREIGN KEY (client_id) REFERENCES KF_ADAPTER_R_CLIENT(id)\n);\n\n```\n\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüí° –°–≤—è–∑—å –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏–¥–µ—Ç –ø–æ **client_id**.  \nüí° –î–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏—Å–ø–æ–ª—å–∑—É–µ–º `JOIN`.  \nüí° –§–∏–ª—å—Ç—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ `inn` –∏ `kpp` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `KF_ADAPTER_R_CLIENT`.  \nüí° –ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–∫–ª—é—á–∏—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã—Ö (`deleted = TRUE`), –¥–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ñ–∏–ª—å—Ç—Ä.\n\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT d.full_name, d.phone \nFROM KF_ADAPTER_R_DELEGATE d\nJOIN KF_ADAPTER_R_CLIENT c ON d.client_id = c.id\nWHERE c.inn = '7701234567' \nAND c.kpp = '770101001'\nAND d.deleted = FALSE;\n```\n\n‚úÖ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:**\n\n- **`JOIN`** —Å–≤—è–∑—ã–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã `KF_ADAPTER_R_CLIENT` –∏ `KF_ADAPTER_R_DELEGATE` –ø–æ `client_id`.\n- **–§–∏–ª—å—Ç—Ä –ø–æ `inn` –∏ `kpp`** –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.\n- **`d.deleted = FALSE`** –∏—Å–∫–ª—é—á–∞–µ—Ç —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –¥–µ–ª–µ–≥–∞—Ç–æ–≤.\n- **–í—ã–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è**: `full_name` –∏ `phone`.\n\nüî• –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å —Å–ø–∏—Å–æ–∫ –¥–µ–ª–µ–≥–∞—Ç–æ–≤ –ø–æ –ò–ù–ù –∏ –ö–ü–ü! üöÄ\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-find-delegates-by-inn-kpp"

[[tasks]]
  id = 19
  question = "–¢–æ–ø-10 —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤, –ø–æ–ª—É—á–∏–≤—à–∏—Ö –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ SMS"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå **–ù–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ (`phone`), –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—É—á–∏–ª–∏ –±–æ–ª–µ–µ –æ–¥–Ω–æ–π SMS.**\n\n- –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–æ–±—â–µ–Ω–∏–π.\n- –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ **—Ç–æ–ø-10** –Ω–æ–º–µ—Ä–æ–≤ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö SMS.\n\n```sql\ntable: sms\nid   | phone      | message\n1    | 9876552222 | some message\n2    | 9876552222 | some message\n3    | 9876552234 | another message\n\n```\n\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†\n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüí° –ò—Å–ø–æ–ª—å–∑—É–π `GROUP BY`, —á—Ç–æ–±—ã —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ `phone`.  \nüí° `HAVING COUNT(*) > 1` –ø–æ–º–æ–∂–µ—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ –Ω–æ–º–µ—Ä–∞, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª–µ–µ –æ–¥–Ω–æ–π SMS.  \nüí° `ORDER BY COUNT(*) DESC` –æ–±–µ—Å–ø–µ—á–∏—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫ –º–µ–Ω—å—à–µ–º—É.  \nüí° `LIMIT 10` –ø–æ–∑–≤–æ–ª–∏—Ç –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ç–æ–ø-10 –Ω–æ–º–µ—Ä–æ–≤.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT phone, COUNT(*) AS sms_count\nFROM sms\nGROUP BY phone\nHAVING COUNT(*) > 1\nORDER BY sms_count DESC\nLIMIT 10;\n```\n\n‚úÖ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:**\n\n- **`GROUP BY phone`** ‚Äì –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –∑–∞–ø–∏—Å–∏ –ø–æ –Ω–æ–º–µ—Ä–∞–º —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤.\n- **`COUNT(*) AS sms_count`** ‚Äì —Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–æ–º–µ—Ä–∞.\n- **`HAVING COUNT(*) > 1`** ‚Äì —Ñ–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ –Ω–æ–º–µ—Ä–∞, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π SMS.\n- **`ORDER BY sms_count DESC`** ‚Äì —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–æ–±—â–µ–Ω–∏–π.\n- **`LIMIT 10`** ‚Äì –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ 10 —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π.\n\nüî• –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ —Ç–æ–ø-10 –Ω–æ–º–µ—Ä–æ–≤, –ø–æ–ª—É—á–∏–≤—à–∏—Ö –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ SMS! üì≤üöÄ\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-top-sms-recipients"

[[tasks]]
  id = 20
  question = "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ –∑–∞–∫–∞–∑–æ–≤"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå **–ù–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö `id` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `users`, —É –∫–æ—Ç–æ—Ä—ã—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∑–∞–∫–∞–∑—ã –≤ —Ç–∞–±–ª–∏—Ü–µ `orders`.**  \n\n- –¢–∞–±–ª–∏—Ü–∞ `users` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ `id`.  \n- –¢–∞–±–ª–∏—Ü–∞ `orders` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª—è `userId` –∏ `orderId`.  \n- –ó–∞–¥–∞—á–∞ ‚Äî –Ω–∞–π—Ç–∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –≤ `orders`.\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüí° –î–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é `LEFT JOIN` –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ NULL.  \nüí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ ‚Äî –ø—Ä–∏–º–µ–Ω–∏—Ç—å —É—Å–ª–æ–≤–∏–µ `NOT EXISTS` –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∑–∞–∫–∞–∑–∞–º–∏.  \nüí° –û–±–∞ –ø–æ–¥—Ö–æ–¥–∞ –ø–æ–∑–≤–æ–ª—è—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—ã–±—Ä–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ `orders`.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ LEFT JOIN\nSELECT u.id\nFROM users u\nLEFT JOIN orders o ON u.id = o.userId\nWHERE o.userId IS NULL;\n\n-- –†–µ—à–µ–Ω–∏–µ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ NOT EXISTS\nSELECT u.id\nFROM users u\nWHERE NOT EXISTS (\n    SELECT 1 \n    FROM orders o \n    WHERE o.userId = u.id\n);\n````\n\n‚úÖ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:**\n\n- **–†–µ—à–µ–Ω–∏–µ 1:**  \n    –ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç LEFT JOIN —Ç–∞–±–ª–∏—Ü—ã `users` —Å —Ç–∞–±–ª–∏—Ü–µ–π `orders`. –ï—Å–ª–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∑–∞–ø–∏—Å–∏, –∑–Ω–∞—á–µ–Ω–∏–µ `o.userId` –±—É–¥–µ—Ç NULL, —á—Ç–æ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —É—Å–ª–æ–≤–∏–∏ WHERE –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ —Ç–∞–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.\n    \n- **–†–µ—à–µ–Ω–∏–µ 2:**  \n    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–¥–∑–∞–ø—Ä–æ—Å —Å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π `NOT EXISTS`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ `orders` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `users`.\n    \n\nüî• –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –∑–∞–∫–∞–∑–æ–≤! {{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-users-without-orders"

[[tasks]]
  id = 21
  question = "–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö N –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –≤—Å–µ—Ö –∏—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå **–ù–∞–ø–∏—Å–∞—Ç—å –æ–¥–∏–Ω SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω—ë—Ç N –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `news` –≤–º–µ—Å—Ç–µ —Å–æ –≤—Å–µ–º–∏ –∏—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `comments`.**  \n\n- –¢–∞–±–ª–∏—Ü–∞ `news` –∏–º–µ–µ—Ç –ø–æ–ª—è: `id` (integer auto_increment).  \n- –¢–∞–±–ª–∏—Ü–∞ `comments` –∏–º–µ–µ—Ç –ø–æ–ª—è: `id` (integer auto_increment), `news_id` (integer).  \n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüí° –ú–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–º, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –Ω–æ–≤–æ—Å—Ç–µ–π, –∞ –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç—å LEFT JOIN —Å —Ç–∞–±–ª–∏—Ü–µ–π `comments` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∫ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –Ω–æ–≤–æ—Å—Ç—è–º.  \nüí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CTE (Common Table Expression) –¥–ª—è –æ—Ç–±–æ—Ä–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –Ω–æ–≤–æ—Å—Ç–µ–π, –∞ –∑–∞—Ç–µ–º –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å –∫ –Ω–∏–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞ —Å LEFT JOIN\nSELECT n.*, c.*\nFROM (\n    SELECT *\n    FROM news\n    ORDER BY id DESC\n    LIMIT N  -- –ø–æ–¥—Å—Ç–∞–≤—å—Ç–µ –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤–æ—Å—Ç–µ–π\n) n\nLEFT JOIN comments c ON n.id = c.news_id;\n\n-- –†–µ—à–µ–Ω–∏–µ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CTE (Common Table Expression)\nWITH latest_news AS (\n    SELECT *\n    FROM news\n    ORDER BY id DESC\n    LIMIT N  -- –ø–æ–¥—Å—Ç–∞–≤—å—Ç–µ –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤–æ—Å—Ç–µ–π\n)\nSELECT ln.*, c.*\nFROM latest_news ln\nLEFT JOIN comments c ON ln.id = c.news_id;\n````\n\n‚úÖ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:**\n\n- **–†–µ—à–µ–Ω–∏–µ 1:**\n    \n    - –ü–æ–¥–∑–∞–ø—Ä–æ—Å `n` –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `news`, —Å–æ—Ä—Ç–∏—Ä—É—è –∏—Ö –ø–æ —É–±—ã–≤–∞–Ω–∏—é `id`.\n        \n    - LEFT JOIN —Å —Ç–∞–±–ª–∏—Ü–µ–π `comments` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ—Å—Ç–∏.\n        \n- **–†–µ—à–µ–Ω–∏–µ 2:**\n    \n    - CTE `latest_news` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö N –Ω–æ–≤–æ—Å—Ç–µ–π.\n        \n    - –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—Ä–æ—Å –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ –ø–æ–ª—é `news_id`, —Å–≤—è–∑—ã–≤–∞—è –∏—Ö —Å –Ω–æ–≤–æ—Å—Ç—è–º–∏ –∏–∑ CTE.\n        \n\nüî• –û–±–∞ —Ä–µ—à–µ–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–ª—É—á–∏—Ç—å –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä—É—è –Ω–æ–≤–æ—Å—Ç–∏ –∏ –∏—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏! {{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-n-last-news-with-comments"

[[tasks]]
  id = 22
  question = "–í—ã–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –Ω–æ–≤–æ—Å—Ç–µ–π —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –æ–±—ä–µ–º–µ –¥–∞–Ω–Ω—ã—Ö"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå **–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `news` –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `comments`, –¥–∞–∂–µ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –æ–±—ä–µ–º–µ –¥–∞–Ω–Ω—ã—Ö.**  \n\n- –¢–∞–±–ª–∏—Ü–∞ `news` —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–æ–≤–æ—Å—Ç–∏ (`id` ‚Äî –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç).  \n- –¢–∞–±–ª–∏—Ü–∞ `comments` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (`news_id` —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ `news.id`).  \n- –î–æ–ø—É—Å—Ç–∏–º, –¥–∞–Ω–Ω—ã—Ö **–æ—á–µ–Ω—å –º–Ω–æ–≥–æ**, –≤–∞–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏.\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüí° –ò—Å–ø–æ–ª—å–∑—É–π **–ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—É—é –≤—ã–±–æ—Ä–∫—É (pagination)**, —á—Ç–æ–±—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —á–∞—Å—Ç—è–º–∏.  \nüí° –í–∞–∂–Ω–æ –¥–µ–ª–∞—Ç—å **LEFT JOIN**, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.  \nüí° –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–ø–æ—Ç–æ–∫–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É** –∏–ª–∏ **batch-–∑–∞–≥—Ä—É–∑–∫—É** –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–æ–¥–∞.  \nüí° –í PostgreSQL –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `FETCH NEXT`, –≤ MySQL ‚Äî `LIMIT` –∏ `OFFSET`.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- –ü—Ä–∏–º–µ—Ä –±–∞–∑–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å LEFT JOIN\nSELECT n.*, c.*\nFROM news n\nLEFT JOIN comments c ON n.id = c.news_id;\n````\n\n‚úÖ **–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≥—Ä—É–∑–∫—É —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –ø—Ä–∏ –±–æ–ª—å—à–æ–º –æ–±—ä–µ–º–µ –¥–∞–Ω–Ω—ã—Ö:**\n\n1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É:**\n    \n\n```sql\n-- –ü—Ä–∏–º–µ—Ä —Å LIMIT –∏ OFFSET\nSELECT n.*, c.*\nFROM news n\nLEFT JOIN comments c ON n.id = c.news_id\nORDER BY n.id\nLIMIT 1000 OFFSET 0; -- –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ OFFSET –±—É–¥–µ—Ç 1000, –∑–∞—Ç–µ–º 2000 –∏ —Ç.–¥.\n```\n\n2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, JDBC –∏–ª–∏ ORM):**\n    \n\n```java\nPreparedStatement stmt = connection.prepareStatement(\n    \"SELECT n.*, c.* FROM news n LEFT JOIN comments c ON n.id = c.news_id ORDER BY n.id\",\n    ResultSet.TYPE_FORWARD_ONLY,\n    ResultSet.CONCUR_READ_ONLY\n);\nstmt.setFetchSize(1000);\nResultSet rs = stmt.executeQuery();\n```\n\n3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—ã–≥—Ä—É–∑–∫—É –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É `id` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `WHERE n.id BETWEEN ...`), —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å OFFSET.**\n    \n\n```sql\nSELECT n.*, c.*\nFROM news n\nLEFT JOIN comments c ON n.id = c.news_id\nWHERE n.id BETWEEN 10001 AND 11000\nORDER BY n.id;\n```\n\nüî• –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –¥–∞–∂–µ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å—Ç—Ä–æ–∫ –º–æ–∂–Ω–æ **–≥–∏–±–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏**, –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—è —Å–∏—Å—Ç–µ–º—É. {{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-export-news-with-comments"

[[tasks]]
  id = 23
  question = "–¢–æ–ø-3 –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –ø–æ —á–∏—Å–ª—É –≤–∏–∑–∏—Ç–æ–≤"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ `visits(visit_id, visitor_name, timestamp)`.  \n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–≤–µ—Å—Ç–∏ –∏–º–µ–Ω–∞ —Ç—Ä—ë—Ö –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ (–≤–∏–∑–∏—Ç–æ–≤).\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GROUP BY visitor_name` –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –≤–∏–∑–∏—Ç–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É —á–µ–ª–æ–≤–µ–∫—É.  \nüí° –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–∏–∑–∏—Ç–æ–≤ (`COUNT(*) DESC`).  \nüí° –ü—Ä–∏–º–µ–Ω–∏—Ç–µ `LIMIT 3` –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ —Ç—Ä–µ—Ö –∑–∞–ø–∏—Å–µ–π.  \nüí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ–∫–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π `ROW_NUMBER()` –∏–ª–∏ `RANK()`.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 1: GROUP BY + ORDER BY + LIMIT\nSELECT\n  visitor_name,\n  COUNT(*) AS visit_count\nFROM visits\nGROUP BY visitor_name\nORDER BY visit_count DESC\nLIMIT 3;\n```\n\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 2: –û–∫–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è ROW_NUMBER()\nSELECT visitor_name, visit_count\nFROM (\n  SELECT\n    visitor_name,\n    COUNT(*) OVER (PARTITION BY visitor_name) AS visit_count,\n    ROW_NUMBER() OVER (\n      PARTITION BY visitor_name\n      ORDER BY COUNT(*) OVER (PARTITION BY visitor_name) DESC\n    ) AS rn\n  FROM visits\n) t\nWHERE rn = 1\nGROUP BY visitor_name, visit_count\nORDER BY visit_count DESC\nLIMIT 3;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-top-3-visitors-by-visit-count"

[[tasks]]
  id = 24
  question = "–ù–∞–∑–≤–∞–Ω–∏—è –∏ —Ü–µ–Ω—ã —É—Å–ª—É–≥, –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Å 1 —è–Ω–≤–∞—Ä—è 2021 –ø–æ —Å–ª–µ–¥—É—é—â—É—é –Ω–µ–¥–µ–ª—é"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã:  \n- **Services** (`id`, `name`, `cost`, `price`, `group_id`)  \n- **Groups** (`id`, `name`)  \n- **Orders** (`id`, `datetime`, `srv_id`)  \n\n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–≤–µ—Å—Ç–∏ **–Ω–∞–∑–≤–∞–Ω–∏–µ** –∏ **—Ä–æ–∑–Ω–∏—á–Ω—É—é —Ü–µ–Ω—É** (`price`) –¥–ª—è –≤—Å–µ—Ö —É—Å–ª—É–≥, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–¥–∞–≤–∞–ª–∏—Å—å **1 —è–Ω–≤–∞—Ä—è 2021 –∏ –≤ —Ç–µ—á–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–∏**.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –°–æ–µ–¥–∏–Ω–∏—Ç–µ **Orders** —Å **Services** –ø–æ `srv_id = Services.id`.  \nüí° –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –¥–∞—Ç: –æ—Ç `'2021-01-01'` –¥–æ `'2021-01-08'` (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ).  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `DISTINCT`, —á—Ç–æ–±—ã –∫–∞–∂–¥–∞—è —É—Å–ª—É–≥–∞ –≤—ã–≤–æ–¥–∏–ª–∞—Å—å –µ–¥–∏–Ω–æ–∂–¥—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –±—ã–ª–∞ –ø—Ä–æ–¥–∞–Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑.  \nüí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±—Ä–∞—Ç—å `srv_id` –ø–æ —Ñ–∏–ª—å—Ç—Ä—É –¥–∞—Ç, –∞ –∑–∞—Ç–µ–º –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å **Services** —á–µ—Ä–µ–∑ `IN` –∏–ª–∏ `EXISTS`.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 1: JOIN + DISTINCT + –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç\nSELECT DISTINCT s.name,\n       s.price\nFROM Services s\nJOIN Orders o ON o.srv_id = s.id\nWHERE o.datetime >= '2021-01-01'\n  AND o.datetime <  '2021-01-09';\n```\n\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞ —Å IN\nSELECT s.name,\n       s.price\nFROM Services s\nWHERE s.id IN (\n    SELECT o.srv_id\n    FROM Orders o\n    WHERE o.datetime BETWEEN '2021-01-01' AND '2021-01-08'\n);\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-services-january-2021-week"

[[tasks]]
  id = 25
  question = "–ì—Ä—É–ø–ø—ã –±–µ–∑ —É—Å–ª—É–≥"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã:  \n- **Services** (`id`, `name`, `cost`, `price`, `group_id`)  \n- **Groups** (`id`, `name`)  \n\n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–≤–µ—Å—Ç–∏ **–Ω–∞–∑–≤–∞–Ω–∏—è –≥—Ä—É–ø–ø**, –≤ –∫–æ—Ç–æ—Ä—ã—Ö **–Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–π —É—Å–ª—É–≥–∏**.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **LEFT JOIN** –º–µ–∂–¥—É `Groups` –∏ `Services`, –∞ –≤ `WHERE` –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ `NULL` –≤ –ø–æ–ª—è—Ö `Services`.  \nüí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ, –ø—Ä–∏–º–µ–Ω–∏—Ç–µ **NOT EXISTS** —Å –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–º, –ø—Ä–æ–≤–µ—Ä—è—é—â–∏–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —É—Å–ª—É–≥ –≤ –≥—Ä—É–ø–ø–µ.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 1: LEFT JOIN + —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ NULL  \nSELECT g.name  \nFROM Groups g  \nLEFT JOIN Services s ON g.id = s.group_id  \nWHERE s.id IS NULL;\n\n-- –†–µ—à–µ–Ω–∏–µ 2: NOT EXISTS  \nSELECT g.name  \nFROM Groups g  \nWHERE NOT EXISTS (  \n    SELECT 1  \n    FROM Services s  \n    WHERE s.group_id = g.id  \n);\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-groups-without-services"

[[tasks]]
  id = 26
  question = "–¢–∞–±–ª–∏—Ü—ã –¥–ª—è –∞–≤—Ç–æ—Ä–æ–≤ –∏ –∫–Ω–∏–≥ (–º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º)"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å –¥–≤–µ —Å—É—â–Ω–æ—Å—Ç–∏: **–ê–≤—Ç–æ—Ä—ã** –∏ **–ö–Ω–∏–≥–∏**.  \n–ö–∞–∂–¥—ã–π –∞–≤—Ç–æ—Ä –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –º–Ω–æ–≥–æ –∫–Ω–∏–≥, –∏ –∫–∞–∂–¥–∞—è –∫–Ω–∏–≥–∞ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –º–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–æ–≤ (–æ—Ç–Ω–æ—à–µ–Ω–∏–µ ¬´–º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º¬ª).  \n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø–∏—Å–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∞–∫–æ–π —Å–≤—è–∑–∏.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –í –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ **–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é (junction) —Ç–∞–±–ª–∏—Ü—É**.  \nüí° –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã ‚Äî `authors` –∏ `books` ‚Äî —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–≤—Ç–æ—Ä–∞—Ö –∏ –∫–Ω–∏–≥–∞—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.  \nüí° Junction-—Ç–∞–±–ª–∏—Ü–∞ —Ö—Ä–∞–Ω–∏—Ç –ø–∞—Ä—ã `(author_id, book_id)`.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\n-- –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∞–≤—Ç–æ—Ä–æ–≤\nCREATE TABLE authors (\n    id   SERIAL PRIMARY KEY,\n    name VARCHAR(255) NOT NULL\n);\n\n-- –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∫–Ω–∏–≥\nCREATE TABLE books (\n    id    SERIAL PRIMARY KEY,\n    title VARCHAR(255) NOT NULL\n);\n\n-- –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è —Å–≤—è–∑–∏ –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º\nCREATE TABLE author_book (\n    author_id INT NOT NULL,\n    book_id   INT NOT NULL,\n    PRIMARY KEY (author_id, book_id),\n    FOREIGN KEY (author_id) REFERENCES authors(id),\n    FOREIGN KEY (book_id)   REFERENCES books(id)\n);\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-authors-books"

[[tasks]]
  id = 27
  question = "–†—ã–±—ã —Å —Å—É–º–º–∞—Ä–Ω—ã–º —É–ª–æ–≤–æ–º –Ω–∞ –¥–∞—Ç—É d –º–µ–Ω–µ–µ n"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã:  \n- **fish** (`id`, `name`)  \n- **catch** (`id`, `fish_id`, `dt`, `quantity`)  \n\n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–≤–µ—Å—Ç–∏ **–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Ä—ã–±**, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö **—Å—É–º–º–∞—Ä–Ω—ã–π —É–ª–æ–≤** –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∞—Ç—É `d` **–º–µ–Ω—å—à–µ** —á–µ–º `n`.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ –¥–µ–ª–∞–µ—Ç—Å—è –≤ `WHERE dt = :d`.  \nüí° –°—É–º–º–∞—Ä–Ω—ã–π —É–ª–æ–≤ —Å—á–∏—Ç–∞–µ–º —á–µ—Ä–µ–∑ `SUM(quantity)` –∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –ø–æ `fish_id`.  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `HAVING SUM(quantity) < :n` –¥–ª—è –ø–µ—Ä–≤–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.  \nüí° –í–æ –≤—Ç–æ—Ä–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å **–ø–æ–¥–∑–∞–ø—Ä–æ—Å** –ª–∏–±–æ **LEFT JOIN** –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –∞–≥—Ä–µ–≥–∞—Ç—É.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n-- –†–µ—à–µ–Ω–∏–µ 1: GROUP BY + HAVING  \n```sql\nSELECT f.name\nFROM fish f\nJOIN catch c ON f.id = c.fish_id\nWHERE c.dt = :d\nGROUP BY f.name\nHAVING SUM(c.quantity) < :n;\n```\n\n-- –†–µ—à–µ–Ω–∏–µ 2: –ü–æ–¥–∑–∞–ø—Ä–æ—Å –≤ WHERE\n\n```sql\nSELECT f.name\nFROM fish f\nWHERE (\n    SELECT COALESCE(SUM(c.quantity), 0)\n    FROM catch c\n    WHERE c.fish_id = f.id\n      AND c.dt = :d\n) < :n;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-fish-with-catch-less-than"

[[tasks]]
  id = 28
  question = "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ –ø–æ–µ–∑–¥–æ–∫"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã:  \n\n```sql\n\ncreate table users (\n    id int8 primary key,\n    name text,\n    email text\n);\n\ncreate table trips (\n    id int8 primary key,\n    scooter int8,\n    user_id int8,\n    started_at timestamptz,\n    finished_at timestamptz\n);\n\ncreate table pauses (\n    id int8 primary key,\n    trip_id int8,\n    started_at timestamptz,\n    finished_at timestamptz\n);\n\n```\n\n–ù—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ `id` –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–π –ø–æ–µ–∑–¥–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ `trips`.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `LEFT JOIN` –º–µ–∂–¥—É `users` –∏ `trips`, —Ñ–∏–ª—å—Ç—Ä—É—è –ø–æ `trips.user_id IS NULL`.  \nüí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ, –ø—Ä–∏–º–µ–Ω–∏—Ç–µ `NOT EXISTS` —Å –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–º, –ø—Ä–æ–≤–µ—Ä—è—é—â–∏–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ `trips` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 1: LEFT JOIN + —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ NULL\nSELECT u.id\nFROM users u\nLEFT JOIN trips t ON u.id = t.user_id\nWHERE t.user_id IS NULL;\n\n-- –†–µ—à–µ–Ω–∏–µ 2: NOT EXISTS\nSELECT u.id\nFROM users u\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM trips t\n    WHERE t.user_id = u.id\n);\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-users-without-trips"

[[tasks]]
  id = 29
  question = "–ò–º–µ–Ω–∞, –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è –±–æ–ª–µ–µ 5 —Ä–∞–∑"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ `students(name text, \"group\" text, cource bigint)` –≤ PostgreSQL.  \n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å –∏ –≤—ã–≤–µ—Å—Ç–∏ —Ç–µ `name`, –∫–æ—Ç–æ—Ä—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –±–æ–ª–µ–µ 5 —Ä–∞–∑.\n\n{{< hint warning >}}\n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GROUP BY name` –¥–ª—è –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –∏–º–µ–Ω–∏.  \nüí° –ü—Ä–∏–º–µ–Ω–∏—Ç–µ `HAVING COUNT(*) > 5` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≥—Ä—É–ø–ø —Å –±–æ–ª–µ–µ —á–µ–º 5 –≤—Ö–æ–∂–¥–µ–Ω–∏—è–º–∏.  \nüí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ ‚Äî –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ–∫–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π `COUNT(*) OVER (PARTITION BY name)` –∏ –æ–±–µ—Ä–Ω—É—Ç—å –≤ –ø–æ–¥–∑–∞–ø—Ä–æ—Å —Å —Ñ–∏–ª—å—Ç—Ä–æ–º.\n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 1: GROUP BY + HAVING\nSELECT name\nFROM students\nGROUP BY name\nHAVING COUNT(*) > 5;\n\n-- –†–µ—à–µ–Ω–∏–µ 2: –û–∫–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è + DISTINCT\nSELECT DISTINCT name\nFROM (\n    SELECT\n        name,\n        COUNT(*) OVER (PARTITION BY name) AS name_count\n    FROM students\n) t\nWHERE name_count > 5;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-names-occurring-more-than-5"

[[tasks]]
  id = 30
  question = "–°–∞–º—ã–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∑–Ω–∞—á–µ–Ω–∏—è `value`"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ `key` –∏ `value`:\n```text\nkey | value\n----+-------\n1   | sdfs\n2   | dsfg\n3   | sdfs\n```\n\n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ —Å–∞–º–æ–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–µ–µ—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–ª–æ–Ω–∫–µ `value`.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GROUP BY value` –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—Ö–æ–∂–¥–µ–Ω–∏–π –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.  \nüí° –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—á—ë—Ç—á–∏–∫–∞ (`COUNT(*) DESC`) –∏ –≤–æ–∑—å–º–∏—Ç–µ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É (`LIMIT 1`).  \nüí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –æ–∫–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `ROW_NUMBER()` –∏–ª–∏ `RANK()`, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 1: GROUP BY + ORDER BY + LIMIT\nSELECT value\nFROM your_table\nGROUP BY value\nORDER BY COUNT(*) DESC\nLIMIT 1;\n\n-- –†–µ—à–µ–Ω–∏–µ 2: –û–∫–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è RANK()\nSELECT value\nFROM (\n    SELECT\n        value,\n        RANK() OVER (ORDER BY COUNT(*) DESC) AS rnk\n    FROM your_table\n    GROUP BY value\n) t\nWHERE rnk = 1;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-most-frequent-value"

[[tasks]]
  id = 31
  question = "–í—ã–±–æ—Ä –ø—è—Ç–∏ –≤–µ—Ä—Ö–Ω–∏—Ö –∑–∞–ø–∏—Å–µ–π"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ `key` –∏ `value`:  \n```text\nkey | value\n----+-------\n1   | sdfs\n2   | dsfg\n3   | sdfs\n‚Ä¶   | ‚Ä¶\n```\n\n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å **–ø–µ—Ä–≤—ã–µ 5 –∑–∞–ø–∏—Å–µ–π** –∏–∑ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –í MySQL –∏ PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `LIMIT 5`.  \nüí° –í —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ SQL –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å `FETCH FIRST 5 ROWS ONLY`.  \nüí° –í SQL Server –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `TOP 5`.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 1 (MySQL, PostgreSQL):\nSELECT *\nFROM your_table\nLIMIT 5;\n\n-- –†–µ—à–µ–Ω–∏–µ 2 (ANSI SQL):\nSELECT *\nFROM your_table\nFETCH FIRST 5 ROWS ONLY;\n\n-- –†–µ—à–µ–Ω–∏–µ 3 (SQL Server):\nSELECT TOP 5 *\nFROM your_table;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-select-top-5"

[[tasks]]
  id = 32
  question = "–ú–∞—à–∏–Ω—ã —Ä–æ–∑–æ–≤–æ–≥–æ —Ü–≤–µ—Ç–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ —Ü–≤–µ—Ç–∞–º"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã:  \n\n```sql\nCREATE TABLE colors (\n    id INT NOT NULL PRIMARY KEY,\n    name VARCHAR(50),\n    UNIQUE(name)\n);\n\nCREATE TABLE cars (\n    id INT NOT NULL PRIMARY KEY,\n    name VARCHAR(50),\n    color_id INT,\n    FOREIGN KEY (color_id) REFERENCES colors(id)\n);\n```\n\n1. –í—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–∞—à–∏–Ω —Ä–æ–∑–æ–≤–æ–≥–æ —Ü–≤–µ—Ç–∞.  \n2. –ü–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ü–≤–µ—Ç–∞ –∏ –≤—ã–≤–µ—Å—Ç–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ: –Ω–∞–∑–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –î–ª—è –ø–µ—Ä–≤–æ–π –∑–∞–¥–∞—á–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `JOIN` –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ `colors.name = 'pink'`.  \nüí° –î–ª—è –≤—Ç–æ—Ä–æ–π ‚Äî –∞–≥—Ä–µ–≥–∏—Ä—É–π—Ç–µ –ø–æ `colors.name` —Å –ø–æ–º–æ—â—å—é `GROUP BY` –∏ `COUNT(*)`.  \nüí° –ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å `LEFT JOIN`, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å —Ü–≤–µ—Ç–∞ –±–µ–∑ –º–∞—à–∏–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\n-- 1. –°–ø–∏—Å–æ–∫ –º–∞—à–∏–Ω —Ä–æ–∑–æ–≤–æ–≥–æ —Ü–≤–µ—Ç–∞\nSELECT c.name AS car_name\nFROM cars c\nJOIN colors col ON c.color_id = col.id\nWHERE col.name = 'pink';\n\n-- 2. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω –ø–æ –∫–∞–∂–¥–æ–º—É —Ü–≤–µ—Ç—É\nSELECT col.name    AS color,\n       COUNT(c.id) AS car_count\nFROM colors col\nLEFT JOIN cars c ON c.color_id = col.id\nGROUP BY col.name\nORDER BY col.name;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-pink-cars-and-color-count"

[[tasks]]
  id = 33
  question = "–û—Ç–¥–µ–ª—ã —Å —á–∏—Å–ª–æ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å –æ–∫–ª–∞–¥–æ–º –≤—ã—à–µ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã \n\n```sql \n-- –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö\n-- –û—Ç–¥–µ–ª:\nCREATE TABLE department (\n    id          INTEGER     NOT NULL, -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ—Ç–¥–µ–ª–∞\n    name        VARCHAR(128) NOT NULL, -- –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª–∞\n    PRIMARY KEY (id)\n);\n\n-- –°–æ—Ç—Ä—É–¥–Ω–∏–∫:\nCREATE TABLE employee (\n    id          INTEGER     NOT NULL, -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞\n    department_id INTEGER   NOT NULL, -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ—Ç–¥–µ–ª–∞\n    manager_id  INTEGER,              -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞\n    name        VARCHAR(128) NOT NULL, -- –∏–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞\n    salary      DECIMAL     NOT NULL, -- –æ–∫–ª–∞–¥ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞\n    PRIMARY KEY (id),\n    FOREIGN KEY (department_id) REFERENCES department(id),\n    FOREIGN KEY (manager_id) REFERENCES employee(id)\n);\n\n\n```\n\n1. –í—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –æ—Ç–¥–µ–ª–æ–≤ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.  \n2. –í—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —á–µ–π –æ–∫–ª–∞–¥ –±–æ–ª—å—à–µ, —á–µ–º —É –∏—Ö –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}\nüí° –î–ª—è –ø–µ—Ä–≤–æ–π –∑–∞–¥–∞—á–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `LEFT JOIN` –∏–ª–∏ `JOIN` –º–µ–∂–¥—É `department` –∏ `employee`, –∞–≥—Ä–µ–≥–∏—Ä—É–π—Ç–µ –ø–æ `department.name`, `COUNT(employee.id)` –∏ —Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–æ –∏–º–µ–Ω–∏ –æ—Ç–¥–µ–ª–∞.  \nüí° –î–ª—è –≤—Ç–æ—Ä–æ–π –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ `employee` –∫–∞–∫ `e` –∏ `manager`, —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—è `e.manager_id = manager.id`, –∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ —É—Å–ª–æ–≤–∏—é `e.salary > manager.salary`.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\n-- 1. –°–ø–∏—Å–æ–∫ –æ—Ç–¥–µ–ª–æ–≤ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤\nSELECT\n  d.name         AS department_name,\n  COUNT(e.id)    AS employee_count\nFROM department d\nLEFT JOIN employee e\n  ON e.department_id = d.id\nGROUP BY d.name\nORDER BY d.name;\n\n-- 2. –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å –æ–∫–ª–∞–¥–æ–º –≤—ã—à–µ, —á–µ–º —É –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è\nSELECT\n  e.name         AS employee_name,\n  e.salary       AS employee_salary,\n  m.name         AS manager_name,\n  m.salary       AS manager_salary\nFROM employee e\nJOIN employee m\n  ON e.manager_id = m.id\nWHERE e.salary > m.salary;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-departments-and-high-salary-employees"

[[tasks]]
  id = 34
  question = "–°—Ç—Ä–æ–∫–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ª—é–±–æ–º—É —à–∞–±–ª–æ–Ω—É"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã:  \n- `t1(str)` ‚Äì —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–æ–∫–∏  \n- `t2(mask)` ‚Äì —Å–æ–¥–µ—Ä–∂–∏—Ç —à–∞–±–ª–æ–Ω—ã –¥–ª—è `LIKE`  \n\n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ `t1`, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–º—É —à–∞–±–ª–æ–Ω—É –∏–∑ `t2` —Å –ø–æ–º–æ—â—å—é `SQL LIKE`.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `JOIN` –ø–æ —É—Å–ª–æ–≤–∏—é `t1.str LIKE t2.mask`, —á—Ç–æ–±—ã –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–µ —Å—Ç—Ä–æ–∫–∏.  \nüí° –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã —Å –ø–æ–º–æ—â—å—é `DISTINCT`, –µ—Å–ª–∏ –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–±–ª–æ–Ω–æ–≤.  \nüí° –í–∞—Ä–∏–∞–Ω—Ç —Å `EXISTS` –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —á–∏—Ç–∞–±–µ–ª–µ–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ \"—Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ\" —à–∞–±–ª–æ–Ω–∞.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 1: JOIN + DISTINCT\nSELECT DISTINCT t1.str\nFROM t1\nJOIN t2\n  ON t1.str LIKE t2.mask;\n\n-- –†–µ—à–µ–Ω–∏–µ 2: EXISTS\nSELECT t1.str\nFROM t1\nWHERE EXISTS (\n    SELECT 1\n    FROM t2\n    WHERE t1.str LIKE t2.mask\n);\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-match-strings-with-masks"

[[tasks]]
  id = 35
  question = ""
  answer = ""
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/"

[[tasks]]
  id = 36
  question = "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –±–æ–ª–µ–µ —á–µ–º –æ–¥–Ω–æ–π –ø–æ–∫—É–ø–∫–æ–π –≤ –¥–µ–Ω—å"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ `T1(date, user_id)` —Å –¥–∞—Ç–∞–º–∏ –ø–æ–∫—É–ø–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.  \n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –≤—Å–µ —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–≤–µ—Ä—à–∏–ª **–±–æ–ª–µ–µ –æ–¥–Ω–æ–π** –ø–æ–∫—É–ø–∫–∏ **–≤ —Ç–æ—Ç –∂–µ –¥–µ–Ω—å**, –∏ –≤—ã–≤–µ—Å—Ç–∏ –ø–∞—Ä—ã `(date, user_id)`.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GROUP BY date, user_id` –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ø–æ–∫—É–ø–æ–∫ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –¥–∞—Ç–µ.  \nüí° –ü—Ä–∏–º–µ–Ω–∏—Ç–µ `HAVING COUNT(*) > 1` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ —Ç–µ—Ö –≥—Ä—É–ø–ø, –≥–¥–µ –ø–æ–∫—É–ø–æ–∫ –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π.  \nüí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ ‚Äî –æ–∫–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `COUNT(*) OVER (PARTITION BY date, user_id)` –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —ç—Ç–æ–º—É –ø–æ–ª—é.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 1: GROUP BY + HAVING\nSELECT \n    date,\n    user_id\nFROM T1\nGROUP BY \n    date, \n    user_id\nHAVING COUNT(*) > 1;\n\n-- –†–µ—à–µ–Ω–∏–µ 2: –û–∫–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è\nSELECT DISTINCT\n    date,\n    user_id\nFROM (\n    SELECT\n        date,\n        user_id,\n        COUNT(*) OVER (PARTITION BY date, user_id) AS cnt\n    FROM T1\n) sub\nWHERE cnt > 1;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-multiple-purchases-per-day"

[[tasks]]
  id = 37
  question = ""
  answer = ""
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/"

[[tasks]]
  id = 38
  question = "–í–∑–∞–∏–º–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ (mutual follows)"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–¥–ø–∏—Å–æ–∫ –≤ —Å–æ—Ü—Å–µ—Ç–∏:\n```\n\nuser_id | follower_id  \n--------+------------  \n1 | 5  \n1 | 4  \n2 | 3  \n3 | 2  \n5 | 1\n\n```\n\n–ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –ø–∞—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ **—Ñ–æ–ª–æ–≤—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞** (–Ω–µ —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–æ), –∏ –≤—ã–≤–µ—Å—Ç–∏ `(user_id, follower_id)`.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **—Å–∞–º–æ-–¥–∂–æ–π–Ω** —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ —É—Å–ª–æ–≤–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏: `t1.user_id = t2.follower_id AND t1.follower_id = t2.user_id`.  \nüí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –¥–≤–æ–π–Ω–æ–π `EXISTS`: –ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –¥–ª—è –¥–∞–Ω–Ω–æ–π –ø–∞—Ä—ã —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –æ–±—Ä–∞—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å.  \nüí° –ù–µ –∑–∞–±—É–¥—å—Ç–µ –∏—Å–∫–ª—é—á–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã, —á—Ç–æ–±—ã –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—å –æ–¥–Ω—É –∏ —Ç—É –∂–µ –ø–∞—Ä—É –¥–≤–∞–∂–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `(5,1)` –∏ `(1,5)` –æ–±–∞ –Ω–µ –Ω—É–∂–Ω—ã).  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 1: SELF JOIN\nSELECT DISTINCT t1.user_id,\n       t1.follower_id\nFROM follows t1\nJOIN follows t2\n  ON t1.user_id = t2.follower_id\n AND t1.follower_id = t2.user_id\nWHERE t1.user_id < t1.follower_id;\n\n-- –†–µ—à–µ–Ω–∏–µ 2: EXISTS\nSELECT f1.user_id,\n       f1.follower_id\nFROM follows f1\nWHERE EXISTS (\n    SELECT 1\n    FROM follows f2\n    WHERE f2.user_id = f1.follower_id\n      AND f2.follower_id = f1.user_id\n)\nAND f1.user_id < f1.follower_id;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-mutual-followers"

[[tasks]]
  id = 39
  question = "–ü–∞–ø–∫–∏ —Å AVI-—Ñ–∞–π–ª–∞–º–∏ –∏ –ø—É—Å—Ç—ã–µ –ø–∞–ø–∫–∏"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ù–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–±—Ä–∞–ª –±—ã **–Ω–∞–∑–≤–∞–Ω–∏—è –ø–∞–ø–æ–∫**, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ñ–∞–π–ª —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.avi`, **–∏–ª–∏** –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è **–ø—É—Å—Ç—ã–º–∏** (–Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞).\n\n**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü:**\n\n```sql\nCREATE TABLE folder (\n  id uuid PRIMARY KEY,\n  name text NOT NULL\n);\n\nCREATE TABLE file (\n  id uuid PRIMARY KEY,\n  name text NOT NULL,\n  folder_id uuid NOT NULL,\n  CONSTRAINT fk__file__folder_id FOREIGN KEY (folder_id) REFERENCES folder (id)\n);\n\n```\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–µ–º `LEFT JOIN` ‚Äî —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏ —Ç–µ –ø–∞–ø–∫–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö **–Ω–µ—Ç —Ñ–∞–π–ª–æ–≤ –≤–æ–æ–±—â–µ**.  \nüí° –î–ª—è —Ñ–∞–π–ª–æ–≤ —Å `.avi` –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∏–ª—å—Ç—Ä `file.name LIKE '%.avi'`.  \nüí° –î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—É—Å—Ç—ã—Ö –ø–∞–ø–æ–∫ –ø—Ä–æ–≤–µ—Ä—è–µ–º `file.id IS NULL`.  \nüí° –ù–µ –∑–∞–±—É–¥—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `DISTINCT`, –µ—Å–ª–∏ JOIN –º–æ–∂–µ—Ç –¥–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\nSELECT DISTINCT f.name\nFROM folder f\nLEFT JOIN file fi ON f.id = fi.folder_id\nWHERE fi.name LIKE '%.avi'\n   OR fi.id IS NULL;\n```\n\n‚úÖ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:**\n\n- `LEFT JOIN` —Å–æ–µ–¥–∏–Ω—è–µ—Ç –ø–∞–ø–∫–∏ —Å —Ñ–∞–π–ª–∞–º–∏ (–µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å), –æ—Å—Ç–∞–≤–ª—è—è —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –ø—É—Å—Ç—ã—Ö –ø–∞–ø–æ–∫.\n    \n- `fi.name LIKE '%.avi'` ‚Äî –≤—ã–±–∏—Ä–∞–µ–º –ø–∞–ø–∫–∏ —Å AVI-—Ñ–∞–π–ª–∞–º–∏.\n    \n- `fi.id IS NULL` ‚Äî –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤ –ø–∞–ø–∫–µ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.\n    \n- `DISTINCT` —É–±–∏—Ä–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã, –µ—Å–ª–∏ –≤ –ø–∞–ø–∫–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ AVI-—Ñ–∞–π–ª–æ–≤.\n    \n\nüî• –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å ‚Äî –∏ —É –Ω–∞—Å –∏ –≤–∏–¥–µ–æ, –∏ –ø—É—Å—Ç–æ—Ç–∞ üòé  \n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-folders-with-avi-or-empty"

[[tasks]]
  id = 40
  question = "–û—Ç–¥–µ–ª—ã —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã:\n- **dep** (`id`, `name`) ‚Äî –æ—Ç–¥–µ–ª—ã\n- **emp** (`id`, `id_dep`, `fio`) ‚Äî —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏, –≥–¥–µ `id_dep` —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ `dep.id`\n\n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ **–≤—Å–µ—Ö –æ—Ç–¥–µ–ª–æ–≤** —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º. –ï—Å–ª–∏ –≤ –æ—Ç–¥–µ–ª–µ –Ω–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –≤—ã–≤–µ—Å—Ç–∏ `0`.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `LEFT JOIN`, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å –æ—Ç–¥–µ–ª—ã –±–µ–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.  \nüí° –ê–≥—Ä–µ–≥–∏—Ä—É–π—Ç–µ –ø–æ `d.name` –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ `COUNT(e.id)`, –æ–Ω –≤–µ—Ä–Ω—ë—Ç `0` –¥–ª—è –ø—É—Å—Ç—ã—Ö –≥—Ä—É–ø–ø.  \nüí° –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –∏–º–µ–Ω–∏ –æ—Ç–¥–µ–ª–∞ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\nSELECT\n  d.name           AS department,\n  COUNT(e.id)      AS employee_count\nFROM dep d\nLEFT JOIN emp e\n  ON e.id_dep = d.id\nGROUP BY d.name\nORDER BY d.name;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-department-employee-count"

[[tasks]]
  id = 41
  question = "–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –∏–∑-–∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –≤ email"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ `client_service` —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:\n- `client_id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞\n- `employee_email` ‚Äî –ø–æ—á—Ç–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –æ–±—Å–ª—É–∂–∏–≤–∞—é—â–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞\n\n–ò–∑-–∑–∞ —Ä–∞–∑–Ω–æ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –≤ `employee_email` (‚ÄúUser@domain.com‚Äù –∏ ‚Äúuser@domain.com‚Äù) –ø–æ—è–≤–ª—è—é—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç—ã –∑–∞–ø–∏—Å–µ–π. –ù—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å SQL-—Ä–µ—à–µ–Ω–∏–µ, —á—Ç–æ–±—ã —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –∑–∞–¥–≤–æ–µ–Ω–∏–µ.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ü—Ä–∏–≤–µ–¥–∏—Ç–µ `employee_email` –∫ –æ–¥–Ω–æ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫ –Ω–∏–∂–Ω–µ–º—É) –ø—Ä–∏ –≤—ã–±–æ—Ä–∫–µ –∏–ª–∏ –≤ —Å–∞–º–æ–π —Ç–∞–±–ª–∏—Ü–µ.  \nüí° –î–ª—è –≤—ã–±–æ—Ä–∫–∏ –±–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `SELECT DISTINCT ‚Ä¶ LOWER(employee_email)`.  \nüí° –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å **—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å** –ø–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—é `LOWER(employee_email)`, —á—Ç–æ–±—ã –≤ –±—É–¥—É—â–µ–º –∏–∑–±–µ–∂–∞—Ç—å –≤—Å—Ç–∞–≤–∫–∏ –¥—É–±–ª–µ–π —Å —Ä–∞–∑–Ω—ã–º —Ä–µ–≥–∏—Å—Ç—Ä–æ–º.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\n-- 1. –í—ã–±–æ—Ä–∫–∞ –±–µ–∑ –∑–∞–¥–≤–æ–µ–Ω–∏—è –ø–æ —Ä–∞–∑–Ω–æ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É:\nSELECT DISTINCT\n  client_id,\n  LOWER(employee_email) AS employee_email_normalized\nFROM client_service;\n\n-- 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ:\nUPDATE client_service\nSET employee_email = LOWER(employee_email);\n\n-- 3. –°–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –ø–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º—É email:\n--    –í PostgreSQL –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º:\nCREATE UNIQUE INDEX ux_client_service_email_ci\n  ON client_service (client_id, LOWER(employee_email));\n````\n\n‚úÖ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:**\n\n- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞** —á–µ—Ä–µ–∑ `LOWER(employee_email)` —É—Å—Ç—Ä–∞–Ω—è–µ—Ç —Ä–∞–∑–ª–∏—á–∏—è –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ.\n\n- **SELECT DISTINCT** –ø–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–µ—Ä–Ω—ë—Ç –ø–æ –æ–¥–Ω–æ–º—É —Å–æ—á–µ—Ç–∞–Ω–∏—é –∫–ª–∏–µ–Ω—Ç‚Äì–ø–æ—á—Ç–∞.\n\n- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ** —Ç–∞–±–ª–∏—Ü—ã –∏ **—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å** –Ω–µ –ø–æ–∑–≤–æ–ª—è—Ç –≤–Ω–æ–≤—å –≤—Å—Ç–∞–≤–∏—Ç—å –¥—É–±–ª–∏ —Å —Ä–∞–∑–Ω—ã–º —Ä–µ–≥–∏—Å—Ç—Ä–æ–º.  \n  {{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-deduplicate-client-email"

[[tasks]]
  id = 42
  question = "–≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç LEFT OUTER JOIN –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è OUTER JOIN"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã `t1(A)` –∏ `t2(B)`.  \n–ò—Å—Ö–æ–¥–Ω—ã–π –∑–∞–ø—Ä–æ—Å:\n```sql\nSELECT *\nFROM t1\nLEFT OUTER JOIN t2\n  ON t1.A = t2.B;\n````\n\n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –µ–≥–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ **–±–µ–∑** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `LEFT OUTER JOIN`.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –†–∞–∑–±–µ–π—Ç–µ –Ω–∞ –¥–≤–∞ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞:\n\n1. **INNER JOIN** –¥–ª—è —Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö —Å—Ç—Ä–æ–∫.\n\n2. –°—Ç—Ä–æ–∫–∏ –∏–∑ `t1`, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –≤ `t2`.  \n   üí° –û–±—ä–µ–¥–∏–Ω–∏—Ç–µ –∏—Ö —Å –ø–æ–º–æ—â—å—é `UNION ALL`.  \n   üí° –î–ª—è –≤—Ç–æ—Ä–æ–≥–æ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `NOT EXISTS` –∏–ª–∏ `NOT IN`.  \n   {{< /details >}}\n\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- –í–∞—Ä–∏–∞–Ω—Ç 1: INNER JOIN + UNION ALL + NOT EXISTS\nSELECT t1.A, t2.B\nFROM t1\nJOIN t2\n  ON t1.A = t2.B\n\nUNION ALL\n\nSELECT t1.A, NULL AS B\nFROM t1\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM t2\n    WHERE t2.B = t1.A\n);\n```\n\n```sql\n-- –í–∞—Ä–∏–∞–Ω—Ç 2: INNER JOIN + UNION ALL + NOT IN\nSELECT t1.A, t2.B\nFROM t1\nJOIN t2\n  ON t1.A = t2.B\n\nUNION ALL\n\nSELECT t1.A, NULL AS B\nFROM t1\nWHERE t1.A NOT IN (\n    SELECT t2.B\n    FROM t2\n);\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-leftjoin-equivalent"

[[tasks]]
  id = 43
  question = "–í—Ç–æ—Ä–æ–π –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ –æ–∫–ª–∞–¥"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ `Employee(id, email, salary)`. –ù—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å **–≤—Ç–æ—Ä–æ–π –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ** —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `salary`.\n\n```text\nWe have table Employee with columns: id, email, salary. \nHow would you get the second highest salary?\n```\n\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ü–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –Ω–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π `salary` –º–µ–Ω—å—à–µ, —á–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤ —Ç–∞–±–ª–∏—Ü–µ, —á–µ—Ä–µ–∑ –ø–æ–¥–∑–∞–ø—Ä–æ—Å.  \nüí° –í—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–∫–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `DENSE_RANK()` –ø–æ `salary` –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è –∏ –≤—ã–±—Ä–∞—Ç—å —Ä–∞–Ω–≥ = 2.  \nüí° –ù–µ –∑–∞–±—É–¥—å—Ç–µ —É—á–µ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –æ–∫–ª–∞–¥—ã: –Ω—É–∂–Ω—ã **—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ** –∑–Ω–∞—á–µ–Ω–∏—è.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\n-- –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ–¥–∑–∞–ø—Ä–æ—Å\nSELECT MAX(salary) AS second_highest_salary\nFROM Employee\nWHERE salary < (\n    SELECT MAX(salary) \n    FROM Employee\n);\n\n-- –í–∞—Ä–∏–∞–Ω—Ç 2: –û–∫–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è\nSELECT salary AS second_highest_salary\nFROM (\n    SELECT\n        salary,\n        DENSE_RANK() OVER (ORDER BY salary DESC) AS rnk\n    FROM Employee\n) t\nWHERE rnk = 2;\n````\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-second-highest-salary"

[[tasks]]
  id = 44
  question = "–ü–æ–∏—Å–∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö email"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ `Employee(id, email, salary)`, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ `email` –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è. –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤—Å–µ `email`, –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞.\n\n```text\nEmployee table with columns: id, email, salary. \nWe have duplicated emails. How could we find all duplicated emails?\n\n\nemail\n-----\na\nb\nc\na\n```\n\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GROUP BY email` –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é `HAVING COUNT(*) > 1`.  \nüí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –æ–∫–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `COUNT() OVER (PARTITION BY email)` –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –≤—Ö–æ–∂–¥–µ–Ω–∏–π.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\n-- –í–∞—Ä–∏–∞–Ω—Ç 1: GROUP BY + HAVING\nSELECT email\nFROM Employee\nGROUP BY email\nHAVING COUNT(*) > 1;\n\n-- –í–∞—Ä–∏–∞–Ω—Ç 2: –û–∫–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è + DISTINCT\nSELECT DISTINCT email\nFROM (\n    SELECT\n        email,\n        COUNT(*) OVER (PARTITION BY email) AS cnt\n    FROM Employee\n) sub\nWHERE cnt > 1;\n````\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-duplicated-emails"

[[tasks]]
  id = 45
  question = "–ß–∏—Å–ª–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π –≤ –∫–∞–∂–¥–æ–º –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–µ"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã `department(id, name)` –∏ `employee(id, surname, name, salary, department_id)`.  \n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–≤–µ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ –∏ –∫–∞–∂–¥–æ–π –∑–∞—Ä–ø–ª–∞—Ç—ã –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∏–º–µ—é—â–∏—Ö —ç—Ç—É –∑–∞—Ä–ø–ª–∞—Ç—É.\n\n```sql\nCREATE TABLE department (\n    id   BIGSERIAL PRIMARY KEY,\n    name VARCHAR(255) NOT NULL\n);\n\nCREATE TABLE employee (\n    id             BIGSERIAL,\n    surname        VARCHAR(255) NOT NULL,\n    name           VARCHAR(255) NOT NULL,\n    salary         BIGINT NOT NULL,\n    department_id  BIGINT NOT NULL REFERENCES department(id)\n);\n````\n\n**–ñ–µ–ª–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**\n\n```\ndep_name     | salary | count\n-------------+--------+------\nDep_name_1   |   1000 |    3\nDep_name_1   |   2000 |    4\nDep_name_2   |   2000 |   30\n```\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –°–æ–µ–¥–∏–Ω–∏—Ç–µ `department` –∏ `employee` –ø–æ `department_id`.  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GROUP BY d.name, e.salary` –∏ `COUNT(*)`.  \nüí° –í –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –æ–∫–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `COUNT(*) OVER (PARTITION BY department_id, salary)`.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- –†–µ—à–µ–Ω–∏–µ 1: GROUP BY\nSELECT\n    d.name   AS dep_name,\n    e.salary,\n    COUNT(*) AS count\nFROM department d\nJOIN employee e\n  ON e.department_id = d.id\nGROUP BY\n    d.name,\n    e.salary\nORDER BY\n    d.name,\n    e.salary;\n\n-- –†–µ—à–µ–Ω–∏–µ 2: –û–∫–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è + DISTINCT\nSELECT DISTINCT\n    d.name     AS dep_name,\n    e.salary,\n    COUNT(*) OVER (PARTITION BY e.department_id, e.salary) AS count\nFROM department d\nJOIN employee e\n  ON e.department_id = d.id\nORDER BY\n    dep_name,\n    salary;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-salary-count-per-department"

[[tasks]]
  id = 46
  question = "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ—Ç–¥–µ–ª–∞–º"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã `Employees(EmployeeID, Name, DepartmentID, Salary)` –∏ `Departments(DepartmentID, DepartmentName)`.  \n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Ç–¥–µ–ª–∞ –≤—ã–≤–µ—Å—Ç–∏:\n- –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª–∞,\n- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –æ—Ç–¥–µ–ª–µ,\n- —Å—Ä–µ–¥–Ω—é—é –∑–∞—Ä–ø–ª–∞—Ç—É (–æ–∫—Ä—É–≥–ª—ë–Ω–Ω—É—é –¥–æ 2 –∑–Ω–∞–∫–æ–≤),\n- –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É,\n- –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É.\n\n–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –æ—Ç–¥–µ–ª–µ –ø–æ —É–±—ã–≤–∞–Ω–∏—é.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `LEFT JOIN`, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å –æ—Ç–¥–µ–ª—ã –±–µ–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ).  \nüí° –ê–≥—Ä–µ–≥–∏—Ä—É–π—Ç–µ –ø–æ `d.DepartmentName` —Å –ø–æ–º–æ—â—å—é `COUNT()`, `AVG()`, `MAX()`, `MIN()`.  \nüí° –î–ª—è –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–π –∑–∞—Ä–ø–ª–∞—Ç—ã –ø—Ä–∏–º–µ–Ω–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `ROUND(..., 2)`.  \nüí° –°–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–æ –Ω—É–∂–Ω–æ–π –∫–æ–ª–æ–Ω–∫–µ —á–µ—Ä–µ–∑ `ORDER BY employee_count DESC`.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n```sql\nSELECT\n    d.DepartmentName    AS department_name,\n    COUNT(e.EmployeeID) AS employee_count,\n    ROUND(AVG(e.Salary), 2) AS average_salary,\n    MAX(e.Salary)       AS max_salary,\n    MIN(e.Salary)       AS min_salary\nFROM Departments d\nLEFT JOIN Employees e\n  ON e.DepartmentID = d.DepartmentID\nGROUP BY\n    d.DepartmentName\nORDER BY\n    employee_count DESC;\n````\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-department-stats"

[[tasks]]
  id = 47
  question = "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ SQL‚Äë–∑–∞–ø—Ä–æ—Å–∞"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã `customers` –∏ `orders`:\n```sql\nCREATE TABLE customers\n(\n    customer_id        NUMERIC(15) PRIMARY KEY,\n    name               VARCHAR(100),\n    email              VARCHAR(100) UNIQUE,\n    registration_date  TIMESTAMP,\n    premium_member     BOOLEAN\n);\n\nCREATE TABLE orders\n(\n    order_id       NUMERIC(15) PRIMARY KEY,\n    customer_id    NUMERIC(15) REFERENCES customers(customer_id),\n    order_date     TIMESTAMP,\n    total_amount   DECIMAL(12, 2),\n    status         VARCHAR(20)\n);\n````\n\n–ú–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å:\n\n```sql\nSELECT c.name,\n       c.email,\n       o.order_id,\n       o.order_date,\n       o.total_amount\nFROM customers c\nJOIN orders o ON c.customer_id = o.customer_id\nWHERE o.status = 'Processing'\n  AND c.premium_member = TRUE\nORDER BY o.order_date DESC;\n```\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ **–±–∏–∑–Ω–µ—Å‚Äë–ª–æ–≥–∏–∫—É**: –≤—ã–±–∏—Ä–∞–µ–º –≤—Å–µ –∑–∞–∫–∞–∑—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º ‚ÄúProcessing‚Äù —Ç–æ–ª—å–∫–æ —É –ø—Ä–µ–º–∏—É–º‚Äë–∫–ª–∏–µ–Ω—Ç–æ–≤, —Å–æ—Ä—Ç–∏—Ä—É—è –ø–æ –¥–∞—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–∫–∞–∑–∞.  \nüí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (`EXPLAIN ANALYZE`) ‚Äì –∏—â—É—Ç—Å—è –ª–∏ –ø–æ–ª–Ω—ã–µ —Å–∫–∞–Ω—ã –ø–æ —Ç–∞–±–ª–∏—Ü–∞–º?  \nüí° –î–æ–±–∞–≤—å—Ç–µ **–∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã** –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º, —É—á–∞—Å—Ç–≤—É—é—â–∏–º –≤ `WHERE` –∏ `JOIN`, –∏ –≤–∫–ª—é—á–∏—Ç–µ –≤ –Ω–∏—Ö –ø–æ–ª–µ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:\n\n```sql\nCREATE INDEX idx_orders_status_date ON orders(status, order_date DESC, customer_id);\nCREATE INDEX idx_customers_premium ON customers(premium_member, customer_id);\n```\n\nüí° –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ **–ø–æ–∫—Ä—ã–≤–∞—é—â–∏–µ –∏–Ω–¥–µ–∫—Å—ã** –∏–ª–∏ **materialized view** –¥–ª—è —á–∞—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∑–∞–ø—Ä–æ—Å–æ–≤.  \nüí° –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–∞–±–ª–∏—Ü –∞–∫—Ç—É–∞–ª—å–Ω–∞ (`ANALYZE`).  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n1. **–ü–æ–Ω—è—Ç—å –±–∏–∑–Ω–µ—Å‚Äë—Å–º—ã—Å–ª –∑–∞–ø—Ä–æ—Å–∞**\n\n    - –ú—ã —Ö–æ—Ç–∏–º –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ **—Ç–µ–∫—É—â–∏–µ (Processing)** –∑–∞–∫–∞–∑—ã —Ç–æ–ª—å–∫–æ —É **–ø—Ä–µ–º–∏—É–º‚Äë–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç —Å–∞–º—ã—Ö —Å–≤–µ–∂–∏—Ö.\n\n2. **–ò–∑—É—á–∏—Ç—å –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**\n\n    ```sql\n    EXPLAIN ANALYZE\n    SELECT ‚Ä¶;\n    ```\n\n    - –ï—Å–ª–∏ –≤–∏–¥–∏–º `Seq Scan` –ø–æ —Ç–∞–±–ª–∏—Ü–µ `orders` –∏–ª–∏ `customers` ‚Üí –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–Ω–¥–µ–∫—Å–æ–≤.\n\n3. **–°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã**\n\n    - –ù–∞ —Ç–∞–±–ª–∏—Ü—É `orders`:\n\n        ```sql\n        CREATE INDEX idx_orders_status_date\n          ON orders(status, order_date DESC, customer_id);\n        ```\n\n      –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Å—Ç–∞—Ç—É—Å—É –∏ —Å—Ä–∞–∑—É –≤—ã–¥–∞–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –Ω—É–∂–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –∞ –∑–∞—Ç–µ–º –¥–∞–≤–∞—Ç—å `customer_id` –¥–ª—è `JOIN`.\n\n    - –ù–∞ —Ç–∞–±–ª–∏—Ü—É `customers`:\n\n        ```sql\n        CREATE INDEX idx_customers_premium\n          ON customers(premium_member, customer_id);\n        ```\n\n      –ß—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–µ–º–∏—É–º‚Äë–∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç—å `JOIN` –ø–æ `customer_id`.\n\n4. **–ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–ª–∞–Ω**\n\n    - –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `EXPLAIN ANALYZE` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `Index Scan` –≤–º–µ—Å—Ç–æ `Seq Scan`.\n\n5. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**\n\n    - –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å **–º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ**:\n\n        ```sql\n        CREATE MATERIALIZED VIEW mv_processing_premium AS\n        SELECT c.name, c.email, o.order_id, o.order_date, o.total_amount\n        FROM customers c\n        JOIN orders o ON c.customer_id = o.customer_id\n        WHERE o.status = 'Processing'\n          AND c.premium_member = TRUE;\n        CREATE INDEX ON mv_processing_premium(order_date DESC);\n        ```\n\n    - **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å** –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ (`REFRESH MATERIALIZED VIEW`).\n\n6. **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**\n\n    - –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–¥–æ–±—Ä–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –∏ –∞–Ω–∞–ª–∏–∑ –ø–ª–∞–Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É—Å—Ç—Ä–∞–Ω—è—é—Ç –ø–æ–ª–Ω—ã–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è—é—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.  \n      {{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-refactor-slow-query"

[[tasks]]
  id = 48
  question = "–°–æ—Ç—Ä—É–¥–Ω–∏–∫ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π –≤ –∫–∞–∂–¥–æ–º –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–µ"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã `departments(id, name)` –∏ `employees(id, name, department_id, salary)`.  \n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ –≤—ã–≤–µ—Å—Ç–∏:\n- –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ (`department`),\n- –∏–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (`employee`),\n- –µ–≥–æ –∑–∞—Ä–ø–ª–∞—Ç—É (`salary`),\n  –≥–¥–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –∏–º–µ–µ—Ç **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é** –∑–∞—Ä–ø–ª–∞—Ç—É –≤ —Å–≤–æ—ë–º –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–µ.\n\n```sql\nCREATE TABLE departments (\n    id   INT PRIMARY KEY,\n    name VARCHAR(100)\n);\n\nCREATE TABLE employees (\n    id             INT PRIMARY KEY,\n    name           VARCHAR(100),\n    department_id  INT REFERENCES departments(id),\n    salary         NUMERIC(10,2)\n);\n````\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–∫–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `ROW_NUMBER()` –∏–ª–∏ `RANK()` –¥–ª—è –Ω—É–º–µ—Ä–∞—Ü–∏–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–µ –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∑–∞—Ä–ø–ª–∞—Ç—ã.  \nüí° –í –ø–æ–¥–∑–∞–ø—Ä–æ—Å–µ –∏–ª–∏ CTE –≤—ã—á–∏—Å–ª–∏—Ç–µ –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –≤ —Ä–∞–∑—Ä–µ–∑–µ `department_id`, —Å–æ—Ä—Ç–∏—Ä—É—è –ø–æ `salary DESC`.  \nüí° –ó–∞—Ç–µ–º –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–µ –∑–∞–ø–∏—Å–∏, –≥–¥–µ –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ = 1.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nWITH ranked_emps AS (\n    SELECT\n        d.name AS department,\n        e.name AS employee,\n        e.salary,\n        ROW_NUMBER() OVER (\n            PARTITION BY e.department_id \n            ORDER BY e.salary DESC\n        ) AS rn\n    FROM employees e\n    JOIN departments d\n      ON e.department_id = d.id\n)\nSELECT\n    department,\n    employee,\n    salary\nFROM ranked_emps\nWHERE rn = 1\nORDER BY department;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-top-employee-per-department"

[[tasks]]
  id = 49
  question = "–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü ¬´–ü—Ä–æ–¥—É–∫—Ç—ã¬ª –∏ ¬´–ù–∞–ª–∏—á–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º¬ª"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü –¥–ª—è —Å–µ—Ç–∏ –º–∞–≥–∞–∑–∏–Ω–æ–≤, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å:\n1. –ö–∞–∫–∏–µ —Ç–æ–≤–∞—Ä—ã –µ—Å—Ç—å –≤ —Ç–æ–º –∏–ª–∏ –∏–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ.\n2. –í –∫–∞–∫–∏—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö –µ—Å—Ç—å —Ç–æ—Ç –∏–ª–∏ –∏–Ω–æ–π —Ç–æ–≤–∞—Ä.\n3. –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –ø–æ –≤—Å–µ–º –º–∞–≥–∞–∑–∏–Ω–∞–º.\n4. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ç–æ–≤–∞—Ä–∞—Ö –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ.\n\n**–ö–æ–¥:**\n\n```sql\n-- –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤\nCREATE TABLE store (\n    id   BIGSERIAL PRIMARY KEY,\n    name TEXT       NOT NULL\n);\n\n-- –¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤\nCREATE TABLE product (\n    id          BIGSERIAL PRIMARY KEY,\n    name        TEXT       NOT NULL,\n    sku         TEXT       UNIQUE NOT NULL,  -- –∞—Ä—Ç–∏–∫—É–ª\n    description TEXT\n);\n\n-- –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–≤–∞—Ä–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ\nCREATE TABLE store_inventory (\n    store_id   BIGINT NOT NULL\n        REFERENCES store(id),\n    product_id BIGINT NOT NULL\n        REFERENCES product(id),\n    quantity   INT    NOT NULL CHECK (quantity >= 0),\n    PRIMARY KEY (store_id, product_id)\n);\n````\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –î–ª—è —Å–≤—è–∑–∏ ¬´–º–Ω–æ–≥–∏–µ‚Äë–∫–æ‚Äë–º–Ω–æ–≥–∏–º¬ª –º–µ–∂–¥—É –º–∞–≥–∞–∑–∏–Ω–∞–º–∏ –∏ —Ç–æ–≤–∞—Ä–∞–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ **junction‚Äë—Ç–∞–±–ª–∏—Ü–∞** `store_inventory`.  \nüí° –ü–æ–ª–µ `quantity` —Ö—Ä–∞–Ω–∏—Ç —Ç–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞ –≤ –∫–∞–∂–¥–æ–º –º–∞–≥–∞–∑–∏–Ω–µ (–º–æ–∂–µ—Ç –±—ã—Ç—å 0).  \nüí° –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á `(store_id, product_id)` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π.  \nüí° –¢–∞–±–ª–∏—Ü–∞ `product` —Å–æ–¥–µ—Ä–∂–∏—Ç `sku` (–∞—Ä—Ç–∏–∫—É–ª) –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π –∏ –ø–æ–∏—Å–∫.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- –ü—Ä–∏–º–µ—Ä –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è:\nINSERT INTO store (name) VALUES ('–ù–∞ –æ–ø—É—à–∫–µ'), ('–†–µ—á–Ω–æ–π');\n\nINSERT INTO product (name, sku, description)\nVALUES\n  ('–•–ª–µ–±', 'BREAD-001', '–ë–∞—Ç–æ–Ω –±–µ–ª—ã–π'),\n  ('–ú–æ–ª–æ–∫–æ', 'MILK-001', '2.5% –∂–∏—Ä–Ω–æ—Å—Ç–∏'),\n  ('–Ø–±–ª–æ–∫–∏', 'APPLE-001', '–ó–µ–ª–µ–Ω—ã–µ');\n\n-- –£–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –º–∞–≥–∞–∑–∏–Ω–∞—Ö:\nINSERT INTO store_inventory (store_id, product_id, quantity)\nVALUES\n  (1, 1, 50),  -- –≤ –º–∞–≥–∞–∑–∏–Ω–µ 1 ‚Äî 50 —à—Ç—É–∫ –•–ª–µ–±–∞\n  (1, 2, 30),  -- –≤ –º–∞–≥–∞–∑–∏–Ω–µ 1 ‚Äî 30 —à—Ç—É–∫ –ú–æ–ª–æ–∫–∞\n  (2, 2,  0),  -- –≤ –º–∞–≥–∞–∑–∏–Ω–µ 2 ‚Äî –Ω–µ—Ç –ú–æ–ª–æ–∫–∞\n  (2, 3, 20);  -- –≤ –º–∞–≥–∞–∑–∏–Ω–µ 2 ‚Äî 20 —à—Ç—É–∫ –Ø–±–ª–æ–∫\n\n-- 1) –¢–æ–≤–∞—Ä—ã –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ:\nSELECT p.name, si.quantity\nFROM store_inventory si\nJOIN product p ON p.id = si.product_id\nWHERE si.store_id = 1;\n\n-- 2) –ú–∞–≥–∞–∑–∏–Ω—ã, –≥–¥–µ –µ—Å—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–æ–≤–∞—Ä:\nSELECT s.name, si.quantity\nFROM store_inventory si\nJOIN store s ON s.id = si.store_id\nWHERE si.product_id = 2 AND si.quantity > 0;\n\n-- 3) –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–∞ –ø–æ –≤—Å–µ–º –º–∞–≥–∞–∑–∏–Ω–∞–º:\nSELECT p.name,\n       SUM(si.quantity) AS total_quantity\nFROM product p\nLEFT JOIN store_inventory si ON si.product_id = p.id\nGROUP BY p.name;\n\n-- 4) –°–ø–∏—Å–æ–∫ –º–∞–≥–∞–∑–∏–Ω–æ–≤, –≥–¥–µ —Ç–æ–≤–∞—Ä –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:\nSELECT s.name\nFROM store s\nLEFT JOIN store_inventory si\n  ON si.store_id = s.id AND si.product_id = 2\nWHERE COALESCE(si.quantity, 0) = 0;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-design-product-inventory"

[[tasks]]
  id = 50
  question = "–°—É–º–º–∞ –≤—ã—Ä—É—á–∫–∏ –ø–æ –ø—Ä–æ–¥–∞–≤—Ü–∞–º"
  answer = "üî• –ù–∞–ø–∏—à–∏—Ç–µ SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –≤—Å–µ—Ö –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –∏ –æ–±—â—É—é —Å—É–º–º—É, –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—É—é –∫–∞–∂–¥—ã–º. –í –≤—ã–±–æ—Ä–∫–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏ –ø—Ä–æ–¥–∞–≤—Ü—ã –±–µ–∑ –∑–∞–∫–∞–∑–æ–≤ (—Å —Å—É–º–º–æ–π 0). –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ id –ø—Ä–æ–¥–∞–≤—Ü–∞.\n\n```sql\nCREATE TABLE Salespersons\n(\n        id SERIAL PRIMARY KEY,\n        name VARCHAR(20)\n);\n\nCREATE TABLE Customers\n(\n        id SERIAL PRIMARY KEY,\n        salesperson_id INT\n);\n\nCREATE TABLE Orders\n(\n        id SERIAL PRIMARY KEY,\n        customer_id INT,\n        price INT\n);\n\nTRUNCATE Orders;\nINSERT INTO Orders (customer_id, price)\nVALUES (8, 2480),\n        (6, 654),\n        (13, 2938),\n        ... (–±–æ–ª—å—à–µ —Å—Ç—Ä–æ–∫)\n        (2, 1548);\n\nINSERT INTO Salespersons (name)\nVALUES ('Stephanie'),\n        ('Rebecca'),\n        ('Deborah'),\n        ...\n        ('Maria');\n\nINSERT INTO Customers (salesperson_id)\nVALUES (5),\n        (4),\n        (8),\n        ...\n        (3);\n```\n\n---\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ù–∞—á–∏–Ω–∞–π –∑–∞–ø—Ä–æ—Å –æ—Ç —Ç–∞–±–ª–∏—Ü—ã `Salespersons`, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–¥–∞–≤—Ü–æ–≤.  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π `LEFT JOIN` —Å `Customers` –∏ `Orders`, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –±–µ–∑ –ø—Ä–æ–¥–∞–∂.  \nüí° –î–ª—è —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã—Ä—É—á–∫–∏ –ø—Ä–∏–º–µ–Ω—è–π `SUM(o.price)`.  \nüí° –ß—Ç–æ–±—ã —É –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –±–µ–∑ –∑–∞–∫–∞–∑–æ–≤ –Ω–µ –±—ã–ª–æ `NULL`, –∏—Å–ø–æ–ª—å–∑—É–π `COALESCE(..., 0)`.  \nüí° –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ `s.id`, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ ‚Äî `ORDER BY s.id`.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT\n    s.id AS salesperson_id,\n    COALESCE(SUM(o.price), 0) AS total_earned\nFROM Salespersons s\nLEFT JOIN Customers c\n       ON c.salesperson_id = s.id\nLEFT JOIN Orders o\n       ON o.customer_id = c.id\nGROUP BY s.id\nORDER BY s.id;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-salespersons-revenue"

[[tasks]]
  id = 51
  question = "–ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å –ø–æ –∫–∞–∂–¥–æ–º—É col2"
  answer = "üî• –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ table1. –í –Ω–µ–π 4 –∫–æ–ª–æ–Ω–∫–∏. col1 —ç—Ç–æ –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á. col2 —ç—Ç–æ secondary_id (–ª–∏–±–æ foreign key, –º—ã –∑–Ω–∞–µ–º, —á—Ç–æ –æ–Ω —Å–≤—è–∑–∞–Ω —Å –¥—Ä—É–≥–æ–π —Ç–∞–±–ª–∏—Ü–µ–π –∏ –Ω–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –≤ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ). col3 —ç—Ç–æ amount (–¥–µ–Ω–µ–∂–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ). col4 —ç—Ç–æ —Å–∏—Å—Ç–µ–º–Ω–æ–µ –ø–æ–ª–µ date (change date, –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å). –ù–∞–ø–∏—Å–∞—Ç—å SELECT –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–Ω–æ–≥–æ col2 –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫—É, —É –∫–æ—Ç–æ—Ä–æ–π —Å–∞–º–∞—è –ø–æ—Å–ª–µ–¥–Ω—è—è —Å–≤–µ–∂–∞—è date\n\n```text\ntable1\ncol1 pk\ncol2 sec_fk\ncol3 amount\ncol4 date\n```\n\n---\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –£–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–∫–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `ROW_NUMBER()` —Å —Ä–∞–∑–±–∏–µ–Ω–∏–µ–º –ø–æ `col2` –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –ø–æ `col4 DESC`.  \nüí° –í PostgreSQL –µ—Å—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç —Å `DISTINCT ON (col2)` –∏ `ORDER BY col2, col4 DESC`.  \nüí° –î–æ–±–∞–≤—å—Ç–µ –∏–Ω–¥–µ–∫—Å –Ω–∞ `(col2, col4 DESC)` –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}  \n–í–∞—Ä–∏–∞–Ω—Ç 1 (ANSI SQL, —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π, —á–µ—Ä–µ–∑ –æ–∫–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é):\n\n```sql\nSELECT col1, col2, col3, col4\nFROM (\n  SELECT\n    t.*,\n    ROW_NUMBER() OVER (PARTITION BY col2 ORDER BY col4 DESC) AS rn\n  FROM table1 t\n) s\nWHERE s.rn = 1\nORDER BY col2;\n```\n\n–í–∞—Ä–∏–∞–Ω—Ç 2 (PostgreSQL, `DISTINCT ON`):\n\n```sql\nSELECT DISTINCT ON (t.col2)\n  t.col1, t.col2, t.col3, t.col4\nFROM table1 t\nORDER BY t.col2, t.col4 DESC;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-latest-by-foreign-key"

[[tasks]]
  id = 52
  question = "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –æ—Ç–¥–µ–ª–∞–º —Å—Ä–µ–¥–∏ –Ω–µ—É–≤–æ–ª–µ–Ω–Ω—ã—Ö"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã: \"units\" ‚Äì –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –∏ \"employees\" ‚Äì —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∫–æ–º–ø–∞–Ω–∏–∏.\nunits:\nid primary key\nname (–Ω–∞–∑–≤–∞–Ω–∏–µ unit)\nemployees:\nid primary key\nunit_id foreign key -> units::id\nsalary (–∑–∞—Ä–ø–ª–∞—Ç–∞)\nfired (—Ñ–ª–∞–≥ —É–≤–æ–ª–µ–Ω true, false)\n\n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–ø–∏—Å–∞—Ç—å sql –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é\n–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É –ø–æ –∫–∞–∂–¥–æ–º—É –æ—Ç–¥–µ–ª—É —Å—Ä–µ–¥–∏ –Ω–µ—É–≤–æ–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤. (unit_id)\n\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –û—Ç–±–µ—Ä–∏—Ç–µ—Å—å –ø–æ –ø—Ä–∏–∑–Ω–∞–∫—É –Ω–µ—É–≤–æ–ª–µ–Ω–Ω—ã—Ö: `WHERE fired = false` (–∏–ª–∏ `= 0`, –µ—Å–ª–∏ BOOL —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ int).  \nüí° –°–≥—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ—Å—å –ø–æ –æ—Ç–¥–µ–ª—É: `GROUP BY unit_id` (–∏ `u.name`, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π –≤—ã–≤–æ–¥).  \nüí° –ê–≥—Ä–µ–≥–∏—Ä—É–π—Ç–µ –∑–∞—Ä–ø–ª–∞—Ç—ã: `MIN(salary)`, `MAX(salary)`.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- –í–∞—Ä–∏–∞–Ω—Ç 1: –ø–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É –æ—Ç–¥–µ–ª–∞\nSELECT\n    e.unit_id,\n    MIN(e.salary) AS min_salary,\n    MAX(e.salary) AS max_salary\nFROM employees e\nWHERE e.fired = false\nGROUP BY e.unit_id;\n```\n\n```sql\n-- –í–∞—Ä–∏–∞–Ω—Ç 2: —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –æ—Ç–¥–µ–ª–∞\nSELECT\n    u.id   AS unit_id,\n    u.name AS unit_name,\n    MIN(e.salary) AS min_salary,\n    MAX(e.salary) AS max_salary\nFROM units u\nJOIN employees e\n  ON e.unit_id = u.id\n AND e.fired = false\nGROUP BY u.id, u.name;\n```\n\n> –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å **–≤—Å–µ** –æ—Ç–¥–µ–ª—ã –¥–∞–∂–µ –±–µ–∑ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `LEFT JOIN` –∏ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç–µ —É—Å–ª–æ–≤–∏–µ `fired = false` –≤ `ON`, –∞ –Ω–µ –≤ `WHERE`:\n\n```sql\nSELECT\n    u.id   AS unit_id,\n    u.name AS unit_name,\n    MIN(e.salary) AS min_salary,\n    MAX(e.salary) AS max_salary\nFROM units u\nLEFT JOIN employees e\n  ON e.unit_id = u.id\n AND e.fired = false\nGROUP BY u.id, u.name;\n-- –î–ª—è –æ—Ç–¥–µ–ª–æ–≤ –±–µ–∑ –Ω–µ—É–≤–æ–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ min/max –±—É–¥—É—Ç NULL\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-min-max-salary-by-unit_2"

[[tasks]]
  id = 53
  question = "–£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã emails"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –í —Ç–∞–±–ª–∏—Ü–µ `emails(id, email)` –º–æ–≥—É—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è **–¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è email-–∞–¥—Ä–µ—Å–∞**.  \n–ù—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π —É–¥–∞–ª—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ **–æ–¥–Ω—É –∑–∞–ø–∏—Å—å** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ email.\n\n**–ö–æ–¥:**\n\n```sql\nCREATE TABLE emails (\n    id INT,\n    email VARCHAR(30)\n);\n\nINSERT INTO emails(id, email)\nVALUES\n(1, 'aa@yandex.ru'),\n(2, 'bb@yandex.ru'),\n(3, 'aa@yandex.ru');\n```\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ß—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏, —Å–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∞—è –∑–∞–ø–∏—Å—å —Å—á–∏—Ç–∞–µ—Ç—Å—è \"—É–Ω–∏–∫–∞–ª—å–Ω–æ–π\" ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å **–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º id**.  \nüí° –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **CTE** —Å `ROW_NUMBER()` –∏–ª–∏ –ø–æ–¥–∑–∞–ø—Ä–æ—Å —Å `MIN(id)`.  \nüí° –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–¥–∞–ª—è–µ—Ç–µ —Ç–æ–ª—å–∫–æ –¥—É–±–ª–∏, –∞ –Ω–µ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 1. –ß–µ—Ä–µ–∑ CTE –∏ ROW_NUMBER()\nWITH duplicates AS (\n    SELECT \n        id,\n        ROW_NUMBER() OVER (PARTITION BY email ORDER BY id) AS rn\n    FROM emails\n)\nDELETE FROM emails\nWHERE id IN (\n    SELECT id FROM duplicates WHERE rn > 1\n);\n```\n\n```sql\n-- ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 2. –ë–µ–∑ CTE (—á–µ—Ä–µ–∑ –ø–æ–¥–∑–∞–ø—Ä–æ—Å)\nDELETE FROM emails\nWHERE id NOT IN (\n    SELECT MIN(id)\n    FROM emails\n    GROUP BY email\n);\n```\n\n> üß† **–ü–æ—è—Å–Ω–µ–Ω–∏–µ:**\n>\n> - `GROUP BY email` –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∞–¥—Ä–µ—Å–∞.\n>\n> - `MIN(id)` –æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä (—Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º id).\n>\n> - –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ —Å —Ç–µ–º –∂–µ email —É–¥–∞–ª—è—é—Ç—Å—è.\n>\n\n–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Å—Ç–∞–Ω–µ—Ç—Å—è:\n\n|id|email|\n|---|---|\n|1|[aa@yandex.ru](mailto:aa@yandex.ru)|\n|2|[bb@yandex.ru](mailto:bb@yandex.ru)|\n\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-delete-duplicates-emails"

[[tasks]]
  id = 54
  question = "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ —Å –ø–æ–º–æ—â—å—é –∏–Ω–¥–µ–∫—Å–æ–≤"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –µ—Å—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å:\n\n```sql\nSELECT id, name\nFROM users\nWHERE name = 'Artem'\n  AND create_date = '2024-10-28'\n  AND status = 'ACTIVE';\n```\n\n–ù—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –Ω–∞ –∫–∞–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ —Å–ª–µ–¥—É–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å, —á—Ç–æ–±—ã —É—Å–∫–æ—Ä–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞.\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò–Ω–¥–µ–∫—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, –µ—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã –≤ `WHERE` –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.  \nüí° –ù–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ ‚Äî **–∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å** (multi-column index), —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø–æ—Ä—è–¥–∫—É —Ñ–∏–ª—å—Ç—Ä–æ–≤.  \nüí° –ü–æ—Ä—è–¥–æ–∫ –∫–æ–ª–æ–Ω–æ–∫ –≤ –∏–Ω–¥–µ–∫—Å–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ: –æ—Ç –±–æ–ª–µ–µ \"—Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ–π\" (—Ä–µ–¥–∫–æ –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–π—Å—è) –∫ –º–µ–Ω–µ–µ.  \nüí° –ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ `EXPLAIN`.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\n-- ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: —Å–æ–∑–¥–∞—Ç—å —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å\nCREATE INDEX idx_users_name_create_date_status\n    ON users (name, create_date, status);\n```\n\n**–ü–æ—á–µ–º—É —Ç–∞–∫:**\n\n- –ó–∞–ø—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Å—Ä–∞–∑—É –ø–æ —Ç—Ä—ë–º –ø–æ–ª—è–º.\n\n- –ï—Å–ª–∏ `name` –Ω–∞–∏–±–æ–ª–µ–µ —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ–µ (—Ä–µ–¥–∫–æ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è) ‚Äî —Å—Ç–∞–≤–∏–º –µ–≥–æ –ø–µ—Ä–≤—ã–º.\n\n- –ï—Å–ª–∏ –∂–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, `status` –≤—Å–µ–≥–¥–∞ `'ACTIVE'`, –∞ `create_date` —Ä–∞–≤–Ω–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–º—É –¥–Ω—é, —Ç–æ –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫:\n\n\n```sql\n-- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –ø—Ä–∏ –∏–Ω–æ–π —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:\nCREATE INDEX idx_users_status_create_date_name\n    ON users (status, create_date, name);\n```\n\n**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**\n\n- –ú–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∏–Ω–¥–µ–∫—Å —Ç–æ–ª—å–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏:\n\n    ```sql\n    CREATE INDEX idx_users_name_create_date\n        ON users (name, create_date);\n    ```\n\n- –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å —á–∞—Å—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –ø–æ `name`, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å:\n\n    ```sql\n    CREATE INDEX idx_users_name ON users(name);\n    ```\n\n\n**–ò—Ç–æ–≥:**  \nüöÄ –î–æ–±–∞–≤–ª—è–µ–º **–∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å –ø–æ —Ñ–∏–ª—å—Ç—Ä—É–µ–º—ã–º –∫–æ–ª–æ–Ω–∫–∞–º**, –ø–æ—Ä—è–¥–æ–∫ –≤—ã–±–∏—Ä–∞–µ–º –ø–æ —á–∞—Å—Ç–æ—Ç–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π.  \n–ò—Å–ø–æ–ª—å–∑—É–µ–º `EXPLAIN ANALYZE` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä —Ä–µ–∞–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏–Ω–¥–µ–∫—Å.  \n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-add-index-for-slow-query"

[[tasks]]
  id = 55
  question = "–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏, –ø–æ–ª—É—á–∞—é—â–∏–µ –∑–∞—Ä–ø–ª–∞—Ç—É –≤—ã—à–µ —Å–≤–æ–µ–≥–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –í —Ç–∞–±–ª–∏—Ü–µ `EMPLOYEE(ID, NAME, SALARY, DEPARTMENT_ID, CHIEF_ID)` –Ω—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ **—Å–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤**, —á—å—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –±–æ–ª—å—à–µ, —á–µ–º —É –∏—Ö **–Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è** (`CHIEF_ID`).\n\n**–ö–æ–¥:**\n\n```sql\nCREATE TABLE EMPLOYEE (\n    ID int,\n    NAME VARCHAR(256),\n    SALARY int,\n    DEPARTMENT_ID int,\n    CHIEF_ID int\n);\n\n-- –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö\n-- ID | NAME      | SALARY | DEPARTMENT_ID | CHIEF_ID\n-- ---+------------+--------+---------------+----------\n-- 1  | –ò–≤–∞–Ω–æ–≤     | 150    | 1             | null\n-- 2  | –ü–µ—Ç—Ä–æ–≤     | 250    | 1             | 1\n-- 3  | –°–∏–¥–æ—Ä–æ–≤    | 550    | 1             | 1\n-- 4  | –ú–µ–¥–≤–µ–¥–µ–≤   | 350    | 2             | 6\n-- 5  | –°–æ–∫–æ–ª–æ–≤    | 350    | 2             | 6\n-- 6  | –†—ã–±–Ω–∏–∫–æ–≤   | 150    | 2             | null\n-- 7  | –ê—Ä–±—É–∑–æ–≤    | 450    | 3             | null\n-- 8  | –û—Ä–µ—Ö–æ–≤     | 650    | 3             | 7\n-- 9  | –î—ã–Ω–∏–Ω      | 50     | 3             | 7\n```\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **self join** ‚Äî —Å–æ–µ–¥–∏–Ω–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É `EMPLOYEE` —Å–∞–º—É —Å —Å–æ–±–æ–π.  \nüí° –£—Å–ª–æ–≤–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: `e.CHIEF_ID = c.ID`, –≥–¥–µ `c` ‚Äî –Ω–∞—á–∞–ª—å–Ω–∏–∫.  \nüí° –í `WHERE` –æ—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–µ—Ö, —É –∫–æ–≥–æ `e.SALARY > c.SALARY`.  \nüí° –ò—Å–∫–ª—é—á–∏—Ç–µ –∑–∞–ø–∏—Å–∏, –≥–¥–µ `CHIEF_ID IS NULL` ‚Äî —É –Ω–∏—Ö –Ω–µ—Ç —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT \n    e.NAME       AS employee_name,\n    e.SALARY     AS employee_salary,\n    c.NAME       AS chief_name,\n    c.SALARY     AS chief_salary\nFROM EMPLOYEE e\nJOIN EMPLOYEE c\n  ON e.CHIEF_ID = c.ID\nWHERE e.SALARY > c.SALARY;\n```\n\n**–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**\n\n|employee_name|employee_salary|chief_name|chief_salary|\n|---|---|---|---|\n|–ü–µ—Ç—Ä–æ–≤|250|–ò–≤–∞–Ω–æ–≤|150|\n|–°–∏–¥–æ—Ä–æ–≤|550|–ò–≤–∞–Ω–æ–≤|150|\n|–ú–µ–¥–≤–µ–¥–µ–≤|350|–†—ã–±–Ω–∏–∫–æ–≤|150|\n|–°–æ–∫–æ–ª–æ–≤|350|–†—ã–±–Ω–∏–∫–æ–≤|150|\n|–û—Ä–µ—Ö–æ–≤|650|–ê—Ä–±—É–∑–æ–≤|450|\n\nüß† **–ü–æ—è—Å–Ω–µ–Ω–∏–µ:**\n\n- –¢–∞–±–ª–∏—Ü–∞ —Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è —Å–∞–º–∞ —Å —Å–æ–±–æ–π, —á—Ç–æ–±—ã ‚Äú–¥–æ—Å—Ç–∞—Ç—å‚Äù –∑–∞—Ä–ø–ª–∞—Ç—É –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞.\n\n- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å—Ç—Ä–æ—á–Ω–æ: –µ—Å–ª–∏ `SALARY > CHIEF.SALARY`, —Å—Ç—Ä–æ–∫–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.\n\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-employees-higher-salary-than-chief"

[[tasks]]
  id = 56
  question = "–û—Ç–¥–µ–ª—ã, –≥–¥–µ —á–∏—Å–ª–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç —Ç—Ä—ë—Ö —á–µ–ª–æ–≤–µ–∫"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –í —Ç–∞–±–ª–∏—Ü–µ `EMPLOYEE(ID, NAME, SALARY, DEPARTMENT_ID, CHIEF_ID)` –Ω—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ **—Å–ø–∏—Å–æ–∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –æ—Ç–¥–µ–ª–æ–≤**, –≥–¥–µ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ **‚â§ 3**.\n\n**–ö–æ–¥:**\n\n```sql\nCREATE TABLE EMPLOYEE (\n    ID int,\n    NAME VARCHAR(256),\n    SALARY int,\n    DEPARTMENT_ID int,\n    CHIEF_ID int\n);\n\n-- –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:\n-- ID | NAME      | SALARY | DEPARTMENT_ID | CHIEF_ID\n-- ---+------------+--------+---------------+----------\n-- 1  | –ò–≤–∞–Ω–æ–≤     | 150    | 1             | null\n-- 2  | –ü–µ—Ç—Ä–æ–≤     | 250    | 1             | 1\n-- 3  | –°–∏–¥–æ—Ä–æ–≤    | 550    | 1             | 1\n-- 4  | –ú–µ–¥–≤–µ–¥–µ–≤   | 350    | 2             | 6\n-- 5  | –°–æ–∫–æ–ª–æ–≤    | 350    | 2             | 6\n-- 6  | –†—ã–±–Ω–∏–∫–æ–≤   | 150    | 2             | null\n-- 7  | –ê—Ä–±—É–∑–æ–≤    | 450    | 3             | null\n-- 8  | –û—Ä–µ—Ö–æ–≤     | 650    | 3             | 7\n-- 9  | –î—ã–Ω–∏–Ω      | 50     | 3             | 7\n```\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GROUP BY department_id`, —á—Ç–æ–±—ã —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –æ—Ç–¥–µ–ª–∞–º.  \nüí° –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –∞–≥—Ä–µ–≥–∞—Ç `COUNT(*)` –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ —á–∏—Å–ª–∞ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –æ—Ç–¥–µ–ª–µ.  \nüí° –û—Ç–±–µ—Ä–∏—Ç–µ –æ—Ç–¥–µ–ª—ã, –≥–¥–µ `COUNT(*) <= 3`.  \nüí° –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `ORDER BY department_id` –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT \n    department_id\nFROM EMPLOYEE\nGROUP BY department_id\nHAVING COUNT(*) <= 3\nORDER BY department_id;\n```\n\n**–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**\n\n|department_id|\n|---|\n|1|\n|2|\n|3|\n\nüß† **–ü–æ—è—Å–Ω–µ–Ω–∏–µ:**\n\n- –í—Å–µ —Ç—Ä–∏ –æ—Ç–¥–µ–ª–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ä–æ–≤–Ω–æ –ø–æ 3 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –ø–æ—ç—Ç–æ–º—É –æ–Ω–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è.\n\n- –ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –ø–æ—è–≤–∏—Ç—Å—è –æ—Ç–¥–µ–ª —Å 4+ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏, –æ–Ω –±—É–¥–µ—Ç –∏—Å–∫–ª—é—á—ë–Ω –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.\n\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-departments-with-few-employees"

[[tasks]]
  id = 57
  question = "–ù–∞–π—Ç–∏ –¥—É–±–ª–∏ email —Å—Ä–µ–¥–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤-–º—É–∂—á–∏–Ω"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –í —Ç–∞–±–ª–∏—Ü–µ `customers` –ø–æ—è–≤–∏–ª–∏—Å—å –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –ø–æ–ª—é `email`.  \n–ù—É–∂–Ω–æ:\n\n- –∏—Å–∫–∞—Ç—å –¥—É–±–ª–∏ —Ç–æ–ª—å–∫–æ —Å—Ä–µ–¥–∏ –∑–∞–ø–∏—Å–µ–π, –≥–¥–µ `gender = 'male'`;\n\n- –≤—ã–≤–µ—Å—Ç–∏ 2 –∫–æ–ª–æ–Ω–∫–∏:\n\n    - `email`\n\n    - `cnt` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Å—Ç—Ä–µ—á\n\n\n---\n\n### SQL-–∑–∞–ø—Ä–æ—Å\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–µ–º `WHERE gender = 'male'`, —á—Ç–æ–±—ã –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –≤—ã–±–æ—Ä–∫—É.  \nüí° `GROUP BY email` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ email.  \nüí° `HAVING COUNT(*) > 1` –≤—ã–≤–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥—É–±–ª–∏–∫–∞—Ç—ã.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT\n    email,\n    COUNT(*) AS cnt\nFROM customers\nWHERE gender = 'male'\nGROUP BY email\nHAVING COUNT(*) > 1;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-find-email-duplicates"

[[tasks]]
  id = 58
  question = "–ü—Ä–∏–º–µ—Ä —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å HAVING"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ **Employees** —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:\n\n- `employee_name`\n\n- `salary`\n\n- `department_id`\n\n\n–ù—É–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å **–ø—Ä–∏–º–µ—Ä–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å SQL-–∑–∞–ø—Ä–æ—Å–∞ —Å HAVING**.\n\n---\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° `HAVING` –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è **–ø–æ—Å–ª–µ GROUP BY** –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —É–∂–µ —Å –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏.  \nüí° –ß–∞—Å—Ç—ã–π –∫–µ–π—Å ‚Äî –æ—Ç–±–∏—Ä–∞—Ç—å –≥—Ä—É–ø–ø—ã, –≥–¥–µ —Å—É–º–º–∞/–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ/—Å—Ä–µ–¥–Ω–µ–µ –≤—ã—à–µ/–Ω–∏–∂–µ –ø–æ—Ä–æ–≥–∞.  \n{{< /details >}}\n\n---\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT \n    department_id,\n    COUNT(*) AS emp_count,\n    AVG(salary) AS avg_salary\nFROM Employees\nGROUP BY department_id\nHAVING AVG(salary) > 50000;\n```\n\n**–ü–æ—è—Å–Ω–µ–Ω–∏–µ:**\n\n- `GROUP BY department_id` ‚Äî –≥—Ä—É–ø–ø–∏—Ä—É–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –æ—Ç–¥–µ–ª–∞–º.\n\n- `AVG(salary)` ‚Äî —Å—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω—é—é –ó–ü –≤ –∫–∞–∂–¥–æ–º –æ—Ç–¥–µ–ª–µ.\n\n- `HAVING AVG(salary) > 50000` ‚Äî —Ñ–∏–ª—å—Ç—Ä—É–µ–º –æ—Ç–¥–µ–ª—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ **–±–æ–ª—å—à–µ 50 000**.\n\n\n–≠—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `HAVING`.\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-having-example"

[[tasks]]
  id = 59
  question = "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –æ—Ç–¥–µ–ª–∞–º —Å—Ä–µ–¥–∏ –Ω–µ—É–≤–æ–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –î–∞–Ω—ã —Ç–∞–±–ª–∏—Ü—ã `units` –∏ `employees`.  \n–ù—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω—ë—Ç:\n\n- ID –æ—Ç–¥–µ–ª–∞,\n\n- –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É,\n\n- –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É  \n  ‚Äî —Å—Ä–µ–¥–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö `fired = false`.\n\n\n**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü:**\n\n```\nunits:\n  id int PK\n  name text\n\nemployees:\n  id int PK\n  unit_id int FK ‚Üí units.id\n  salary numeric\n  fired boolean\n```\n\n---\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n---\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –î–µ–ª–∞–µ–º `JOIN` —Ç–∞–±–ª–∏—Ü –ø–æ `unit_id`.  \nüí° –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ `fired = false`.  \nüí° –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –æ—Ç–¥–µ–ª–∞–º (`GROUP BY`).  \nüí° –ò—Å–ø–æ–ª—å–∑—É–µ–º `MIN()` –∏ `MAX()` –¥–ª—è –∑–∞—Ä–ø–ª–∞—Ç.  \nüí° –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å _–≤—Å–µ –æ—Ç–¥–µ–ª—ã_, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `LEFT JOIN`.  \n{{< /details >}}\n\n---\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT\n    u.id AS unit_id,\n    u.name AS unit_name,\n    MIN(e.salary) AS min_salary,\n    MAX(e.salary) AS max_salary\nFROM units u\nJOIN employees e\n  ON e.unit_id = u.id\n AND e.fired = false\nGROUP BY u.id, u.name;\n```\n\n**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–∞–∂–µ –æ—Ç–¥–µ–ª—ã –±–µ–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤):**\n\n```sql\nSELECT\n    u.id AS unit_id,\n    u.name AS unit_name,\n    MIN(e.salary) AS min_salary,\n    MAX(e.salary) AS max_salary\nFROM units u\nLEFT JOIN employees e\n  ON e.unit_id = u.id\n AND e.fired = false\nGROUP BY u.id, u.name;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-min-max-salary-active-employees"

[[tasks]]
  id = 60
  question = "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –æ—Ç–¥–µ–ª–∞–º —Å—Ä–µ–¥–∏ –Ω–µ—É–≤–æ–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ù—É–∂–Ω–æ –ø—Ä–∏–¥—É–º–∞—Ç—å SQL-–ø—Ä–∏–º–µ—Ä, –≥–¥–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `WHERE` –∏ `HAVING`, –∏ –ø–æ–∫–∞–∑–∞—Ç—å —Ä–∞–∑–Ω–∏—Ü—É.  \n–ó–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞.\n\n---\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n---\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° `WHERE` ‚Äî —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç **—Å—Ç—Ä–æ–∫–∏ –¥–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏**.  \nüí° `HAVING` ‚Äî —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç **–≥—Ä—É–ø–ø—ã –ø–æ—Å–ª–µ GROUP BY**.  \nüí° –•–æ—Ä–æ—à–∏–π –ø—Ä–∏–º–µ—Ä: –≤—ã–±—Ä–∞—Ç—å –æ—Ç–¥–µ–ª—ã, –≥–¥–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ (`WHERE`), –∏ —Å—Ä–µ–¥–∏ –Ω–∏—Ö –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ, –≥–¥–µ **—Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤—ã—à–µ 50k** (`HAVING`).  \n{{< /details >}}\n\n---\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT \n    department_id,\n    AVG(salary) AS avg_salary,\n    COUNT(*) AS emp_count\nFROM employees\nWHERE status = 'ACTIVE'          -- —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å—Ç—Ä–æ–∫ –¥–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏\nGROUP BY department_id\nHAVING AVG(salary) > 50000       -- —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≥—Ä—É–ø–ø –ø–æ—Å–ª–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏\n   AND COUNT(*) >= 3;            -- –ø—Ä–∏–º–µ—Ä –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É—Å–ª–æ–≤–∏—è\n```\n\n**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å:**\n\n- `WHERE status = 'ACTIVE'`  \n  ‚Üí –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –±–µ—Ä—ë–º —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.\n\n- `GROUP BY department_id`  \n  ‚Üí –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –æ—Ç–¥–µ–ª–∞–º.\n\n- `HAVING AVG(salary) > 50000`  \n  ‚Üí –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ –æ—Ç–¥–µ–ª—ã, –≥–¥–µ —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤—ã—à–µ 50k.\n\n- `COUNT(*) >= 3`  \n  ‚Üí –∏ –≤ –æ—Ç–¥–µ–ª–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ —Ç—Ä—ë—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.\n\n\n–ò—Ç–æ–≥–æ: –∑–∞–ø—Ä–æ—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ç–¥–µ–ª—ã —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∏–º —à—Ç–∞—Ç–æ–º –∏ –≤—ã—Å–æ–∫–æ–π —Å—Ä–µ–¥–Ω–µ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π.\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-having-vs-where-example"

[[tasks]]
  id = 61
  question = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –æ—Ç–¥–µ–ª–∞–º –∏ –æ—Ç–¥–µ–ª—ã —Å >3 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ —Å –ó–ü > 100–∫"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –î–∞–Ω—ã —Ç–∞–±–ª–∏—Ü—ã `departments` –∏ `employees`. –ù—É–∂–Ω–æ:\n\n1. –ù–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Å—á–∏—Ç–∞–µ—Ç **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏**.\n\n2. –ù–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–π–¥—ë—Ç **–æ—Ç–¥–µ–ª—ã, –≥–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ–ª—å—à–µ —Ç—Ä—ë—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –∑–∞—Ä–ø–ª–∞—Ç–æ–π –±–æ–ª–µ–µ 100000**.\n\n\n**–ö–æ–¥ (—Å—Ö–µ–º–∞ –∏ –¥–∞–Ω–Ω—ã–µ):**\n\n```sql\nCREATE TABLE departments (\n    id INT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL\n);\n\nCREATE TABLE employees (\n    id INT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    department_id INT REFERENCES departments(id),\n    salary INT NOT NULL\n);\n\n-- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –æ—Ç–¥–µ–ª–æ–≤\nINSERT INTO departments (id, name) VALUES\n(1, '–û—Ç–¥–µ–ª –ò–¢'),\n(2, '–û—Ç–¥–µ–ª –ò–ë'),\n(3, 'HR');\n\n-- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤\nINSERT INTO employees (id, name, department_id, salary) VALUES\n(1, '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤', 1, 120000),\n(2, '–ï–ª–µ–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞', 1, 110000),\n(3, '–ê–ª–µ–∫—Å–µ–π –ò–≤–∞–Ω–æ–≤', 1, 105000),\n(4, '–ú–∞—Ä–∏—è –ö—É–∑–Ω–µ—Ü–æ–≤–∞', 1, 95000),\n(5, '–î–º–∏—Ç—Ä–∏–π –°–º–∏—Ä–Ω–æ–≤', 2, 150000),\n(6, '–û–ª—å–≥–∞ –í–∞—Å–∏–ª—å–µ–≤–∞', 2, 130000),\n(7, '–°–µ—Ä–≥–µ–π –ú–∏—Ä–æ–Ω–æ–≤', 2, 80000),\n(8, '–ê–Ω–Ω–∞ –ñ—É–∫–æ–≤–∞', 3, 115000),\n(9, '–ü–∞–≤–µ–ª –ë–µ–ª–æ–≤', 3, 125000),\n(10, '–ù–∞—Ç–∞–ª—å—è –í–æ—Ä–æ–±—å–µ–≤–∞', 3, 140000),\n(11, '–ê—Ä—Ç–µ–º –ì—Ä–æ–º–æ–≤', 3, 98000),\n(12, '–í–∏–∫—Ç–æ—Ä–∏—è –û—Ä–ª–æ–≤–∞', 1, 108000);\n```\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –î–ª—è –∑–∞–¥–∞—á–∏ 1:\n\n- –ù—É–∂–Ω–æ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –æ—Ç–¥–µ–ª–∞–º: `GROUP BY department_id` –∏–ª–∏ –ø–æ `departments.id`.\n\n- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –æ—Ç–¥–µ–ª—ã –±–µ–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π `LEFT JOIN`.\n\n\nüí° –î–ª—è –∑–∞–¥–∞—á–∏ 2:\n\n- –°–Ω–∞—á–∞–ª–∞ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å `salary > 100000`.\n\n- –ü–æ—Ç–æ–º —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –æ—Ç–¥–µ–ª–∞–º.\n\n- –ò —á–µ—Ä–µ–∑ `HAVING COUNT(*) > 3` –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ—Ç–¥–µ–ª—ã, –≥–¥–µ —Ç–∞–∫–∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –±–æ–ª—å—à–µ —Ç—Ä—ë—Ö.  \n  {{< /details >}}\n\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n### 1. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏\n\n```sql\nSELECT \n    d.id   AS department_id,\n    d.name AS department_name,\n    COUNT(e.id) AS employee_count\nFROM departments d\nLEFT JOIN employees e\n    ON e.department_id = d.id\nGROUP BY d.id, d.name\nORDER BY d.id;\n```\n\n> `LEFT JOIN` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –æ—Ç–¥–µ–ª—ã –±–µ–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Ç–æ–∂–µ –ø–æ–ø–∞–¥—É—Ç –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Å `employee_count = 0`).\n\n---\n\n### 2. –û—Ç–¥–µ–ª—ã, –≥–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ–ª—å—à–µ —Ç—Ä—ë—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –∑–∞—Ä–ø–ª–∞—Ç–æ–π > 100000\n\n```sql\nSELECT \n    d.id   AS department_id,\n    d.name AS department_name,\n    COUNT(e.id) AS high_paid_count\nFROM departments d\nJOIN employees e\n    ON e.department_id = d.id\nWHERE e.salary > 100000\nGROUP BY d.id, d.name\nHAVING COUNT(e.id) > 3;\n```\n\n- `WHERE e.salary > 100000` ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –ó–ü > 100–∫.\n\n- `GROUP BY d.id, d.name` ‚Äî –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –∏—Ö –ø–æ –æ—Ç–¥–µ–ª–∞–º.\n\n- `HAVING COUNT(e.id) > 3` ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ –æ—Ç–¥–µ–ª—ã, –≥–¥–µ **—Å—Ç—Ä–æ–≥–æ –±–æ–ª—å—à–µ —Ç—Ä—ë—Ö** —Ç–∞–∫–∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.\n\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-departments-employees-aggregation"

[[tasks]]
  id = 62
  question = "–°—Ö–µ–º–∞ –ë–î –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ù—É–∂–Ω–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î –¥–ª—è **–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π** —Å –∏–µ—Ä–∞—Ä—Ö–∏–µ–π —É—Ä–æ–≤–Ω–µ–π (—Ö–æ–ª–¥–∏–Ω–≥ ‚Üí —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Üí –æ—Ç–¥–µ–ª ‚Üí –±—é—Ä–æ –∏ —Ç.–¥.).  \n–ù—É–∂–Ω–æ –æ—Ç–≤–µ—Ç–∏—Ç—å:\n\n- –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É –¥–µ–ª–∞–µ–º –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ?\n\n- –∫–∞–∫–∏–µ —Å—Ç–æ–ª–±—Ü—ã –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞ –≤–∏–¥–∞:\n\n\n```text\n–¢–ù - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏\n  –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–ë\n    –û—Ç–¥–µ–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ—à–µ–Ω–∏–π –ò–ë\n      –ë—é—Ä–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏\n      –ë—é—Ä–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏\n  –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–¢\n    –û—Ç–¥–µ–ª –ò–¢\n    –û—Ç–¥–µ–ª –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã\n\n–¢–ù - –î–∞–ª—å–Ω–∏–π –≤–æ—Å—Ç–æ–∫\n  –†–ù–£\n    –ù–ü–° 1\n    –ù–ü–° 2\n```\n\n---\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –î–ª—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ —á–∞—â–µ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **adjacency list**: —É –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –µ—Å—Ç—å `parent_id`.  \nüí° –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å **–æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É** `org_unit`, –≥–¥–µ –≤–µ—Ä—Ö–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å (–¢–ù) –∏–º–µ–µ—Ç `parent_id = NULL`.  \nüí° –ü–æ–ª–µ–∑–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å:  \n‚Äì `id`  \n‚Äì `parent_id`  \n‚Äì `name`  \n‚Äì —Ç–∏–ø –∏–ª–∏ —É—Ä–æ–≤–µ–Ω—å (`type` / `level`)  \n‚Äì —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è (`sort_order`).  \nüí° –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `root_id` –∏–ª–∏ `tree_id`.  \n{{< /details >}}\n\n---\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n–î–ª—è —Ç–∏–ø–æ–≤–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —è –±—ã —Å–¥–µ–ª–∞–ª **–æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É** —Å –∏–µ—Ä–∞—Ä—Ö–∏–µ–π –ø–æ `parent_id`:\n\n```sql\nCREATE TABLE org_units (\n    id           BIGINT PRIMARY KEY,          -- —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É–∑–ª–∞\n    parent_id    BIGINT NULL,                 -- —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—è (NULL –¥–ª—è –∫–æ—Ä–Ω—è)\n    name         VARCHAR(255) NOT NULL,       -- –Ω–∞–∑–≤–∞–Ω–∏–µ: \"–¢–ù - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏\", \"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–ë\", \"–ù–ü–° 1\" –∏ —Ç.–ø.\n    type         VARCHAR(50)  NOT NULL,       -- —Ç–∏–ø —É–∑–ª–∞: 'HOLDING', 'REGION', 'DEPARTMENT', 'BUREAU', 'NPS' –∏ —Ç.–¥.\n    level        INT          NOT NULL,       -- —É—Ä–æ–≤–µ–Ω—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏: 1,2,3,4...\n    code         VARCHAR(50),                 -- –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–¥ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)\n    sort_order   INT          NOT NULL DEFAULT 0,  -- –ø–æ—Ä—è–¥–æ–∫ –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ parent\n    is_active    BOOLEAN      NOT NULL DEFAULT TRUE, -- –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏\n    created_at   TIMESTAMP    NOT NULL DEFAULT now(),\n    updated_at   TIMESTAMP    NOT NULL DEFAULT now()\n);\n\n-- –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—è\nALTER TABLE org_units\n    ADD CONSTRAINT fk_org_units_parent\n    FOREIGN KEY (parent_id) REFERENCES org_units(id);\n```\n\n**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ:**\n\n|id|parent_id|name|type|level|\n|---|---|---|---|---|\n|1|NULL|–¢–ù - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏|HOLDING|1|\n|2|1|–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–ë|MANAGEMENT|2|\n|3|2|–û—Ç–¥–µ–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ—à–µ–Ω–∏–π –ò–ë|DEPT|3|\n|4|3|–ë—é—Ä–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏|BUREAU|4|\n|5|3|–ë—é—Ä–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏|BUREAU|4|\n|6|1|–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–¢|MANAGEMENT|2|\n|7|6|–û—Ç–¥–µ–ª –ò–¢|DEPT|3|\n|8|6|–û—Ç–¥–µ–ª –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã|DEPT|3|\n|9|NULL|–¢–ù - –î–∞–ª—å–Ω–∏–π –≤–æ—Å—Ç–æ–∫|HOLDING|1|\n|10|9|–†–ù–£|MANAGEMENT|2|\n|11|10|–ù–ü–° 1|NPS|3|\n|12|10|–ù–ü–° 2|NPS|3|\n\n**–ü–æ—á–µ–º—É –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ:**\n\n- –ò–µ—Ä–∞—Ä—Ö–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –≥–ª—É–±–∏–Ω—ã ‚Äî –ø—Ä–æ—Å—Ç–æ —Ü–µ–ø–æ—á–∫–∞ `parent_id`.\n\n- –ù–µ –Ω—É–∂–Ω–æ –ø–ª–æ–¥–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã –ø–æ–¥ –∫–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å (`holdings`, `departments`, `bureaus` –∏ —Ç.–ø.).\n\n- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏ –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π —Å—Ö–µ–º—ã (–Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ `type`).\n\n- –ó–∞–ø—Ä–æ—Å—ã –≤–∏–¥–∞ ¬´–≤—Å–µ –¥–æ—á–µ—Ä–Ω–∏–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –¢–ù - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏¬ª —Å—Ç—Ä–æ—è—Ç—Å—è –ø–æ `parent_id`/`level`/`type`.\n\n\n> –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –æ—Ç–¥–µ–ª–∏—Ç—å _–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –≤ —Ü–µ–ª–æ–º_ –æ—Ç _—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü_,  \n> –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `organizations` –∏ –≤ `org_units` —Ö—Ä–∞–Ω–∏—Ç—å `organization_id`.  \n> –ù–æ –¥–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ ¬´–¥–µ—Ä–µ–≤–∞ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π¬ª —á–∞—Å—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–¥–Ω–æ–π `org_units`.\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-org-directory-schema"

[[tasks]]
  id = 63
  question = "–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –∏–∑–¥–µ–ª–∏–π (–≤–µ–¥–æ–º–æ—Å—Ç—å —Å–æ—Å—Ç–∞–≤–∞ / BOM)"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ù—É–∂–Ω–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—É –ë–î –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–∞–≤–∞ –∏–∑–¥–µ–ª–∏—è (BOM).  \n–ï—Å—Ç—å –∏–∑–¥–µ–ª–∏–µ –∏ –µ–≥–æ —Å–æ—Å—Ç–∞–≤:\n\n```text\n1 –î–∞—Ç—á–∏–∫\n  2 –ö–æ—Ä–ø—É—Å 1 —à—Ç\n    3 –í–∏–Ω—Ç 8 —à—Ç\n  3 –í–∏–Ω—Ç 4 —à—Ç\n```\n\n–ó–∞–¥–∞—á–∞: –∫–∞–∫–∏–µ –±—É–¥—É—Ç **—Ç–∞–±–ª–∏—Ü—ã** –∏ **—Å—Ç–æ–ª–±—Ü—ã**, —á—Ç–æ–±—ã:\n\n- —Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –∏–∑–¥–µ–ª–∏—è/–¥–µ—Ç–∞–ª–∏ (–Ω–æ—Ä–º–∞—Ç–∏–≤–∫–∞);\n\n- —Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É: –∫–∞–∫–æ–µ –∏–∑–¥–µ–ª–∏–µ –∏–∑ –∫–∞–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–æ—Å—Ç–æ–∏—Ç –∏ –≤ –∫–∞–∫–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ;\n\n- –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –¥–µ—Ç–∞–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–í–∏–Ω—Ç¬ª –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö –∏ –≤ —Ä–∞–∑–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ).\n\n\n---\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –û–±—ã—á–Ω–æ –¥–µ–ª–∞–µ–º **2 —Ç–∞–±–ª–∏—Ü—ã**:\n\n1. `items` ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∏–∑–¥–µ–ª–∏–π/–¥–µ—Ç–∞–ª–µ–π (—á—Ç–æ —ç—Ç–æ –∑–∞ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞).\n\n2. `bom` (bill of materials) ‚Äî —Å–≤—è–∑–∏ ¬´—Ä–æ–¥–∏—Ç–µ–ª—å ‚Üí –∫–æ–º–ø–æ–Ω–µ–Ω—Ç + –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ¬ª.\n\n\nüí° –í `bom` –Ω—É–∂–Ω—ã:\n\n- `parent_item_id` ‚Äî —á—Ç–æ —Å–æ–±–∏—Ä–∞–µ–º,\n\n- `component_item_id` ‚Äî –∏–∑ —á–µ–≥–æ,\n\n- `quantity` ‚Äî —Å–∫–æ–ª—å–∫–æ —à—Ç—É–∫,\n\n- –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ `level` / `position` / `unit`.  \n  {{< /details >}}\n\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n### 1. –¢–∞–±–ª–∏—Ü–∞ –∏–∑–¥–µ–ª–∏–π / –¥–µ—Ç–∞–ª–µ–π\n\n```sql\nCREATE TABLE items (\n    id           BIGINT PRIMARY KEY,           -- 1, 2, 3 ...\n    name         VARCHAR(255) NOT NULL,        -- \"–î–∞—Ç—á–∏–∫\", \"–ö–æ—Ä–ø—É—Å\", \"–í–∏–Ω—Ç\"\n    item_code    VARCHAR(50),                  -- –∞—Ä—Ç–∏–∫—É–ª / –≤–Ω—É—Ç—Ä. –∫–æ–¥ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)\n    item_type    VARCHAR(50),                  -- —Ç–∏–ø: 'ASSEMBLY', 'PART', 'RAW' –∏ —Ç.–ø.\n    unit         VARCHAR(20) NOT NULL DEFAULT '—à—Ç', -- –±–∞–∑–æ–≤–∞—è –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è\n    is_active    BOOLEAN NOT NULL DEFAULT TRUE,\n    created_at   TIMESTAMP NOT NULL DEFAULT now(),\n    updated_at   TIMESTAMP NOT NULL DEFAULT now()\n);\n```\n\n–ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–≤–æ–µ–≥–æ —Å–ª—É—á–∞—è:\n\n```text\nid | name    | item_type\n---+---------+----------\n1  | –î–∞—Ç—á–∏–∫  | ASSEMBLY\n2  | –ö–æ—Ä–ø—É—Å  | ASSEMBLY\n3  | –í–∏–Ω—Ç    | PART\n```\n\n---\n\n### 2. –¢–∞–±–ª–∏—Ü–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑–¥–µ–ª–∏—è (BOM)\n\n```sql\nCREATE TABLE bom (\n    id                BIGINT PRIMARY KEY,\n    parent_item_id    BIGINT NOT NULL,      -- –∏–∑–¥–µ–ª–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ–±–∏—Ä–∞–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, \"–î–∞—Ç—á–∏–∫\")\n    component_item_id BIGINT NOT NULL,      -- –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, \"–ö–æ—Ä–ø—É—Å\", \"–í–∏–Ω—Ç\")\n    quantity          NUMERIC(12, 3) NOT NULL, -- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –Ω–∞ 1 –µ–¥. —Ä–æ–¥–∏—Ç–µ–ª—è\n    unit              VARCHAR(20) NOT NULL DEFAULT '—à—Ç', -- –µ–¥. –∏–∑–º–µ—Ä–µ–Ω–∏—è (—à—Ç, –∫–≥, –º –∏ —Ç.–ø.)\n    position          INT,                 -- –ø–æ–∑–∏—Ü–∏—è –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–¥–ª—è –ø–µ—á–∞—Ç–Ω—ã—Ö —Ñ–æ—Ä–º)\n    level_hint        INT,                 -- –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —É—Ä–æ–≤–µ–Ω—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ (1,2,3 ...)\n    CONSTRAINT fk_bom_parent\n        FOREIGN KEY (parent_item_id) REFERENCES items(id),\n    CONSTRAINT fk_bom_component\n        FOREIGN KEY (component_item_id) REFERENCES items(id)\n);\n```\n\n–î–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞:\n\n```text\n-- –î–∞—Ç—á–∏–∫ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:\n-- 1) –ö–æ—Ä–ø—É—Å 1 —à—Ç\n-- 2) –í–∏–Ω—Ç 4 —à—Ç\nINSERT INTO bom (id, parent_item_id, component_item_id, quantity, unit, position, level_hint)\nVALUES\n(1, 1, 2, 1,  '—à—Ç', 1, 1),   -- –î–∞—Ç—á–∏–∫ -> –ö–æ—Ä–ø—É—Å 1 —à—Ç\n(2, 1, 3, 4,  '—à—Ç', 2, 1);   -- –î–∞—Ç—á–∏–∫ -> –í–∏–Ω—Ç 4 —à—Ç\n\n-- –ö–æ—Ä–ø—É—Å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:\n-- 3) –í–∏–Ω—Ç 8 —à—Ç\nINSERT INTO bom (id, parent_item_id, component_item_id, quantity, unit, position, level_hint)\nVALUES\n(3, 2, 3, 8, '—à—Ç', 1, 2);    -- –ö–æ—Ä–ø—É—Å -> –í–∏–Ω—Ç 8 —à—Ç\n```\n\n**–ö–∞–∫ —á–∏—Ç–∞–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**\n\n- `parent_item_id = 1 (\"–î–∞—Ç—á–∏–∫\")`, `component_item_id = 2 (\"–ö–æ—Ä–ø—É—Å\")`, `quantity = 1` ‚Üí  \n  –ù–∞ –æ–¥–∏–Ω –¥–∞—Ç—á–∏–∫ –Ω—É–∂–µ–Ω –æ–¥–∏–Ω –∫–æ—Ä–ø—É—Å.\n\n- `parent_item_id = 1 (\"–î–∞—Ç—á–∏–∫\")`, `component_item_id = 3 (\"–í–∏–Ω—Ç\")`, `quantity = 4` ‚Üí  \n  –ù–∞ –æ–¥–∏–Ω –¥–∞—Ç—á–∏–∫ –Ω—É–∂–Ω–æ 4 –≤–∏–Ω—Ç–∞ ¬´–≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è¬ª.\n\n- `parent_item_id = 2 (\"–ö–æ—Ä–ø—É—Å\")`, `component_item_id = 3 (\"–í–∏–Ω—Ç\")`, `quantity = 8` ‚Üí  \n  –ù–∞ –æ–¥–∏–Ω –∫–æ—Ä–ø—É—Å –Ω—É–∂–Ω–æ 8 –≤–∏–Ω—Ç–æ–≤.\n\n\n---\n\n**–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫:**\n\n- –û–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ `items` ‚Äî –æ–¥–∏–Ω —Ä–∞–∑ –æ–ø–∏—Å—ã–≤–∞–µ—Ç, _—á—Ç–æ_ —ç—Ç–æ –∑–∞ –¥–µ—Ç–∞–ª—å/–∏–∑–¥–µ–ª–∏–µ.\n\n- –¢–∞–±–ª–∏—Ü–∞ `bom` ‚Äî –æ–ø–∏—Å—ã–≤–∞–µ—Ç, _–∫–∞–∫_ –æ–¥–Ω–æ –∏–∑–¥–µ–ª–∏–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ –¥—Ä—É–≥–∏—Ö (—Ä–æ–¥–∏—Ç–µ–ª—å ‚Üí –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã).\n\n- –û–¥–Ω–∞ –∏ —Ç–∞ –∂–µ –¥–µ—Ç–∞–ª—å (`–í–∏–Ω—Ç`, id=3) –º–æ–∂–µ—Ç —Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö BOM —Å —Ä–∞–∑–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ ‚Äî —ç—Ç–æ –∫–∞–∫ —Ä–∞–∑ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏.\n\n\n–¢–∞–∫–æ–π –¥–∏–∑–∞–π–Ω ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –¥–ª—è —Å–∏—Å—Ç–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–∞–≤–æ–º –∏–∑–¥–µ–ª–∏—è (BOM/ERP/PLM).\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-bom-products-schema"

[[tasks]]
  id = 64
  question = "–ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ª–µ—Ç–∞–ª–∏ —Ç–æ–ª—å–∫–æ —ç–∫–æ–Ω–æ–º–æ–º"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ù—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å **—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ user_id**, –∫–æ—Ç–æ—Ä—ã–µ **–ª–µ—Ç–∞–ª–∏ —Ç–æ–ª—å–∫–æ –ø–æ –±–∏–ª–µ—Ç–∞–º –∫–ª–∞—Å—Å–∞ ECONOMY**.  \n–ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **—Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –±–∏–ª–µ—Ç BUSINESS**, –æ–Ω **–Ω–µ –¥–æ–ª–∂–µ–Ω –ø–æ–ø–∞—Å—Ç—å** –≤ –≤—ã–±–æ—Ä–∫—É.\n\n**–î–∞–Ω–Ω—ã–µ:**\n\n```\nticket_id | user_id | ticket_type | price\n-----------+---------+--------------+-------\n110        | 500     | 'ECONOMY'    | 10000\n220        | 600     | 'BUSINESS'   | 35000\n330        | 600     | 'ECONOMY'    | 15000\n440        | 750     | 'ECONOMY'    | 12000\n550        | 800     | 'BUSINESS'   | 40000\n660        | 750     | 'ECONOMY'    | 5000\n```\n\n---\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n---\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ù—É–∂–Ω–æ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –±–∏–ª–µ—Ç—ã –ø–æ `user_id`.  \nüí° –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–æ–¥–∏—Ç—Å—è, –µ—Å–ª–∏ `MIN(ticket_type) = MAX(ticket_type) = 'ECONOMY'`.  \nüí° –ò–ª–∏: —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å `COUNT(*) = COUNT(CASE WHEN ticket_type='ECONOMY' THEN 1 END)`.  \nüí° –ò–ª–∏: –∏—Å–∫–ª—é—á–∏—Ç—å —Ç–µ—Ö, —É –∫–æ–≥–æ –µ—Å—Ç—å BUSINESS.  \n{{< /details >}}\n\n---\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n### ‚úîÔ∏è –í–∞—Ä–∏–∞–Ω—Ç 1 ‚Äî —á–µ—Ä–µ–∑ GROUP BY + HAVING\n\n```sql\nSELECT user_id\nFROM tickets\nGROUP BY user_id\nHAVING COUNT(*) = COUNT(CASE WHEN ticket_type = 'ECONOMY' THEN 1 END);\n```\n\n**–õ–æ–≥–∏–∫–∞:**  \n–ï—Å–ª–∏ –æ–±—â–µ–µ —á–∏—Å–ª–æ –±–∏–ª–µ—Ç–æ–≤ = —á–∏—Å–ª—É ECONOMY-–±–∏–ª–µ—Ç–æ–≤ ‚Üí –¥—Ä—É–≥–∏—Ö –∫–ª–∞—Å—Å–æ–≤ –Ω–µ—Ç.\n\n---\n\n### ‚úîÔ∏è –í–∞—Ä–∏–∞–Ω—Ç 2 ‚Äî ¬´–∑–∞–ø—Ä–µ—Ç–∏—Ç—å –±–∏–∑–Ω–µ—Å¬ª (—Ç–æ–∂–µ –≤–µ—Ä–Ω–æ)\n\n```sql\nSELECT user_id\nFROM tickets\nGROUP BY user_id\nHAVING SUM(CASE WHEN ticket_type = 'BUSINESS' THEN 1 ELSE 0 END) = 0;\n```\n\n---\n\n### ‚úîÔ∏è –í–∞—Ä–∏–∞–Ω—Ç 3 ‚Äî —á–µ—Ä–µ–∑ NOT EXISTS\n\n```sql\nSELECT DISTINCT t1.user_id\nFROM tickets t1\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM tickets t2\n    WHERE t2.user_id = t1.user_id\n      AND t2.ticket_type = 'BUSINESS'\n);\n```\n\n---\n\n### ‚úîÔ∏è –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∑–∞–¥–∞–Ω–∏—è:\n\n|user_id|\n|---|\n|**500**|\n|**750**|\n\n- **500** ‚Äî —Ç–æ–ª—å–∫–æ ECONOMY\n\n- **750** ‚Äî —Ç–æ–ª—å–∫–æ ECONOMY\n\n- **600** ‚Äî –µ—Å—Ç—å –∏ ECONOMY, –∏ BUSINESS ‚Üí –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç\n\n- **800** ‚Äî —Ç–æ–ª—å–∫–æ BUSINESS ‚Üí —Ç–æ–∂–µ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç\n\n\n---\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-users-only-economy"

[[tasks]]
  id = 65
  question = "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –æ—Ç–¥–µ–ª–∞–º —Å—Ä–µ–¥–∏ –Ω–µ—É–≤–æ–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã:\n\n- `units` ‚Äî –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–∏\n\n- `employees` ‚Äî —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∫–æ–º–ø–∞–Ω–∏–∏\n\n\n–ù—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω—ë—Ç:\n\n- `unit_id`,\n\n- –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É (`min_salary`),\n\n- –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É (`max_salary`)\n\n\nüëâ **–¢–æ–ª—å–∫–æ —Å—Ä–µ–¥–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö `fired = false`.**\n\n**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü:**\n\n```\nunits:\n  id    -- primary key\n  name  -- –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è\n\nemployees:\n  id       -- primary key\n  unit_id  -- foreign key -> units.id\n  salary   -- –∑–∞—Ä–ø–ª–∞—Ç–∞\n  fired    -- —Ñ–ª–∞–≥ —É–≤–æ–ª–µ–Ω (true / false)\n```\n\n---\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n---\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ù—É–∂–Ω–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ `unit_id`.  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `MIN(salary)` –∏ `MAX(salary)`.  \nüí° –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `fired = false` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–æ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.  \nüí° –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–µ—Ä–Ω—É—Ç—å —Ç–æ–ª—å–∫–æ `unit_id`, –º–æ–∂–Ω–æ –Ω–µ –¥–µ–ª–∞—Ç—å `JOIN` —Å `units`.  \n{{< /details >}}\n\n---\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT\n    e.unit_id,\n    MIN(e.salary) AS min_salary,\n    MAX(e.salary) AS max_salary\nFROM employees e\nWHERE e.fired = false\nGROUP BY e.unit_id;\n```\n\n**–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:**\n\n- `WHERE e.fired = false` ‚Äî –∏—Å–∫–ª—é—á–∞–µ–º —É–≤–æ–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.\n\n- `GROUP BY e.unit_id` ‚Äî —Å—á–∏—Ç–∞–µ–º –∞–≥—Ä–µ–≥–∞—Ç—ã –ø–æ –∫–∞–∂–¥–æ–º—É –æ—Ç–¥–µ–ª—É.\n\n- `MIN` –∏ `MAX` —Å—á–∏—Ç–∞—é—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É –≤–Ω—É—Ç—Ä–∏ –æ—Ç–¥–µ–ª–∞.\n\n\n---\n\n**–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª–∞:**\n\n```sql\nSELECT\n    u.id   AS unit_id,\n    u.name AS unit_name,\n    MIN(e.salary) AS min_salary,\n    MAX(e.salary) AS max_salary\nFROM units u\nJOIN employees e\n  ON e.unit_id = u.id\n AND e.fired = false\nGROUP BY u.id, u.name;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-min-max-salary-by-unit-active"

[[tasks]]
  id = 66
  question = "–ù–∞–π—Ç–∏ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã –±–µ–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã:\n\n- `Department(id, name)`\n\n- `Employee(id, salary, department_id)`\n\n\n–ù—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å **SELECT**, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç **–≤—Å–µ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞**.\n\n---\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n---\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `LEFT JOIN`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã.  \nüí° –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ `NULL` –≤ –ø–æ–ª—è—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `Employee`.  \nüí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ‚Äî `NOT EXISTS`.  \n{{< /details >}}\n\n---\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n### –í–∞—Ä–∏–∞–Ω—Ç 1 ‚Äî —á–µ—Ä–µ–∑ LEFT JOIN (—Å–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π)\n\n```sql\nSELECT\n    d.id,\n    d.name\nFROM Department d\nLEFT JOIN Employee e\n    ON e.department_id = d.id\nWHERE e.id IS NULL;\n```\n\n**–ü–æ—á–µ–º—É —Ä–∞–±–æ—Ç–∞–µ—Ç:**\n\n- `LEFT JOIN` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã.\n\n- –ï—Å–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–µ—Ç, –ø–æ–ª—è `Employee` –±—É–¥—É—Ç `NULL`.\n\n- `WHERE e.id IS NULL` –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–∞–∫–∏–µ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã.\n\n\n---\n\n### –í–∞—Ä–∏–∞–Ω—Ç 2 ‚Äî —á–µ—Ä–µ–∑ NOT EXISTS\n\n```sql\nSELECT\n    d.id,\n    d.name\nFROM Department d\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM Employee e\n    WHERE e.department_id = d.id\n);\n```\n\n**–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:**\n\n- –ß–∞—Å—Ç–æ –ª—É—á—à–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º.\n\n- –Ø–≤–Ω–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç –±–∏–∑–Ω–µ—Å-—Å–º—ã—Å–ª: ¬´–Ω–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤¬ª.\n\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-departments-without-employees"

[[tasks]]
  id = 67
  question = "–û—Ç–¥–µ–ª—ã –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –≥–¥–µ —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ > 90"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ù—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –æ—Ç–¥–µ–ª–æ–≤ **–≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ** —Å:\n\n- –Ω–∞–∑–≤–∞–Ω–∏–µ–º –æ—Ç–¥–µ–ª–∞\n\n- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –æ—Ç–¥–µ–ª–µ\n\n\n–ò –æ—Ç–æ–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ –æ—Ç–¥–µ–ª—ã, –≥–¥–µ **—Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ > 90**.\n\n**–ö–æ–¥:**\n\n```sql\n-- –û—Ç–¥–µ–ª:\nCREATE TABLE department (\n    id      INTEGER       NOT NULL,\n    name    VARCHAR(128)  NOT NULL,\n    PRIMARY KEY (id)\n);\n\n-- –°–æ—Ç—Ä—É–¥–Ω–∏–∫:\nCREATE TABLE employee (\n    id             INTEGER       NOT NULL,\n    department_id  INTEGER       NOT NULL,\n    manager_id     INTEGER,\n    name           VARCHAR(128)  NOT NULL,\n    salary         DECIMAL       NOT NULL,\n    PRIMARY KEY (id),\n    FOREIGN KEY (department_id) REFERENCES department(id),\n    FOREIGN KEY (manager_id) REFERENCES employee(id)\n);\n```\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –°–æ–µ–¥–∏–Ω—è–µ–º `department` –∏ `employee` –ø–æ `department_id`.  \nüí° –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –æ—Ç–¥–µ–ª—É (`GROUP BY d.id, d.name`).  \nüí° `COUNT(e.id)` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.  \nüí° `HAVING AVG(e.salary) > 90` ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ä–µ–¥–Ω–µ–π –∑–∞—Ä–ø–ª–∞—Ç–µ.  \nüí° `ORDER BY d.name` ‚Äî –∞–ª—Ñ–∞–≤–∏—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫.  \n{{< /details >}}\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT\n    d.name AS department_name,\n    COUNT(e.id) AS employees_count\nFROM department d\nJOIN employee e\n  ON e.department_id = d.id\nGROUP BY d.id, d.name\nHAVING AVG(e.salary) > 90\nORDER BY d.name;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-departments-avg-salary-gt-90"

[[tasks]]
  id = 68
  question = "–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –±–æ–ª—å—à–µ —Ç—Ä—ë—Ö"
  answer = "**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  \nüìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã `department` –∏ `users`.  \n–ù—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ **–¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã**, –≤ –∫–æ—Ç–æ—Ä—ã—Ö **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –±–æ–ª—å—à–µ 3**.\n\n**–°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö:**\n\n```sql\nCREATE TABLE department (\n    department_id BIGINT PRIMARY KEY,\n    department_name VARCHAR(255)\n);\n\nCREATE TABLE users (\n    user_id BIGINT PRIMARY KEY,\n    full_name VARCHAR(255),\n    department_id BIGINT,\n    CONSTRAINT fk_department\n        FOREIGN KEY (department_id)\n        REFERENCES department(department_id)\n);\n```\n\n---\n\n{{< hint warning >}}  \n**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  \n{{< /hint >}}\n\n{{< details \"–ü–æ–¥—Å–∫–∞–∑–∫–∏\" close >}}  \nüí° –ù—É–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—É.  \nüí° –ò—Å–ø–æ–ª—å–∑—É–µ–º `GROUP BY department_id`.  \nüí° –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `HAVING`, –∞ –Ω–µ `WHERE`.  \nüí° –ß—Ç–æ–±—ã –≤—ã–≤–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ ‚Äî –¥–µ–ª–∞–µ–º `JOIN`.  \n{{< /details >}}\n\n---\n\n{{< details \"–†–µ—à–µ–Ω–∏–µ\" close >}}\n\n```sql\nSELECT\n    d.department_id,\n    d.department_name,\n    COUNT(u.user_id) AS user_count\nFROM department d\nJOIN users u\n  ON u.department_id = d.department_id\nGROUP BY d.department_id, d.department_name\nHAVING COUNT(u.user_id) > 3;\n```\n\n{{< /details >}}"
  filepath = "–ó–∞–¥–∞—á–∏/livecoding/task-livecoding-sql-departments-more-than-three-users"
