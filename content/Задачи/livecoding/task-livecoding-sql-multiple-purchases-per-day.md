#### 34. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –±–æ–ª–µ–µ —á–µ–º –æ–¥–Ω–æ–π –ø–æ–∫—É–ø–∫–æ–π –≤ –¥–µ–Ω—å

**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  
üìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ `T1(date, user_id)` —Å –¥–∞—Ç–∞–º–∏ –ø–æ–∫—É–ø–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.  
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –≤—Å–µ —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–≤–µ—Ä—à–∏–ª **–±–æ–ª–µ–µ –æ–¥–Ω–æ–π** –ø–æ–∫—É–ø–∫–∏ **–≤ —Ç–æ—Ç –∂–µ –¥–µ–Ω—å**, –∏ –≤—ã–≤–µ—Å—Ç–∏ –ø–∞—Ä—ã `(date, user_id)`.

{{< hint warning >}}  
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  
{{< /hint >}}

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}  
üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GROUP BY date, user_id` –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ø–æ–∫—É–ø–æ–∫ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –¥–∞—Ç–µ.  
üí° –ü—Ä–∏–º–µ–Ω–∏—Ç–µ `HAVING COUNT(*) > 1` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ —Ç–µ—Ö –≥—Ä—É–ø–ø, –≥–¥–µ –ø–æ–∫—É–ø–æ–∫ –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π.  
üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ ‚Äî –æ–∫–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `COUNT(*) OVER (PARTITION BY date, user_id)` –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —ç—Ç–æ–º—É –ø–æ–ª—é.  
{{< /details >}}

{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}
```sql
-- –†–µ—à–µ–Ω–∏–µ 1: GROUP BY + HAVING
SELECT 
    date,
    user_id
FROM T1
GROUP BY 
    date, 
    user_id
HAVING COUNT(*) > 1;

-- –†–µ—à–µ–Ω–∏–µ 2: –û–∫–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
SELECT DISTINCT
    date,
    user_id
FROM (
    SELECT
        date,
        user_id,
        COUNT(*) OVER (PARTITION BY date, user_id) AS cnt
    FROM T1
) sub
WHERE cnt > 1;
```

{{< /details >}}