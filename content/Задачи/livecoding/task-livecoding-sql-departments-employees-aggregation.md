#### 58. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –æ—Ç–¥–µ–ª–∞–º –∏ –æ—Ç–¥–µ–ª—ã —Å >3 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ —Å –ó–ü > 100–∫

**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  
üìå –î–∞–Ω—ã —Ç–∞–±–ª–∏—Ü—ã `departments` –∏ `employees`. –ù—É–∂–Ω–æ:

1. –ù–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Å—á–∏—Ç–∞–µ—Ç **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏**.

2. –ù–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–π–¥—ë—Ç **–æ—Ç–¥–µ–ª—ã, –≥–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ–ª—å—à–µ —Ç—Ä—ë—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –∑–∞—Ä–ø–ª–∞—Ç–æ–π –±–æ–ª–µ–µ 100000**.


**–ö–æ–¥ (—Å—Ö–µ–º–∞ –∏ –¥–∞–Ω–Ω—ã–µ):**

```sql
CREATE TABLE departments (
    id INT PRIMARY KEY,
    name VARCHAR(100) NOT NULL
);

CREATE TABLE employees (
    id INT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    department_id INT REFERENCES departments(id),
    salary INT NOT NULL
);

-- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –æ—Ç–¥–µ–ª–æ–≤
INSERT INTO departments (id, name) VALUES
(1, '–û—Ç–¥–µ–ª –ò–¢'),
(2, '–û—Ç–¥–µ–ª –ò–ë'),
(3, 'HR');

-- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
INSERT INTO employees (id, name, department_id, salary) VALUES
(1, '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤', 1, 120000),
(2, '–ï–ª–µ–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞', 1, 110000),
(3, '–ê–ª–µ–∫—Å–µ–π –ò–≤–∞–Ω–æ–≤', 1, 105000),
(4, '–ú–∞—Ä–∏—è –ö—É–∑–Ω–µ—Ü–æ–≤–∞', 1, 95000),
(5, '–î–º–∏—Ç—Ä–∏–π –°–º–∏—Ä–Ω–æ–≤', 2, 150000),
(6, '–û–ª—å–≥–∞ –í–∞—Å–∏–ª—å–µ–≤–∞', 2, 130000),
(7, '–°–µ—Ä–≥–µ–π –ú–∏—Ä–æ–Ω–æ–≤', 2, 80000),
(8, '–ê–Ω–Ω–∞ –ñ—É–∫–æ–≤–∞', 3, 115000),
(9, '–ü–∞–≤–µ–ª –ë–µ–ª–æ–≤', 3, 125000),
(10, '–ù–∞—Ç–∞–ª—å—è –í–æ—Ä–æ–±—å–µ–≤–∞', 3, 140000),
(11, '–ê—Ä—Ç–µ–º –ì—Ä–æ–º–æ–≤', 3, 98000),
(12, '–í–∏–∫—Ç–æ—Ä–∏—è –û—Ä–ª–æ–≤–∞', 1, 108000);
```

{{< hint warning >}}  
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  
{{< /hint >}}

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}  
üí° –î–ª—è –∑–∞–¥–∞—á–∏ 1:

- –ù—É–∂–Ω–æ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –æ—Ç–¥–µ–ª–∞–º: `GROUP BY department_id` –∏–ª–∏ –ø–æ `departments.id`.

- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –æ—Ç–¥–µ–ª—ã –±–µ–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π `LEFT JOIN`.


üí° –î–ª—è –∑–∞–¥–∞—á–∏ 2:

- –°–Ω–∞—á–∞–ª–∞ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å `salary > 100000`.

- –ü–æ—Ç–æ–º —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –æ—Ç–¥–µ–ª–∞–º.

- –ò —á–µ—Ä–µ–∑ `HAVING COUNT(*) > 3` –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ—Ç–¥–µ–ª—ã, –≥–¥–µ —Ç–∞–∫–∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –±–æ–ª—å—à–µ —Ç—Ä—ë—Ö.  
  {{< /details >}}


{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}

### 1. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏

```sql
SELECT 
    d.id   AS department_id,
    d.name AS department_name,
    COUNT(e.id) AS employee_count
FROM departments d
LEFT JOIN employees e
    ON e.department_id = d.id
GROUP BY d.id, d.name
ORDER BY d.id;
```

> `LEFT JOIN` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –æ—Ç–¥–µ–ª—ã –±–µ–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Ç–æ–∂–µ –ø–æ–ø–∞–¥—É—Ç –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Å `employee_count = 0`).

---

### 2. –û—Ç–¥–µ–ª—ã, –≥–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ–ª—å—à–µ —Ç—Ä—ë—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –∑–∞—Ä–ø–ª–∞—Ç–æ–π > 100000

```sql
SELECT 
    d.id   AS department_id,
    d.name AS department_name,
    COUNT(e.id) AS high_paid_count
FROM departments d
JOIN employees e
    ON e.department_id = d.id
WHERE e.salary > 100000
GROUP BY d.id, d.name
HAVING COUNT(e.id) > 3;
```

- `WHERE e.salary > 100000` ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –ó–ü > 100–∫.

- `GROUP BY d.id, d.name` ‚Äî –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –∏—Ö –ø–æ –æ—Ç–¥–µ–ª–∞–º.

- `HAVING COUNT(e.id) > 3` ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ –æ—Ç–¥–µ–ª—ã, –≥–¥–µ **—Å—Ç—Ä–æ–≥–æ –±–æ–ª—å—à–µ —Ç—Ä—ë—Ö** —Ç–∞–∫–∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.


{{< /details >}}