#### 54. –ù–∞–π—Ç–∏ –¥—É–±–ª–∏ email —Å—Ä–µ–¥–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤-–º—É–∂—á–∏–Ω

**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  
üìå –í —Ç–∞–±–ª–∏—Ü–µ `customers` –ø–æ—è–≤–∏–ª–∏—Å—å –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –ø–æ–ª—é `email`.  
–ù—É–∂–Ω–æ:

- –∏—Å–∫–∞—Ç—å –¥—É–±–ª–∏ —Ç–æ–ª—å–∫–æ —Å—Ä–µ–¥–∏ –∑–∞–ø–∏—Å–µ–π, –≥–¥–µ `gender = 'male'`;

- –≤—ã–≤–µ—Å—Ç–∏ 2 –∫–æ–ª–æ–Ω–∫–∏:

    - `email`

    - `cnt` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Å—Ç—Ä–µ—á


---

### SQL-–∑–∞–ø—Ä–æ—Å

{{< hint warning >}}  
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  
{{< /hint >}}

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}  
üí° –ò—Å–ø–æ–ª—å–∑—É–µ–º `WHERE gender = 'male'`, —á—Ç–æ–±—ã –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –≤—ã–±–æ—Ä–∫—É.  
üí° `GROUP BY email` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ email.  
üí° `HAVING COUNT(*) > 1` –≤—ã–≤–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥—É–±–ª–∏–∫–∞—Ç—ã.  
{{< /details >}}

{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}

```sql
SELECT
    email,
    COUNT(*) AS cnt
FROM customers
WHERE gender = 'male'
GROUP BY email
HAVING COUNT(*) > 1;
```

{{< /details >}}