#### 62. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –æ—Ç–¥–µ–ª–∞–º —Å—Ä–µ–¥–∏ –Ω–µ—É–≤–æ–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  
üìå –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã:

- `units` ‚Äî –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–∏

- `employees` ‚Äî —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∫–æ–º–ø–∞–Ω–∏–∏


–ù—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω—ë—Ç:

- `unit_id`,

- –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É (`min_salary`),

- –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É (`max_salary`)


üëâ **–¢–æ–ª—å–∫–æ —Å—Ä–µ–¥–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö `fired = false`.**

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü:**

```
units:
  id    -- primary key
  name  -- –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

employees:
  id       -- primary key
  unit_id  -- foreign key -> units.id
  salary   -- –∑–∞—Ä–ø–ª–∞—Ç–∞
  fired    -- —Ñ–ª–∞–≥ —É–≤–æ–ª–µ–Ω (true / false)
```

---

{{< hint warning >}}  
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  
{{< /hint >}}

---

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}  
üí° –ù—É–∂–Ω–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ `unit_id`.  
üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `MIN(salary)` –∏ `MAX(salary)`.  
üí° –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `fired = false` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–æ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.  
üí° –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–µ—Ä–Ω—É—Ç—å —Ç–æ–ª—å–∫–æ `unit_id`, –º–æ–∂–Ω–æ –Ω–µ –¥–µ–ª–∞—Ç—å `JOIN` —Å `units`.  
{{< /details >}}

---

{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}

```sql
SELECT
    e.unit_id,
    MIN(e.salary) AS min_salary,
    MAX(e.salary) AS max_salary
FROM employees e
WHERE e.fired = false
GROUP BY e.unit_id;
```

**–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:**

- `WHERE e.fired = false` ‚Äî –∏—Å–∫–ª—é—á–∞–µ–º —É–≤–æ–ª–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.

- `GROUP BY e.unit_id` ‚Äî —Å—á–∏—Ç–∞–µ–º –∞–≥—Ä–µ–≥–∞—Ç—ã –ø–æ –∫–∞–∂–¥–æ–º—É –æ—Ç–¥–µ–ª—É.

- `MIN` –∏ `MAX` —Å—á–∏—Ç–∞—é—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞—Ä–ø–ª–∞—Ç—É –≤–Ω—É—Ç—Ä–∏ –æ—Ç–¥–µ–ª–∞.


---

**–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª–∞:**

```sql
SELECT
    u.id   AS unit_id,
    u.name AS unit_name,
    MIN(e.salary) AS min_salary,
    MAX(e.salary) AS max_salary
FROM units u
JOIN employees e
  ON e.unit_id = u.id
 AND e.fired = false
GROUP BY u.id, u.name;
```

{{< /details >}}