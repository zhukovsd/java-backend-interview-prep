#### 23. –ù–∞–∑–≤–∞–Ω–∏—è –∏ —Ü–µ–Ω—ã —É—Å–ª—É–≥, –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Å 1 —è–Ω–≤–∞—Ä—è 2021 –ø–æ —Å–ª–µ–¥—É—é—â—É—é –Ω–µ–¥–µ–ª—é

**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  
üìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã:  
- **Services** (`id`, `name`, `cost`, `price`, `group_id`)  
- **Groups** (`id`, `name`)  
- **Orders** (`id`, `datetime`, `srv_id`)  

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–≤–µ—Å—Ç–∏ **–Ω–∞–∑–≤–∞–Ω–∏–µ** –∏ **—Ä–æ–∑–Ω–∏—á–Ω—É—é —Ü–µ–Ω—É** (`price`) –¥–ª—è –≤—Å–µ—Ö —É—Å–ª—É–≥, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–¥–∞–≤–∞–ª–∏—Å—å **1 —è–Ω–≤–∞—Ä—è 2021 –∏ –≤ —Ç–µ—á–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–∏**.

{{< hint warning >}}  
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  
{{< /hint >}}

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}  
üí° –°–æ–µ–¥–∏–Ω–∏—Ç–µ **Orders** —Å **Services** –ø–æ `srv_id = Services.id`.  
üí° –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –¥–∞—Ç: –æ—Ç `'2021-01-01'` –¥–æ `'2021-01-08'` (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ).  
üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `DISTINCT`, —á—Ç–æ–±—ã –∫–∞–∂–¥–∞—è —É—Å–ª—É–≥–∞ –≤—ã–≤–æ–¥–∏–ª–∞—Å—å –µ–¥–∏–Ω–æ–∂–¥—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –±—ã–ª–∞ –ø—Ä–æ–¥–∞–Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑.  
üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±—Ä–∞—Ç—å `srv_id` –ø–æ —Ñ–∏–ª—å—Ç—Ä—É –¥–∞—Ç, –∞ –∑–∞—Ç–µ–º –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å **Services** —á–µ—Ä–µ–∑ `IN` –∏–ª–∏ `EXISTS`.  
{{< /details >}}

{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}

```sql
-- –†–µ—à–µ–Ω–∏–µ 1: JOIN + DISTINCT + –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç
SELECT DISTINCT s.name,
       s.price
FROM Services s
JOIN Orders o ON o.srv_id = s.id
WHERE o.datetime >= '2021-01-01'
  AND o.datetime <  '2021-01-09';
```

```sql
-- –†–µ—à–µ–Ω–∏–µ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞ —Å IN
SELECT s.name,
       s.price
FROM Services s
WHERE s.id IN (
    SELECT o.srv_id
    FROM Orders o
    WHERE o.datetime BETWEEN '2021-01-01' AND '2021-01-08'
);
```

{{< /details >}}