#### 53. –û—Ç–¥–µ–ª—ã, –≥–¥–µ —á–∏—Å–ª–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç —Ç—Ä—ë—Ö —á–µ–ª–æ–≤–µ–∫

**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  
üìå –í —Ç–∞–±–ª–∏—Ü–µ `EMPLOYEE(ID, NAME, SALARY, DEPARTMENT_ID, CHIEF_ID)` –Ω—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ **—Å–ø–∏—Å–æ–∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –æ—Ç–¥–µ–ª–æ–≤**, –≥–¥–µ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ **‚â§ 3**.

**–ö–æ–¥:**

```sql
CREATE TABLE EMPLOYEE (
    ID int,
    NAME VARCHAR(256),
    SALARY int,
    DEPARTMENT_ID int,
    CHIEF_ID int
);

-- –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:
-- ID | NAME      | SALARY | DEPARTMENT_ID | CHIEF_ID
-- ---+------------+--------+---------------+----------
-- 1  | –ò–≤–∞–Ω–æ–≤     | 150    | 1             | null
-- 2  | –ü–µ—Ç—Ä–æ–≤     | 250    | 1             | 1
-- 3  | –°–∏–¥–æ—Ä–æ–≤    | 550    | 1             | 1
-- 4  | –ú–µ–¥–≤–µ–¥–µ–≤   | 350    | 2             | 6
-- 5  | –°–æ–∫–æ–ª–æ–≤    | 350    | 2             | 6
-- 6  | –†—ã–±–Ω–∏–∫–æ–≤   | 150    | 2             | null
-- 7  | –ê—Ä–±—É–∑–æ–≤    | 450    | 3             | null
-- 8  | –û—Ä–µ—Ö–æ–≤     | 650    | 3             | 7
-- 9  | –î—ã–Ω–∏–Ω      | 50     | 3             | 7
```

{{< hint warning >}}  
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  
{{< /hint >}}

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}  
üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GROUP BY department_id`, —á—Ç–æ–±—ã —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –æ—Ç–¥–µ–ª–∞–º.  
üí° –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –∞–≥—Ä–µ–≥–∞—Ç `COUNT(*)` –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ —á–∏—Å–ª–∞ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –æ—Ç–¥–µ–ª–µ.  
üí° –û—Ç–±–µ—Ä–∏—Ç–µ –æ—Ç–¥–µ–ª—ã, –≥–¥–µ `COUNT(*) <= 3`.  
üí° –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `ORDER BY department_id` –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞.  
{{< /details >}}

{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}

```sql
SELECT 
    department_id
FROM EMPLOYEE
GROUP BY department_id
HAVING COUNT(*) <= 3
ORDER BY department_id;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**

|department_id|
|---|
|1|
|2|
|3|

üß† **–ü–æ—è—Å–Ω–µ–Ω–∏–µ:**

- –í—Å–µ —Ç—Ä–∏ –æ—Ç–¥–µ–ª–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ä–æ–≤–Ω–æ –ø–æ 3 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –ø–æ—ç—Ç–æ–º—É –æ–Ω–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è.

- –ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –ø–æ—è–≤–∏—Ç—Å—è –æ—Ç–¥–µ–ª —Å 4+ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏, –æ–Ω –±—É–¥–µ—Ç –∏—Å–∫–ª—é—á—ë–Ω –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.


{{< /details >}}