#### 60. –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –∏–∑–¥–µ–ª–∏–π (–≤–µ–¥–æ–º–æ—Å—Ç—å —Å–æ—Å—Ç–∞–≤–∞ / BOM)

**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  
üìå –ù—É–∂–Ω–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—É –ë–î –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–∞–≤–∞ –∏–∑–¥–µ–ª–∏—è (BOM).  
–ï—Å—Ç—å –∏–∑–¥–µ–ª–∏–µ –∏ –µ–≥–æ —Å–æ—Å—Ç–∞–≤:

```text
1 –î–∞—Ç—á–∏–∫
  2 –ö–æ—Ä–ø—É—Å 1 —à—Ç
    3 –í–∏–Ω—Ç 8 —à—Ç
  3 –í–∏–Ω—Ç 4 —à—Ç
```

–ó–∞–¥–∞—á–∞: –∫–∞–∫–∏–µ –±—É–¥—É—Ç **—Ç–∞–±–ª–∏—Ü—ã** –∏ **—Å—Ç–æ–ª–±—Ü—ã**, —á—Ç–æ–±—ã:

- —Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –∏–∑–¥–µ–ª–∏—è/–¥–µ—Ç–∞–ª–∏ (–Ω–æ—Ä–º–∞—Ç–∏–≤–∫–∞);

- —Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É: –∫–∞–∫–æ–µ –∏–∑–¥–µ–ª–∏–µ –∏–∑ –∫–∞–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–æ—Å—Ç–æ–∏—Ç –∏ –≤ –∫–∞–∫–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ;

- –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –¥–µ—Ç–∞–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–í–∏–Ω—Ç¬ª –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö –∏ –≤ —Ä–∞–∑–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ).


---

{{< hint warning >}}  
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  
{{< /hint >}}

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}  
üí° –û–±—ã—á–Ω–æ –¥–µ–ª–∞–µ–º **2 —Ç–∞–±–ª–∏—Ü—ã**:

1. `items` ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∏–∑–¥–µ–ª–∏–π/–¥–µ—Ç–∞–ª–µ–π (—á—Ç–æ —ç—Ç–æ –∑–∞ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞).

2. `bom` (bill of materials) ‚Äî —Å–≤—è–∑–∏ ¬´—Ä–æ–¥–∏—Ç–µ–ª—å ‚Üí –∫–æ–º–ø–æ–Ω–µ–Ω—Ç + –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ¬ª.


üí° –í `bom` –Ω—É–∂–Ω—ã:

- `parent_item_id` ‚Äî —á—Ç–æ —Å–æ–±–∏—Ä–∞–µ–º,

- `component_item_id` ‚Äî –∏–∑ —á–µ–≥–æ,

- `quantity` ‚Äî —Å–∫–æ–ª—å–∫–æ —à—Ç—É–∫,

- –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ `level` / `position` / `unit`.  
  {{< /details >}}


{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}

### 1. –¢–∞–±–ª–∏—Ü–∞ –∏–∑–¥–µ–ª–∏–π / –¥–µ—Ç–∞–ª–µ–π

```sql
CREATE TABLE items (
    id           BIGINT PRIMARY KEY,           -- 1, 2, 3 ...
    name         VARCHAR(255) NOT NULL,        -- "–î–∞—Ç—á–∏–∫", "–ö–æ—Ä–ø—É—Å", "–í–∏–Ω—Ç"
    item_code    VARCHAR(50),                  -- –∞—Ä—Ç–∏–∫—É–ª / –≤–Ω—É—Ç—Ä. –∫–æ–¥ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    item_type    VARCHAR(50),                  -- —Ç–∏–ø: 'ASSEMBLY', 'PART', 'RAW' –∏ —Ç.–ø.
    unit         VARCHAR(20) NOT NULL DEFAULT '—à—Ç', -- –±–∞–∑–æ–≤–∞—è –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
    is_active    BOOLEAN NOT NULL DEFAULT TRUE,
    created_at   TIMESTAMP NOT NULL DEFAULT now(),
    updated_at   TIMESTAMP NOT NULL DEFAULT now()
);
```

–ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–≤–æ–µ–≥–æ —Å–ª—É—á–∞—è:

```text
id | name    | item_type
---+---------+----------
1  | –î–∞—Ç—á–∏–∫  | ASSEMBLY
2  | –ö–æ—Ä–ø—É—Å  | ASSEMBLY
3  | –í–∏–Ω—Ç    | PART
```

---

### 2. –¢–∞–±–ª–∏—Ü–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑–¥–µ–ª–∏—è (BOM)

```sql
CREATE TABLE bom (
    id                BIGINT PRIMARY KEY,
    parent_item_id    BIGINT NOT NULL,      -- –∏–∑–¥–µ–ª–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ–±–∏—Ä–∞–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–î–∞—Ç—á–∏–∫")
    component_item_id BIGINT NOT NULL,      -- –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ö–æ—Ä–ø—É—Å", "–í–∏–Ω—Ç")
    quantity          NUMERIC(12, 3) NOT NULL, -- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –Ω–∞ 1 –µ–¥. —Ä–æ–¥–∏—Ç–µ–ª—è
    unit              VARCHAR(20) NOT NULL DEFAULT '—à—Ç', -- –µ–¥. –∏–∑–º–µ—Ä–µ–Ω–∏—è (—à—Ç, –∫–≥, –º –∏ —Ç.–ø.)
    position          INT,                 -- –ø–æ–∑–∏—Ü–∏—è –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–¥–ª—è –ø–µ—á–∞—Ç–Ω—ã—Ö —Ñ–æ—Ä–º)
    level_hint        INT,                 -- –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —É—Ä–æ–≤–µ–Ω—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ (1,2,3 ...)
    CONSTRAINT fk_bom_parent
        FOREIGN KEY (parent_item_id) REFERENCES items(id),
    CONSTRAINT fk_bom_component
        FOREIGN KEY (component_item_id) REFERENCES items(id)
);
```

–î–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞:

```text
-- –î–∞—Ç—á–∏–∫ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:
-- 1) –ö–æ—Ä–ø—É—Å 1 —à—Ç
-- 2) –í–∏–Ω—Ç 4 —à—Ç
INSERT INTO bom (id, parent_item_id, component_item_id, quantity, unit, position, level_hint)
VALUES
(1, 1, 2, 1,  '—à—Ç', 1, 1),   -- –î–∞—Ç—á–∏–∫ -> –ö–æ—Ä–ø—É—Å 1 —à—Ç
(2, 1, 3, 4,  '—à—Ç', 2, 1);   -- –î–∞—Ç—á–∏–∫ -> –í–∏–Ω—Ç 4 —à—Ç

-- –ö–æ—Ä–ø—É—Å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:
-- 3) –í–∏–Ω—Ç 8 —à—Ç
INSERT INTO bom (id, parent_item_id, component_item_id, quantity, unit, position, level_hint)
VALUES
(3, 2, 3, 8, '—à—Ç', 1, 2);    -- –ö–æ—Ä–ø—É—Å -> –í–∏–Ω—Ç 8 —à—Ç
```

**–ö–∞–∫ —á–∏—Ç–∞–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

- `parent_item_id = 1 ("–î–∞—Ç—á–∏–∫")`, `component_item_id = 2 ("–ö–æ—Ä–ø—É—Å")`, `quantity = 1` ‚Üí  
  –ù–∞ –æ–¥–∏–Ω –¥–∞—Ç—á–∏–∫ –Ω—É–∂–µ–Ω –æ–¥–∏–Ω –∫–æ—Ä–ø—É—Å.

- `parent_item_id = 1 ("–î–∞—Ç—á–∏–∫")`, `component_item_id = 3 ("–í–∏–Ω—Ç")`, `quantity = 4` ‚Üí  
  –ù–∞ –æ–¥–∏–Ω –¥–∞—Ç—á–∏–∫ –Ω—É–∂–Ω–æ 4 –≤–∏–Ω—Ç–∞ ¬´–≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è¬ª.

- `parent_item_id = 2 ("–ö–æ—Ä–ø—É—Å")`, `component_item_id = 3 ("–í–∏–Ω—Ç")`, `quantity = 8` ‚Üí  
  –ù–∞ –æ–¥–∏–Ω –∫–æ—Ä–ø—É—Å –Ω—É–∂–Ω–æ 8 –≤–∏–Ω—Ç–æ–≤.


---

**–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫:**

- –û–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ `items` ‚Äî –æ–¥–∏–Ω —Ä–∞–∑ –æ–ø–∏—Å—ã–≤–∞–µ—Ç, _—á—Ç–æ_ —ç—Ç–æ –∑–∞ –¥–µ—Ç–∞–ª—å/–∏–∑–¥–µ–ª–∏–µ.

- –¢–∞–±–ª–∏—Ü–∞ `bom` ‚Äî –æ–ø–∏—Å—ã–≤–∞–µ—Ç, _–∫–∞–∫_ –æ–¥–Ω–æ –∏–∑–¥–µ–ª–∏–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ –¥—Ä—É–≥–∏—Ö (—Ä–æ–¥–∏—Ç–µ–ª—å ‚Üí –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã).

- –û–¥–Ω–∞ –∏ —Ç–∞ –∂–µ –¥–µ—Ç–∞–ª—å (`–í–∏–Ω—Ç`, id=3) –º–æ–∂–µ—Ç —Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö BOM —Å —Ä–∞–∑–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ ‚Äî —ç—Ç–æ –∫–∞–∫ —Ä–∞–∑ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏.


–¢–∞–∫–æ–π –¥–∏–∑–∞–π–Ω ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –¥–ª—è —Å–∏—Å—Ç–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–∞–≤–æ–º –∏–∑–¥–µ–ª–∏—è (BOM/ERP/PLM).

{{< /details >}}