#### 16. –¢–æ–≤–∞—Ä—ã —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤


**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  
üìä **–°–æ—Å—Ç–∞–≤–∏—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–æ–¥–∏—Ç –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.**

üìå **–¢–∞–±–ª–∏—Ü–∞ `Prices` (–¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–∞—Ö):**

- `Name` ‚Äì –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- `Category` ‚Äì –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞
- `Price` ‚Äì —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞

üöÄ **–¢—Ä–µ–±—É–µ—Ç—Å—è –≤–µ—Ä–Ω—É—Ç—å:**

- `Category`
- `Name` (—Ç–æ–≤–∞—Ä —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
- `Price` (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)


```text
–î–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ Prices –≤ –ë–î.
Name        Category             Price
--------------------------------------
–ê–ø–µ–ª—å—Å–∏–Ω    –§—Ä—É–∫—Ç—ã               50
–ú–∞–Ω–¥–∞—Ä–∏–Ω    –§—Ä—É–∫—Ç—ã               45
–Ø–±–ª–æ–∫–æ      –§—Ä—É–∫—Ç—ã               30
–û–≥—É—Ä–µ—Ü      –û–≤–æ—â–∏                35
–¢–æ–º–∞—Ç       –û–≤–æ—â–∏                40
–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å   –û–≤–æ—â–∏                25
–ú–æ–ª–æ–∫–æ      –ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã    30
–¢–≤–æ—Ä–æ–≥      –ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã    40


```


{{< hint warning >}}
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é** ¬†
{{< /hint >}}

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}
üí° –î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞—Ö–æ–¥–∏–º **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É** —Å –ø–æ–º–æ—â—å—é `MAX(Price)`.  
üí° –ó–∞—Ç–µ–º –≤—ã–±–∏—Ä–∞–µ–º —Ç–æ–≤–∞—Ä—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö `Price` —Ä–∞–≤–Ω–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–º—É –º–∞–∫—Å–∏–º—É–º—É.  
üí° –ò—Å–ø–æ–ª—å–∑—É–µ–º `JOIN` –∏–ª–∏ `WHERE` —Å –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–º.
{{< /details >}}

{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}

```sql
SELECT p1.Category, p1.Name, p1.Price
FROM Prices p1
WHERE p1.Price = (
    SELECT MAX(p2.Price) 
    FROM Prices p2 
    WHERE p1.Category = p2.Category
);
```

‚úÖ **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:**

- –ü–æ–¥–∑–∞–ø—Ä–æ—Å `SELECT MAX(p2.Price) FROM Prices p2 WHERE p1.Category = p2.Category` –Ω–∞—Ö–æ–¥–∏—Ç **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏**.
- –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—Ä–æ—Å –≤—ã–±–∏—Ä–∞–µ—Ç **—Ç–æ–≤–∞—Ä—ã —Å —ç—Ç–æ–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π**.
- –ï—Å–ª–∏ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π, –æ–Ω–∏ **–≤—Å–µ –ø–æ–ø–∞–¥—É—Ç –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç**.

üî• –¢–µ–ø–µ—Ä—å –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω–µ—Ç —Ç–æ–≤–∞—Ä—ã —Å —Å–∞–º–æ–π –≤—ã—Å–æ–∫–æ–π —Ü–µ–Ω–æ–π –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏! üöÄ
{{< /details >}}