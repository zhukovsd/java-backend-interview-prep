#### 55. –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏, –ø–æ–ª—É—á–∞—é—â–∏–µ –∑–∞—Ä–ø–ª–∞—Ç—É –≤—ã—à–µ —Å–≤–æ–µ–≥–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è

**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  
üìå –í —Ç–∞–±–ª–∏—Ü–µ `EMPLOYEE(ID, NAME, SALARY, DEPARTMENT_ID, CHIEF_ID)` –Ω—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ **—Å–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤**, —á—å—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –±–æ–ª—å—à–µ, —á–µ–º —É –∏—Ö **–Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è** (`CHIEF_ID`).

**–ö–æ–¥:**

```sql
CREATE TABLE EMPLOYEE (
    ID int,
    NAME VARCHAR(256),
    SALARY int,
    DEPARTMENT_ID int,
    CHIEF_ID int
);

-- –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö
-- ID | NAME      | SALARY | DEPARTMENT_ID | CHIEF_ID
-- ---+------------+--------+---------------+----------
-- 1  | –ò–≤–∞–Ω–æ–≤     | 150    | 1             | null
-- 2  | –ü–µ—Ç—Ä–æ–≤     | 250    | 1             | 1
-- 3  | –°–∏–¥–æ—Ä–æ–≤    | 550    | 1             | 1
-- 4  | –ú–µ–¥–≤–µ–¥–µ–≤   | 350    | 2             | 6
-- 5  | –°–æ–∫–æ–ª–æ–≤    | 350    | 2             | 6
-- 6  | –†—ã–±–Ω–∏–∫–æ–≤   | 150    | 2             | null
-- 7  | –ê—Ä–±—É–∑–æ–≤    | 450    | 3             | null
-- 8  | –û—Ä–µ—Ö–æ–≤     | 650    | 3             | 7
-- 9  | –î—ã–Ω–∏–Ω      | 50     | 3             | 7
```

{{< hint warning >}}  
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  
{{< /hint >}}

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}  
üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **self join** ‚Äî —Å–æ–µ–¥–∏–Ω–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É `EMPLOYEE` —Å–∞–º—É —Å —Å–æ–±–æ–π.  
üí° –£—Å–ª–æ–≤–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: `e.CHIEF_ID = c.ID`, –≥–¥–µ `c` ‚Äî –Ω–∞—á–∞–ª—å–Ω–∏–∫.  
üí° –í `WHERE` –æ—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–µ—Ö, —É –∫–æ–≥–æ `e.SALARY > c.SALARY`.  
üí° –ò—Å–∫–ª—é—á–∏—Ç–µ –∑–∞–ø–∏—Å–∏, –≥–¥–µ `CHIEF_ID IS NULL` ‚Äî —É –Ω–∏—Ö –Ω–µ—Ç —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è.  
{{< /details >}}

{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}

```sql
SELECT 
    e.NAME       AS employee_name,
    e.SALARY     AS employee_salary,
    c.NAME       AS chief_name,
    c.SALARY     AS chief_salary
FROM EMPLOYEE e
JOIN EMPLOYEE c
  ON e.CHIEF_ID = c.ID
WHERE e.SALARY > c.SALARY;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**

|employee_name|employee_salary|chief_name|chief_salary|
|---|---|---|---|
|–ü–µ—Ç—Ä–æ–≤|250|–ò–≤–∞–Ω–æ–≤|150|
|–°–∏–¥–æ—Ä–æ–≤|550|–ò–≤–∞–Ω–æ–≤|150|
|–ú–µ–¥–≤–µ–¥–µ–≤|350|–†—ã–±–Ω–∏–∫–æ–≤|150|
|–°–æ–∫–æ–ª–æ–≤|350|–†—ã–±–Ω–∏–∫–æ–≤|150|
|–û—Ä–µ—Ö–æ–≤|650|–ê—Ä–±—É–∑–æ–≤|450|

üß† **–ü–æ—è—Å–Ω–µ–Ω–∏–µ:**

- –¢–∞–±–ª–∏—Ü–∞ —Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è —Å–∞–º–∞ —Å —Å–æ–±–æ–π, —á—Ç–æ–±—ã ‚Äú–¥–æ—Å—Ç–∞—Ç—å‚Äù –∑–∞—Ä–ø–ª–∞—Ç—É –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞.

- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å—Ç—Ä–æ—á–Ω–æ: –µ—Å–ª–∏ `SALARY > CHIEF.SALARY`, —Å—Ç—Ä–æ–∫–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.


{{< /details >}}