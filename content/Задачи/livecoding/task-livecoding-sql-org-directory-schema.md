#### 59. –°—Ö–µ–º–∞ –ë–î –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π

**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  
üìå –ù—É–∂–Ω–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î –¥–ª—è **–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π** —Å –∏–µ—Ä–∞—Ä—Ö–∏–µ–π —É—Ä–æ–≤–Ω–µ–π (—Ö–æ–ª–¥–∏–Ω–≥ ‚Üí —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Üí –æ—Ç–¥–µ–ª ‚Üí –±—é—Ä–æ –∏ —Ç.–¥.).  
–ù—É–∂–Ω–æ –æ—Ç–≤–µ—Ç–∏—Ç—å:

- –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É –¥–µ–ª–∞–µ–º –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ?

- –∫–∞–∫–∏–µ —Å—Ç–æ–ª–±—Ü—ã –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞ –≤–∏–¥–∞:


```text
–¢–ù - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
  –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–ë
    –û—Ç–¥–µ–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ—à–µ–Ω–∏–π –ò–ë
      –ë—é—Ä–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
      –ë—é—Ä–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏
  –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–¢
    –û—Ç–¥–µ–ª –ò–¢
    –û—Ç–¥–µ–ª –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–¢–ù - –î–∞–ª—å–Ω–∏–π –≤–æ—Å—Ç–æ–∫
  –†–ù–£
    –ù–ü–° 1
    –ù–ü–° 2
```

---

{{< hint warning >}}  
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  
{{< /hint >}}

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}  
üí° –î–ª—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ —á–∞—â–µ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **adjacency list**: —É –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –µ—Å—Ç—å `parent_id`.  
üí° –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å **–æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É** `org_unit`, –≥–¥–µ –≤–µ—Ä—Ö–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å (–¢–ù) –∏–º–µ–µ—Ç `parent_id = NULL`.  
üí° –ü–æ–ª–µ–∑–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å:  
‚Äì `id`  
‚Äì `parent_id`  
‚Äì `name`  
‚Äì —Ç–∏–ø –∏–ª–∏ —É—Ä–æ–≤–µ–Ω—å (`type` / `level`)  
‚Äì —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è (`sort_order`).  
üí° –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `root_id` –∏–ª–∏ `tree_id`.  
{{< /details >}}

---

{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}

–î–ª—è —Ç–∏–ø–æ–≤–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —è –±—ã —Å–¥–µ–ª–∞–ª **–æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É** —Å –∏–µ—Ä–∞—Ä—Ö–∏–µ–π –ø–æ `parent_id`:

```sql
CREATE TABLE org_units (
    id           BIGINT PRIMARY KEY,          -- —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É–∑–ª–∞
    parent_id    BIGINT NULL,                 -- —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—è (NULL –¥–ª—è –∫–æ—Ä–Ω—è)
    name         VARCHAR(255) NOT NULL,       -- –Ω–∞–∑–≤–∞–Ω–∏–µ: "–¢–ù - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–ë", "–ù–ü–° 1" –∏ —Ç.–ø.
    type         VARCHAR(50)  NOT NULL,       -- —Ç–∏–ø —É–∑–ª–∞: 'HOLDING', 'REGION', 'DEPARTMENT', 'BUREAU', 'NPS' –∏ —Ç.–¥.
    level        INT          NOT NULL,       -- —É—Ä–æ–≤–µ–Ω—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏: 1,2,3,4...
    code         VARCHAR(50),                 -- –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–¥ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)
    sort_order   INT          NOT NULL DEFAULT 0,  -- –ø–æ—Ä—è–¥–æ–∫ –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ parent
    is_active    BOOLEAN      NOT NULL DEFAULT TRUE, -- –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏
    created_at   TIMESTAMP    NOT NULL DEFAULT now(),
    updated_at   TIMESTAMP    NOT NULL DEFAULT now()
);

-- –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—è
ALTER TABLE org_units
    ADD CONSTRAINT fk_org_units_parent
    FOREIGN KEY (parent_id) REFERENCES org_units(id);
```

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ:**

|id|parent_id|name|type|level|
|---|---|---|---|---|
|1|NULL|–¢–ù - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏|HOLDING|1|
|2|1|–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–ë|MANAGEMENT|2|
|3|2|–û—Ç–¥–µ–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ—à–µ–Ω–∏–π –ò–ë|DEPT|3|
|4|3|–ë—é—Ä–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏|BUREAU|4|
|5|3|–ë—é—Ä–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏|BUREAU|4|
|6|1|–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–¢|MANAGEMENT|2|
|7|6|–û—Ç–¥–µ–ª –ò–¢|DEPT|3|
|8|6|–û—Ç–¥–µ–ª –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã|DEPT|3|
|9|NULL|–¢–ù - –î–∞–ª—å–Ω–∏–π –≤–æ—Å—Ç–æ–∫|HOLDING|1|
|10|9|–†–ù–£|MANAGEMENT|2|
|11|10|–ù–ü–° 1|NPS|3|
|12|10|–ù–ü–° 2|NPS|3|

**–ü–æ—á–µ–º—É –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ:**

- –ò–µ—Ä–∞—Ä—Ö–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –≥–ª—É–±–∏–Ω—ã ‚Äî –ø—Ä–æ—Å—Ç–æ —Ü–µ–ø–æ—á–∫–∞ `parent_id`.

- –ù–µ –Ω—É–∂–Ω–æ –ø–ª–æ–¥–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã –ø–æ–¥ –∫–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å (`holdings`, `departments`, `bureaus` –∏ —Ç.–ø.).

- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏ –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π —Å—Ö–µ–º—ã (–Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ `type`).

- –ó–∞–ø—Ä–æ—Å—ã –≤–∏–¥–∞ ¬´–≤—Å–µ –¥–æ—á–µ—Ä–Ω–∏–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –¢–ù - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏¬ª —Å—Ç—Ä–æ—è—Ç—Å—è –ø–æ `parent_id`/`level`/`type`.


> –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –æ—Ç–¥–µ–ª–∏—Ç—å _–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –≤ —Ü–µ–ª–æ–º_ –æ—Ç _—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü_,  
> –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `organizations` –∏ –≤ `org_units` —Ö—Ä–∞–Ω–∏—Ç—å `organization_id`.  
> –ù–æ –¥–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ ¬´–¥–µ—Ä–µ–≤–∞ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π¬ª —á–∞—Å—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–¥–Ω–æ–π `org_units`.

{{< /details >}}