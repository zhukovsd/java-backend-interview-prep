#### 35. –í–∑–∞–∏–º–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ (mutual follows)

**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**  
üìå –ï—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–¥–ø–∏—Å–æ–∫ –≤ —Å–æ—Ü—Å–µ—Ç–∏:
```

user_id | follower_id  
--------+------------  
1 | 5  
1 | 4  
2 | 3  
3 | 2  
5 | 1

```

–ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –ø–∞—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ **—Ñ–æ–ª–æ–≤—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞** (–Ω–µ —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–æ), –∏ –≤—ã–≤–µ—Å—Ç–∏ `(user_id, follower_id)`.

{{< hint warning >}}  
**–°–ø–æ–π–ª–µ—Ä—ã –∫ —Ä–µ—à–µ–Ω–∏—é**  
{{< /hint >}}

{{< details "–ü–æ–¥—Å–∫–∞–∑–∫–∏" close >}}  
üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **—Å–∞–º–æ-–¥–∂–æ–π–Ω** —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ —É—Å–ª–æ–≤–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏: `t1.user_id = t2.follower_id AND t1.follower_id = t2.user_id`.  
üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –¥–≤–æ–π–Ω–æ–π `EXISTS`: –ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –¥–ª—è –¥–∞–Ω–Ω–æ–π –ø–∞—Ä—ã —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –æ–±—Ä–∞—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å.  
üí° –ù–µ –∑–∞–±—É–¥—å—Ç–µ –∏—Å–∫–ª—é—á–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã, —á—Ç–æ–±—ã –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—å –æ–¥–Ω—É –∏ —Ç—É –∂–µ –ø–∞—Ä—É –¥–≤–∞–∂–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `(5,1)` –∏ `(1,5)` –æ–±–∞ –Ω–µ –Ω—É–∂–Ω—ã).  
{{< /details >}}

{{< details "–†–µ—à–µ–Ω–∏–µ" close >}}
```sql
-- –†–µ—à–µ–Ω–∏–µ 1: SELF JOIN
SELECT DISTINCT t1.user_id,
       t1.follower_id
FROM follows t1
JOIN follows t2
  ON t1.user_id = t2.follower_id
 AND t1.follower_id = t2.user_id
WHERE t1.user_id < t1.follower_id;

-- –†–µ—à–µ–Ω–∏–µ 2: EXISTS
SELECT f1.user_id,
       f1.follower_id
FROM follows f1
WHERE EXISTS (
    SELECT 1
    FROM follows f2
    WHERE f2.user_id = f1.follower_id
      AND f2.follower_id = f1.user_id
)
AND f1.user_id < f1.follower_id;
```

{{< /details >}}